
<!-- Editor. -->
<div id="editor"></div>

<!-- Exhibit. -->

<div id="neatline" class="">
  <div id="neatline-map" class="neatline-block"></div>
</div>

<!-- Globals constants. -->
<script type="text/javascript">
  Neatline.g = {"neatline":{"exhibit":{"owner_id":1,"added":null,"modified":"2013-07-07 12:51:17","published":null,"query":null,"spatial_layers":null,"spatial_layer":"OpenStreetMap","image_layer":null,"image_height":null,"image_width":null,"wms_address":null,"wms_layers":null,"widgets":null,"title":null,"slug":"test-slug","narrative":null,"public":1,"styles":null,"map_focus":null,"map_zoom":null,"id":"191"},"records_api":"\/neatline\/records","exhibits_api":"\/neatline\/exhibits\/191","items_api":"\/items\/browse","per_page":50,"spatial_layers":[{"title":"OpenStreetMap","id":"OpenStreetMap","type":"OpenStreetMap"}]},"narrative":{"records":[]},"waypoints":{"order_api":"\/neatline-waypoints"}}</script>

<!-- Underscore templates. -->


<script id="static-bubble-template" type="text/template">
  <a name="close" class="close">&times;</a>
  <div class="title"><%= record.get('title') %></div>
  <div class="body"><%= record.get('body') %></div>
</script>

<!-- Plugin templates. -->

<script>
  STRINGS = {
    record: {
      save: {
        success:  'The record was saved successfully!',
        error:    'There was an error; the record was not saved.'
      },
      remove: {
        success:  'The record was deleted successfully!',
        error:    'There was an error; the record was not deleted.'
      },
      add: {
        success:  'New record created successfully!',
        error:    'There was an error; a new record was not created.'
      },
      placeholders: {
        title:    '[Untitled]'
      }
    },
    exhibit: {
      save: {
        success:  'The exhibit was saved successfully!',
        error:    'There was an error; the exhibit was not saved.'
      }
    },
    styles: {
      save: {
        success:  'The styles were saved successfully!',
        error:    'There was an error; the styles were not saved.'
      }
    },
    svg: {
      parse: {
        success:  'SVG parsed successfully!',
        error:    'There was an error; SVG could not be parsed.'
      }
    }
  };
</script>

<span id="loader" class="alert alert-info">
  Loading</div>

<!-- Underscore templates. -->

<script id="exhibit-menu-template" type="text/template">

  <!-- Back to Omeka. -->
  <a class="back" href="/neatline">
    &larr; Back to Omeka
  </a>

  <!-- Exhibit title. -->
  <p class="lead"></p>

  <!-- Main navigation. -->
  <ul class="nav nav-pills">

    <li class="tab" data-slug="records">
      <a href="#records">Records</a>
    </li>
    <li class="tab" data-slug="styles">
      <a href="#styles">Styles</a>
    </li>

    <!-- Widget tabs. -->
    

  </ul>

</script>

<script id="exhibit-styles-template" type="text/template">

  <div class="control-group">

    <label>Stylesheet</label>
    <div class="controls">
      <div class="inline-inputs">
        <div id="styles"></div>
      </div>
    </div>

    
<label>

  <!-- Label text. -->
  Default Map Focus
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='map-focus'            data-rv-value='exhibit.map_focus'          />
  </div>
</div>

    
<label>

  <!-- Label text. -->
  Default Map Zoom
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='map-zoom'            data-rv-value='exhibit.map_zoom'          />
  </div>
</div>

    
<div class="controls">
  <div class="inline-inputs">
    <a class="btn btn-small"
      name='set-focus'>
      <i class='icon-map-marker'></i>
      Use Current Viewport as Default    </a>
  </div>
</div>

  </div>

  
<div class="actions">
  <a name="save" class="btn btn-large btn-primary" \>
    <i class="icon-ok icon-white"></i> Save  </a>
</div>

</script>

<script id="record-form-template" type="text/template">

  <!-- Close button. -->
  
<a name="close" class="close">&times;</a>

  <!-- Header. -->
  <p class="lead">
    <span class="id" data-rv-text="record.id | recordId"></span>
    <span class="title" data-rv-text="record.title | recordTitle"></span>
  </p>

  <!-- Tabs. -->
  <ul class="nav nav-pills">
    <li class="tab">
      <a href="#record-text" data-toggle="tab"
        data-slug="text">Text</a>
    </li>
    <li class="tab">
      <a href="#record-map" data-toggle="tab"
        data-slug="map">Map</a>
    </li>
    <li class="tab">
      <a href="#record-style" data-toggle="tab"
        data-slug="style">Style</a>
    </li>
  </ul>

  <!-- Panels. -->
  <div class="tab-content">
    <div class="tab-pane text" id="record-text">
      
<div class="control-group">

  
<label>

  <!-- Label text. -->
  Omeka ID
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
      placeholder='Search Omeka Items'      name='item-id'            data-rv-value='record.item_id'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Slug
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='slug'            data-rv-value='record.slug'          />
  </div>
</div>

  
<label>

  Title
  <!-- ( Edit HTML ). -->
      ( <a class="label-link" data-textarea="title">
        Edit HTML
      </a> )
  
</label>

<div class="controls ">
  <textarea
    id='title'    name='title'        data-rv-value='record.title'  ></textarea>
</div>

  
<label>

  Body
  <!-- ( Edit HTML ). -->
      ( <a class="label-link" data-textarea="body">
        Edit HTML
      </a> )
  
</label>

<div class="controls ">
  <textarea
    id='body'    name='body'        data-rv-value='record.body'  ></textarea>
</div>

</div>
    </div>
    <div class="tab-pane map" id="record-map">
      
<div class="control-group map">


  <label class="radio">
    <input type="radio" name="mode" value="pan" checked>
    Navigate
  </label>


  <label class="radio">
    <input type="radio" name="mode" value="point">
    Draw Point
  </label>


  <label class="radio">
    <input type="radio" name="mode" value="line">
    Draw Line
  </label>


  <label class="radio">
    <input type="radio" name="mode" value="poly">
    Draw Polygon
  </label>


  <label class="radio">
    <input type="radio" name="mode" value="regPoly">
    Draw Regular Polygon
  </label>


  <div class="control-group indent regular-polygon">

    <div class="inline-inputs">
      <input type="text" name="sides" value="3" />
      Sides
    </div>

    <div class="inline-inputs">
      <input type="text" name="snap" value="15" />
      Snap Angle
    </div>

    <label class="checkbox">
      <input type="checkbox" name="irreg">
      Irregular?
    </label>

  </div>


  <label class="radio">

    <input type="radio" name="mode" value="svg">
    Draw SVG ( <a href="#svg-modal" data-toggle="modal"
      class="label-link">Enter Markup</a>
    )

    <!-- SVG modal. -->
    
<div id="svg-modal" class="modal hide">

  <div class="modal-header">
    <h4>Enter SVG</h4>
  </div>

  <div class="modal-body">

    
<label>

  SVG
  <!-- ( Edit HTML ). -->
  
</label>

<div class="controls code">
  <textarea
        name='svg'    class='code'      ></textarea>
</div>

    
<label>

  <!-- Label text. -->
  Density
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='density'                  value='1.0'    />
  </div>
</div>

  </div>

  <div class="modal-footer">

    <a name="cancel" class="btn" data-dismiss="modal">
      <i class="icon-ban-circle"></i> Cancel
    </a>

    <a name="parse" class="btn btn-primary">
      <i class="icon-ok icon-white"></i> Parse
    </a>

  </div>

</div>

  </label>


  <label class="radio">
    <input type="radio" name="mode" value="modify">
    Modify Shape
  </label>


  <label class="radio">
    <input type="radio" name="mode" value="rotate">
    Rotate Shape
  </label>


  <label class="radio">
    <input type="radio" name="mode" value="resize">
    Resize Shape
  </label>


  <label class="radio">
    <input type="radio" name="mode" value="drag">
    Drag Shape
  </label>


  <label class="radio">
    <input type="radio" name="mode" value="remove">
    Delete Shape
  </label>


  <div class="control-group">
    <a name="clear" class="btn btn-primary btn-small">
      <i class="icon-refresh icon-white"></i> Clear all Geometry
    </a>
  </div>


  <hr>


  
<label>

  Geometry (Well-Known Text)
  <!-- ( Edit HTML ). -->
  
</label>

<div class="controls code">
  <textarea
        name='coverage'    class='code'    data-rv-value='record.coverage'  ></textarea>
</div>


</div>
    </div>
    <div class="tab-pane style" id="record-style">
      
<div class="control-group">

  <legend>Groups</legend>

  
<label>

  <!-- Label text. -->
  Tags
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='tags'            data-rv-value='record.tags'          />
  </div>
</div>

      
<label>Widgets</label>

<div class="controls">
  <div class="inline-inputs">
    <select
      name='widgets'      multiple='multiple'            data-rv-value='record.widgets | commaDelimited'    >
              <option value="Simile">
          SIMILE Timeline        </option>
              <option value="Waypoints">
          Waypoints        </option>
              <option value="Widget1">
          Widget1 Label        </option>
              <option value="Widget2">
          Widget2 Label        </option>
              <option value="Widget3">
          Widget3 Label        </option>
          </select>
  </div>
</div>
  
  
<label>Presenter</label>

<div class="controls">
  <div class="inline-inputs">
    <select
      name='presenter'                  data-rv-value='record.presenter'    >
              <option value="None">
          None        </option>
              <option value="StaticBubble">
          Static Bubble        </option>
              <option value="Presenter1">
          Presenter1 Label        </option>
              <option value="Presenter2">
          Presenter2 Label        </option>
              <option value="Presenter3">
          Presenter3 Label        </option>
          </select>
  </div>
</div>

  <legend>Colors</legend>

  
<label>

  <!-- Label text. -->
  Fill Color
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='fill-color'      class='preview color'      data-rv-value='record.fill_color'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Fill Color (Selected)
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='fill-color-select'      class='preview color'      data-rv-value='record.fill_color_select'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Stroke Color
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='stroke-color'      class='preview color'      data-rv-value='record.stroke_color'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Stroke Color (Selected)
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='stroke-color-select'      class='preview color'      data-rv-value='record.stroke_color_select'          />
  </div>
</div>

  <legend>Opacities</legend>

  
<label>

  <!-- Label text. -->
  Fill Opacity
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='fill-opacity'      class='preview opacity'      data-rv-value='record.fill_opacity'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Fill Opacity (Selected)
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='fill-opacity-select'      class='preview opacity'      data-rv-value='record.fill_opacity_select'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Stroke Opacity
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='stroke-opacity'      class='preview opacity'      data-rv-value='record.stroke_opacity'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Stroke Opacity (Selected)
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='stroke-opacity-select'      class='preview opacity'      data-rv-value='record.stroke_opacity_select'          />
  </div>
</div>

  <legend>Dimensions</legend>

  
<label>

  <!-- Label text. -->
  Stroke Width
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='stroke-width'      class='preview integer'      data-rv-value='record.stroke_width'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Point Radius
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='point-radius'      class='preview integer'      data-rv-value='record.point_radius'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Z-Index
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='zindex'            data-rv-value='record.zindex'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Order / Weight
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='weight'            data-rv-value='record.weight'          />
  </div>
</div>

  <legend>Dates</legend>

  
<label>

  <!-- Label text. -->
  Start Date
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='start-date'            data-rv-value='record.start_date'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  End Date
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='end-date'            data-rv-value='record.end_date'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  After Date
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='after-date'            data-rv-value='record.after_date'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Before Date
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='before-date'            data-rv-value='record.before_date'          />
  </div>
</div>

  <legend>Imagery</legend>

  
<label>

  <!-- Label text. -->
  Point Image
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='point-image'      class='preview'      data-rv-value='record.point_image'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  WMS Address
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='wms-address'            data-rv-value='record.wms_address'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  WMS Layers
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='wms-layers'            data-rv-value='record.wms_layers'          />
  </div>
</div>

  <legend>Visibility</legend>

  
<label>

  <!-- Label text. -->
  Min Zoom
  <!-- ( Use Current ). -->
      ( <a class="label-link" name="set-min-zoom">
        Use Current
      </a> )
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='min-zoom'            data-rv-value='record.min_zoom'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Max Zoom
  <!-- ( Use Current ). -->
      ( <a class="label-link" name="set-max-zoom">
        Use Current
      </a> )
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='max-zoom'            data-rv-value='record.max_zoom'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Default Focus
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='map-focus'            data-rv-value='record.map_focus'          />
  </div>
</div>

  
<label>

  <!-- Label text. -->
  Default Zoom
  <!-- ( Use Current ). -->
  
</label>

<div class="controls">
  <div class="inline-inputs">
    <input
      type="text"
            name='map-zoom'            data-rv-value='record.map_zoom'          />
  </div>
</div>

  
<div class="controls">
  <div class="inline-inputs">
    <a class="btn btn-small"
      name='set-focus'>
      <i class='icon-map-marker'></i>
      Use Current Viewport as Default    </a>
  </div>
</div>

</div>
    </div>
  </div>

  <!-- Save/Delete buttons. -->
  
<div class="actions">

  <a name="save" class="btn btn-primary btn-large" \>
    <i class="icon-ok icon-white"></i> Save  </a>

  <a href="#delete-modal" class="btn btn-inverse btn-large"
    data-toggle="modal"><i class="icon-trash icon-white"></i>
    Delete  </a>

</div>

<div id="delete-modal" class="modal hide">

  <div class="modal-header">
    <h4>Are you sure?</h4>
  </div>

  <div class="modal-body">
    <p>
      This will delete the record from the database and remove all
        associated metadata. This action cannot be undone.    </p>
  </div>

  <div class="modal-footer">

    <a name="cancel" class="btn" data-dismiss="modal">
      <i class="icon-ban-circle"></i> Cancel
    </a>

    <a name="delete" class="btn btn-danger">
      <i class="icon-trash icon-white"></i> Yes, delete
    </a>

  </div>

</div>

</script>

<script id="record-list-template" type="text/template">

  <!-- Top pagination. -->
  
<%

  // Base fragment.
  var prev = '#records/search';
  var next = '#records/search';

  // Add existing query.
  if (!_.isEmpty(query)) {
    prev += '/query='+query;
    next += '/query='+query;
  }

  // Compute back/forward offsets.
  var prevStart = records.offset-limit;
  var nextStart = records.offset+limit;

  var prevActive = true;
  var nextActive = true;

  // Add prev offset.
  if (prevStart > 0) {
    prev += '/start='+prevStart;
  } else {
    if (_.isEmpty(query)) prev = '#records';
    if (records.offset == 0) prevActive = false;
  }

  // Add next offset.
  if (nextStart < records.count) {
    next += '/start='+nextStart;
  } else {
    next += '/start='+records.offset;
    nextActive = false;
  }

%>

<% if (
  !_.string.startsWith(query, 'map:') &&
  records.count > Neatline.g.neatline.per_page
) { %>

  <div class="pagination">
    <ul class="prev-next">
      <li <% if (!prevActive) {
        %><%='class="disabled"'%><%
      } %>><a class="prev" href="<%= prev %>">«</a></li>
      <li <% if (!nextActive) {
        %><%='class="disabled"'%><%
      } %>><a class="next" href="<%= next %>">»</a></li>
    </ul>
    <div class="pagination-details">
      <span class="start"><%= records.offset+1 %></span> -
      <span class="end"><%= records.offset+records.length %></span> of
      <span class="total"><%= records.count %></span>
    </div>
  </div>

<% } %>

  <ul class="list">

    <!-- Add record link. -->
    <a href="#record/add">New Record</a>

    <% records.each(function(r) { %>

      <!-- Record listing. -->
      <a href="#record/<%= r.id %>" data-id="<%= r.id %>">

        <!-- Title. -->
        <span class="title">
          <% if (!_.isEmpty(r.get('title'))) { %>
            <%= _.string.stripTags(r.get('title')) %>
          <% } else { %>
            <%= STRINGS.record.placeholders.title %>
          <% } %>
        </span>

        <!-- Body. -->
        <span class="body">
          <%= _.string.stripTags(r.get('body')) %>
        </span>

      </a>

    <% }); %>

  </ul>

  <!-- Bottom pagination. -->
  
<%

  // Base fragment.
  var prev = '#records/search';
  var next = '#records/search';

  // Add existing query.
  if (!_.isEmpty(query)) {
    prev += '/query='+query;
    next += '/query='+query;
  }

  // Compute back/forward offsets.
  var prevStart = records.offset-limit;
  var nextStart = records.offset+limit;

  var prevActive = true;
  var nextActive = true;

  // Add prev offset.
  if (prevStart > 0) {
    prev += '/start='+prevStart;
  } else {
    if (_.isEmpty(query)) prev = '#records';
    if (records.offset == 0) prevActive = false;
  }

  // Add next offset.
  if (nextStart < records.count) {
    next += '/start='+nextStart;
  } else {
    next += '/start='+records.offset;
    nextActive = false;
  }

%>

<% if (
  !_.string.startsWith(query, 'map:') &&
  records.count > Neatline.g.neatline.per_page
) { %>

  <div class="pagination">
    <ul class="prev-next">
      <li <% if (!prevActive) {
        %><%='class="disabled"'%><%
      } %>><a class="prev" href="<%= prev %>">«</a></li>
      <li <% if (!nextActive) {
        %><%='class="disabled"'%><%
      } %>><a class="next" href="<%= next %>">»</a></li>
    </ul>
    <div class="pagination-details">
      <span class="start"><%= records.offset+1 %></span> -
      <span class="end"><%= records.offset+records.length %></span> of
      <span class="total"><%= records.count %></span>
    </div>
  </div>

<% } %>

</script>

<script id="search-template" type="text/template">
  <input type="text" placeholder="Search" />
</script>

<!-- Plugin templates. -->
