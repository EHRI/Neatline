(function(e,t){"use strict";e.widget("neatline.neatline",{options:{isPublic:!0,markup:{map_id:"map",timeline_id:"timeline",items_id:"items",scroller:"scroll"}},_create:function(){this.params=Neatline,this._window=e(window),this._body=e("body"),this.map=e("#"+this.options.markup.map_id),this.timeline=e("#"+this.options.markup.timeline_id),this.items=e("#"+this.options.markup.items_id),this.scroller=e("#"+this.options.markup.scroller),this.instantiated_map=!1,this.instantiated_timeline=!1,this.instantiated_undated=!1,this.frozenOut=null,this._getMajorBlock(),this._instantiatePositioner(),this.positionDivs(),this.instantiateBlocks(),this.instantiateBubbles(),this.refreshDivs(),this.element.disableSelection(),this._window.resize(_.bind(function(){this.positionDivs()},this))},_instantiatePositioner:function(){var e=this;this.element.positioner({markup:{map:"#"+this.options.markup.map_id,timeline:"#"+this.options.markup.timeline_id,items:"#"+this.options.markup.items_id},constants:{h_percent:this.params.proportions.horizontal,v_percent:this.params.proportions.vertical},drag:function(t,n){e._trigger("widthdrag",{},n),e.timeline.neatlinetimeline("refresh")},layoutChange:function(){e.timeline.neatlinetimeline("refresh")}})},setParams:function(e){this.params.record=e,this._getMajorBlock()},_getMajorBlock:function(){this.params.record.is_map&&this.params.record.is_timeline?this.params.record.top_element==="map"?(this.majorBlock=this.map,this.majorBlockId="map"):this.params.record.top_element==="timeline"&&(this.majorBlock=this.timeline,this.majorBlockId="timeline"):this.params.record.is_map?(this.majorBlock=this.map,this.majorBlockId="map"):this.params.record.is_timeline&&(this.majorBlock=this.timeline,this.majorBlockId="timeline")},positionDivs:function(){this.element.positioner("measure"),this.positions=this.element.positioner("compute",this.params.record.is_map,this.params.record.is_timeline,this.params.record.is_items,this.params.record.top_element,this.params.record.items_v_pos,this.params.record.items_h_pos,this.params.record.items_height),this.element.positioner("apply"),this.refreshDivs()},refreshDivs:function(){this.timeline.neatlinetimeline("refresh"),this.options.isPublic?this.map.neatlinemap("refresh",this.positions.map):this.map.mapeditor("refresh",this.positions.map)},_getContainerDimensions:function(){this.containerWidth=this.element.width(),this.containerHeight=this.element.height()},instantiateBlocks:function(){var e=this;if(this.params.record.is_map&&!this.instantiated_map){var t={featureadded:function(t,n){e._trigger("mapfeatureadded",{},n)},featureenter:function(t,n){e._trigger("mapfeatureenter",{},n),e.options.isPublic&&n.record.data.show_bubble==1&&(!n.record.selected||e.items.length===0)&&(e.freezeOut(n.record.data),e.element.bubbles("show",n.record.data.title,n.record.data.description))},featureleave:function(t,n){var r=jQuery(e.element).data("bubbles");e._trigger("mapfeatureleave",{},n),e.options.isPublic&&r!=null&&r.bubble!=null&&r.hide(),e.thawOut(!0),e._trigger("mapfeatureleave",{},n)},featureclick:function(t,n){e._trigger("mapfeatureclick",{},n),e.options.isPublic&&(e.useFrozen(),e.element.bubbles("freeze"))},featureunselect:function(t,n){e.options.isPublic&&e.element.bubbles("getTitle")===n.record.data.title&&e.element.bubbles("close"),e.thawOut()}};this.options.isPublic?this.map.neatlinemap(t):this.map.mapeditor(t);var n=this.map.data("neatlinemap");n.map.events.register("mouseout",{},function(e,t){n._hoveredFeature!=null}),this.instantiated_map=!0}this.params.record.is_timeline&&!this.instantiated_timeline&&(this.timeline.neatlinetimeline({scroll:function(t,n){e.map.neatlinemap("renderVisibility",n.date),e.items.neatlineitems("renderVisibility",n.date)},evententer:function(t,n){e.options.isPublic&&n.show_bubble==1&&e.element.bubbles("show",n.title,n.description)},eventleave:function(t,n){e.options.isPublic&&e.element.bubbles("hide")},eventclick:function(t,n){e._trigger("timelineeventclick",{},n),e.options.isPublic&&e.element.bubbles("freeze")}}),this.instantiated_timeline=!0);if(this.params.record.is_items&&!this.instantiated_undated){var t={itemclick:function(t,n){e._trigger("itemclick",{},n)},itementer:function(t,n){e._trigger("itementer",{},n),e.map.neatlinemap("highlightVectors",n.recordid)},itemleave:function(t,n){e._trigger("itemleave",{},n),e.map.neatlinemap("unhighlightVectors",n.recordid)},itemactivate:function(t,n){e._trigger("itemactivate",{},n),e.map.neatlinemap("selectVectors",n.recordid)},itemdeactivate:function(t,n){e._trigger("itemdeactivate",{},n),e.map.neatlinemap("unselectVectors",n.recordid)}};this.options.isPublic?this.items.neatlineitems(t):this.items.itemorderer(t),this.instantiated_undated=!0}},instantiateBubbles:function(){this.element.bubbles({cursorleave:_.bind(function(){this.map.neatlinemap("unhighlightHoveredRecord")},this),close:_.bind(function(){this.map.neatlinemap("unselectSelectedRecord")},this)})},freezeOut:function(t){if(this.element.bubbles("isFrozen")){var n=e(window),r=this;this.frozenOut={data:t,event:null},n.on("mousemove.frozen",function(e){_.isNull(r.frozenOut)?n.off("mousemove.frozen"):r.frozenOut.event=e})}},thawOut:function(t){!_.isNull(this.frozenOut)&&(t||this.frozenOut.data.title==this.element.bubbles("getTitle"))&&(e(window).off("mousemove.frozen"),this.frozenOut=null)},useFrozen:function(){if(!_.isNull(this.frozenOut)){var e=this.element;e.bubbles("show",this.frozenOut.data.title,this.frozenOut.data.description),e.bubbles("position",this.frozenOut.event),this.thawOut(!0)}},positionBlockMarkup:function(){this.items.neatlineitems("positionMarkup")},saveSuccess:function(){this.element.css("opacity",0),this.element.animate({opacity:1},500)},editMap:function(e,t){this.map.neatlinemap("edit",e,t)},endMapEditWithoutSave:function(e){this.map.neatlinemap("endEditWithoutSave",e)},getWktForSave:function(){return this.instantiated_map?this.map.neatlinemap("getWktForSave"):null},reloadTimeline:function(){this.timeline.neatlinetimeline("loadData")},reloadMap:function(){this.map.neatlinemap("loadData")},reloadItems:function(){this.items.neatlineitems("loadData")},zoomMapToItemVectors:function(e){this.map.neatlinemap("zoomToItemVectors",e)},zoomMapToItemVectorsBySlug:function(e){this.map.neatlinemap("zoomToItemVectorsBySlug",e)},zoomTimelineToEvent:function(e){this.timeline.neatlinetimeline("zoomToEvent",e)},zoomTimelineToEventBySlug:function(e){this.timeline.neatlinetimeline("zoomToEventBySlug",e)},showItemDescription:function(e){this.items.neatlineitems("scrollToItem",e)},showItemDescriptionBySlug:function(e){this.items.neatlineitems("scrollToItemBySlug",e)},setItemVectorColor:function(e,t){this.map.neatlinemap("setCurrentRecordStyle","vector_color",e),this.timeline.neatlinetimeline("setDateColor",t,e)},setItemStrokeColor:function(e){this.map.neatlinemap("setCurrentRecordStyle","stroke_color",e)},setItemHighlightColor:function(e){this.map.neatlinemap("setCurrentRecordStyle","highlight_color",e)},setItemVectorOpacity:function(e){this.map.neatlinemap("setCurrentRecordStyle","vector_opacity",e/100)},setItemStrokeOpacity:function(e){this.map.neatlinemap("setCurrentRecordStyle","stroke_opacity",e/100)},setItemGraphicOpacity:function(e){this.map.neatlinemap("setCurrentRecordStyle","graphic_opacity",e/100)},setItemStrokeWidth:function(e){this.map.neatlinemap("setCurrentRecordStyle","stroke_width",e)},setItemPointRadius:function(e){this.map.neatlinemap("setCurrentRecordStyle","point_radius",e)},setDefaultVectorColor:function(e){this.map.neatlinemap("setDefaultStyle","vector_color",e),this.timeline.neatlinetimeline("setDefaultDateColor",e)},setDefaultStrokeColor:function(e){this.map.neatlinemap("setDefaultStyle","stroke_color",e)},setDefaultHighlightColor:function(e){this.map.neatlinemap("setDefaultStyle","highlight_color",e)},setDefaultVectorOpacity:function(e){this.map.neatlinemap("setDefaultStyle","vector_opacity",e/100)},setDefaultStrokeOpacity:function(e){this.map.neatlinemap("setDefaultStyle","stroke_opacity",e/100)},setDefaultStrokeWidth:function(e){this.map.neatlinemap("setDefaultStyle","stroke_width",e)},setDefaultPointRadius:function(e){this.map.neatlinemap("setDefaultStyle","point_radius",e)},setDateAmbiguity:function(e,t,n,r){this.timeline.neatlinetimeline("setDateAmbiguity",e,t,n,r)},highlightMapBySlug:function(e){this.map.neatlinemap("highlightVectorsBySlug",e)},unhighlightMapBySlug:function(e){this.map.neatlinemap("unhighlightVectorsBySlug",e)},getMapExtent:function(){return this.map.neatlinemap("getExtentForSave")},getMapCenter:function(){return this.map.neatlinemap("getCenterForSave")},getMapZoom:function(){return this.map.neatlinemap("getZoomForSave")},getMapBaseLayer:function(){return this.map.neatlinemap("getBaseLayerForSave")},getTimelineCenter:function(){return this.instantiated_timeline?this.timeline.neatlinetimeline("getCenterForSave"):null},getTimelineZoom:function(){return this.instantiated_timeline?this.timeline.neatlinetimeline("getZoomForSave"):null},reorderItems:function(){this.items.neatlineitems("reorder")},getOrder:function(){return this.items.neatlineitems("objectifyOrder")},endReorderItems:function(){return this.items.neatlineitems("endreorder")},renderTimelineDefaults:function(e,t,n){this.timeline.neatlinetimeline("renderDefaults",e,t,n)},applyViewportProportions:function(e,t){this.element.positioner("applyProportions",e,t),this.timeline.neatlinetimeline("refresh")}})})(jQuery),function(e,t){"use strict";e.widget("neatline.neatlinemap",{options:{mode:"edit",wkt_delimiter:"|",animation:{fade_duration:500},colors:{neatline_purple:"#724E85",highlight_red:"#d04545"},styles:{vector_color:"#ffb80e",stroke_color:"#ea3a3a",highlight_color:"#ff0000",vector_opacity:.4,stroke_opacity:.6,stroke_width:1,point_radius:6}},_create:function(){var t=this;this._window=e(window),this._db=TAFFY(),this._currentVectorLayers=[],this._currentEditItem=null,this._currentEditLayer=null,this._hoveredRecord=null,this._selectedRecord=null,this._hoveredFeature=null,this._clickedFeature=null,this.record=null,this.requestData=null,this.now=Date.now(),Neatline.record.image_id?this._instantiateImageMap():this._instantiateRealGeographyMap(),this.loadData()},_instantiateRealGeographyMap:function(){OpenLayers.IMAGE_RELOAD_ATTEMTPS=3,OpenLayers.Util.onImageLoadErrorColor="transparent",OpenLayers.ImgPath="http://js.mapbox.com/theme/dark/";var e,t=!0;OpenLayers.IMAGE_RELOAD_ATTEMPTS=5,OpenLayers.DOTS_PER_INCH=25.4/.28;var n="image/png";t&&(n="image/png8");var r=new OpenLayers.Bounds(-8344149.6594826,4855703.4254752,-8119424.7963554,5104888.1376502);this.mousePosition=new OpenLayers.Control.MousePosition;var i={controls:[this.mousePosition,new OpenLayers.Control.PanZoomBar,new OpenLayers.Control.Navigation({documentDrag:!0}),new OpenLayers.Control.LayerSwitcher],maxResolution:"auto",units:"m"};this.map=new OpenLayers.Map("map",i);var s=this._getBaseLayers();this.map.addLayers(s),this._setDefaultLayer();if(!this.setViewport(Neatline.record.map_bounds,Neatline.record.map_zoom)){var o=new OpenLayers.Control.Geolocate({bind:!0,watch:!1});o.events.on({locationfailed:function(){self.map.setCenter(new OpenLayers.LonLat(-8738850.21367,4584105.47978),3,!1,!1)}}),this.map.addControl(o),this.map.zoomTo(6),o.activate()}},_instantiateImageMap:function(){OpenLayers.IMAGE_RELOAD_ATTEMTPS=3,OpenLayers.Util.onImageLoadErrorColor="transparent",OpenLayers.ImgPath="http://js.mapbox.com/theme/dark/",OpenLayers.DOTS_PER_INCH=25.4/.28;var e={controls:[new OpenLayers.Control.PanZoomBar,new OpenLayers.Control.MousePosition,new OpenLayers.Control.Navigation],maxResolution:"auto"};this.map=new OpenLayers.Map("map",e);var t=new OpenLayers.Bounds(0,0,Neatline.image.width,Neatline.image.height),n=new OpenLayers.Size(Neatline.image.width,Neatline.image.height);this.baseLayer=new OpenLayers.Layer.Image(Neatline.image.name,Neatline.image.path,t,n,e),this.map.addLayers([this.baseLayer]),this.setViewport(Neatline.record.map_bounds,Neatline.record.map_zoom)||this.map.zoomToExtent(t)},positionControls:function(e,t,n,r){this.panZoomBar=this.element.find(".olControlPanZoomBar"),this.layerSwitcher=this.element.find(".olControlLayerSwitcher");var i=this.element.width(),s=this.element.height();this.layerSwitcher.css({top:e+25,right:i-(t+n)}),this.panZoomBar.css({top:e+10,left:t+5})},loadData:function(){var t=this;this._removeSelectControls(),this._removeEditControls(),_.each(this._currentVectorLayers,function(e){t.map.removeLayer(e),e.destroy()}),_.each(this._wmsLayers,function(e){t.map.removeLayer(e)}),this._currentVectorLayers=[],this._wmsLayers=[],this.requestData!==null&&this.requestData.abort(),this.requestData=e.ajax({url:Neatline.dataSources.map,dataType:"json",success:function(e){t._buildLayers(e),t._addClickControls(),t._currentEditItem!==null&&t.edit(t._currentEditItem,!0)}})},_buildLayers:function(t){var n=this;this._db=TAFFY(),_.each(t,function(t){var r=new OpenLayers.Format.KML,i=[];i=r.read(t.wkt),_.isEmpty(i)&&(_.isNull(t.wkt)||e.each(t.wkt.split(n.options.wkt_delimiter),function(e,t){var n=new OpenLayers.Format.WKT;if(!_.isUndefined(n.read(t))){var r=new OpenLayers.Geometry.fromWKT(t),s=new OpenLayers.Feature.Vector(r);i.push(s)}})),t.vector_opacity=t.vector_opacity/100,t.stroke_opacity=t.stroke_opacity/100,t.select_opacity=t.select_opacity/100,t.graphic_opacity=t.graphic_opacity/100;var s=n._getStyleMap(t.vector_color,t.vector_opacity,t.stroke_color,t.stroke_opacity,t.stroke_width,t.point_radius,t.point_image,t.highlight_color,t.select_opacity,t.graphic_opacity),o=new OpenLayers.Layer.Vector(t.title,{styleMap:s,displayInLayerSwitcher:!1});o.addFeatures(i),o.setMap(n.map);var u=null;!_.isNull(t.wmsAddress)&&!_.isNull(t.layers)&&(u=new OpenLayers.Layer.WMS(t.title,t.wmsAddress,{layers:t.layers,styles:"",transparent:!0,format:"image/png8",tiled:!1},{buffer:0,displayOutsideMaxExtent:!0,isBaseLayer:!1}),u.opacity=t.vector_opacity,n._wmsLayers.push(u),n.map.addLayer(u)),n._db.insert({itemid:t.item_id,layerid:o.id,recordid:t.id,slug:t.slug,data:t,layer:o,wms:u,selected:!1}),n._currentVectorLayers.push(o),n.map.addLayer(o)}),this.renderVisibility(this.now)},_addClickControls:function(){var e=this;this._removeSelectControls(),this.highlightControl=new OpenLayers.Control.SelectFeature(this._currentVectorLayers,{hover:!0,highlightOnly:!0,renderIntent:"select",overFeature:function(t){var n=e._db({layerid:t.layer.id}).first();e._trigger("featureenter",{},{record:n}),n.selected||_.each(n.layer.features,function(t){e.highlightControl.highlight(t)}),e._hoveredRecord=n,e._hoveredFeature=t},outFeature:function(t){var n=e._db({layerid:t.layer.id}).first();e._trigger("featureleave",{},{record:n}),n.selected||_.each(n.layer.features,function(t){e.highlightControl.unhighlight(t)}),e._hoveredRecord=null,e._hoveredFeature=null}}),this.clickControl=new OpenLayers.Control.SelectFeature(this._currentVectorLayers,{clickout:!0,toggle:!0,onSelect:function(t){var n=e._db({layerid:t.layer.id}).first();e._clickedFeature=t,e._selectedRecord=n,n.selected=!0,e._trigger("featureclick",{},{recordid:n.recordid,slug:n.data.slug}),_.isUndefined(e.modifyFeatures)||e.modifyFeatures.selectFeature(e._clickedFeature)},onUnselect:function(n){var r=e._db({layerid:n.layer.id}).first();e._clickedFeature=null,r.selected=!1,e.unselectVectors(r.id),_.isUndefined(e.modifyFeatures)||e.modifyFeatures.unselectFeature(n),e._trigger("featureunselect",t,{feature:n,record:r})}}),this.highlightControl.handlers.feature.stopDown=!1,this.clickControl.handlers.feature.stopDown=!1,this.map.addControl(this.highlightControl),this.highlightControl.activate(),this.map.addControl(this.clickControl),this.clickControl.activate()},_removeSelectControls:function(){_.isUndefined(this.clickControl)||(this.map.removeControl(this.clickControl),this.clickControl.destroy(),delete this.clickControl),_.isUndefined(this.highlightControl)||(this.map.removeControl(this.highlightControl),this.highlightControl.destroy(),delete this.highlightControl)},_removeEditControls:function(){_.isUndefined(this.editToolbar)||(this.map.removeControl(this.editToolbar),this.editToolbar.destroy(),delete this.editToolbar),_.isUndefined(this.modifyFeatures)||(this.map.removeControl(this.modifyFeatures),this.modifyFeatures.destroy(),delete this.modifyFeatures)},_setStartingVisibility:function(){Neatline.record.focus_date?this.renderVisibility(Neatline.record.focus_date):this.renderVisibility(Date.now())},zoomToItemVectors:function(e){var t=this._db({recordid:parseInt(e,10)}).first();this._selectRecord(t)},zoomToItemVectorsBySlug:function(e){var t=this._db({slug:e}).first();this._selectRecord(t)},renderVisibility:function(e){this.now=moment(e),this._db().each(_.bind(function(e){var t=moment(e.data.start_visible_date),n=moment(e.data.end_visible_date);if(!_.isNull(t)&&!_.isNull(n)){var r=this.now>t&&this.now<n;e.layer.setVisibility(r),e.wms&&e.wms.setVisibility(r)}else if(!_.isNull(t)&&_.isNull(n)){var r=this.now>t;e.layer.setVisibility(r),e.wms&&e.wms.setVisibility(r)}else if(_.isNull(t)&&!_.isNull(n)){var r=this.now<n;e.layer.setVisibility(r),e.wms&&e.wms.setVisibility(r)}},this))},_selectRecord:function(e){if(e&&e.layer.features.length>0){var t=e.data.bounds||e.data.center;if(!this.setViewport(t,e.data.zoom)){var n=e.layer.getDataExtent();_.isNaN(n.top)||this.map.zoomToExtent(e.layer.getDataExtent())}}e&&!_.isNull(e.wms),e.selected=!0},_resetWmsZIndices:function(){_.each(this._wmsLayers,function(e){e.setZIndex(0)})},_getStyleMap:function(e,t,n,r,i,s,o,u,a,f){return new OpenLayers.StyleMap({"default":new OpenLayers.Style({fillColor:e,fillOpacity:t,strokeColor:n,strokeOpacity:r,pointRadius:s,externalGraphic:o,strokeWidth:i,graphicOpacity:f}),select:new OpenLayers.Style({fillColor:u,fillOpacity:a,strokeColor:u,strokeOpacity:r,pointRadius:s,externalGraphic:o,strokeWidth:i,graphicOpacity:f}),temporary:new OpenLayers.Style({fillColor:u,fillOpacity:t,strokeColor:u,strokeOpacity:r,pointRadius:s,externalGraphic:o,strokeWidth:i,graphicOpacity:f})})},_getBaseLayers:function(){return this.osm=new OpenLayers.Layer.OSM,this.gphy=new OpenLayers.Layer.Google("Google Physical",{type:google.maps.MapTypeId.TERRAIN}),this.gmap=new OpenLayers.Layer.Google("Google Streets",{numZoomLevels:20}),this.ghyb=new OpenLayers.Layer.Google("Google Hybrid",{type:google.maps.MapTypeId.HYBRID,numZoomLevels:20}),this.gsat=new OpenLayers.Layer.Google("Google Satellite",{type:google.maps.MapTypeId.SATELLITE,numZoomLevels:22}),this.stwc=new OpenLayers.Layer.Stamen("Stamen Watercolor",{provider:"watercolor",tileOptions:{crossOriginKeyword:null}}),this.sttn=new OpenLayers.Layer.Stamen("Stamen Toner",{provider:"toner",tileOptions:{crossOriginKeyword:null}}),this.sttr=new OpenLayers.Layer.Stamen("Stamen Terrain",{provider:"terrain",tileOptions:{crossOriginKeyword:null}}),[this.osm,this.gphy,this.gmap,this.ghyb,this.gsat,this.stwc,this.sttn,this.sttr]},_setDefaultLayer:function(){switch(Neatline.baseLayer.name){case"OpenStreetMap":this.map.setBaseLayer(this.osm);break;case"Google Physical":this.map.setBaseLayer(this.gphy);break;case"Google Streets":this.map.setBaseLayer(this.gmap);break;case"Google Hybrid":this.map.setBaseLayer(this.ghyb);break;case"Google Satellite":this.map.setBaseLayer(this.gsat);break;case"Stamen Watercolor":this.map.setBaseLayer(this.stwc);break;case"Stamen Toner":this.map.setBaseLayer(this.sttn);break;case"Stamen Terrain":this.map.setBaseLayer(this.sttr)}},selectVectors:function(e){var t=this._db({recordid:parseInt(e,10)}).first();this._renderVectorSelect(t)},_renderVectorSelect:function(t){var n=this;if(!t||_.isUndefined(t.data))return;e.each(t.layer.features,function(e,t){n.highlightControl.select(t)}),_.isNull(t.wms)||t.wms.setOpacity(t.data.select_opacity)},unselectSelectedRecord:function(){this._removeVectorSelect(this._selectedRecord)},unselectVectors:function(e){var t=this._db({recordid:parseInt(e,10)}).first();this._removeVectorSelect(t)},_removeVectorSelect:function(t){var n=this;if(!t||_.isUndefined(t.data))return;e.each(t.layer.features,function(e,t){n.highlightControl.unselect(t)}),_.isNull(t.wms)||t.wms.setOpacity(t.data.vector_opacity),t.selected=!1},highlightVectors:function(e){var t=this._db({recordid:parseInt(e,10)}).first();this._renderVectorHighlight(t)},highlightVectorsBySlug:function(e){var t=this._db({slug:e}).first();this._renderVectorHighlight(t)},_renderVectorHighlight:function(t){var n=this;if(!t||_.isUndefined(t.data))return;e.each(t.layer.features,function(e,t){n.highlightControl.highlight(t)})},unhighlightHoveredRecord:function(){this._removeVectorHighlight(this._hoveredRecord)},unhighlightVectors:function(e){var t=this._db({recordid:parseInt(e,10)}).first();this._removeVectorHighlight(t)},unhighlightVectorsBySlug:function(e){var t=this._db({slug:e}).first();this._removeVectorHighlight(t)},_removeVectorHighlight:function(t){var n=this;if(_.isUndefined(t.data)||t.selected)return;e.each(t.layer.features,function(e,t){n.highlightControl.unhighlight(t)})},refresh:function(e){this.map.updateSize(),this.positionControls(e.top,e.left,e.width,e.height)},setViewport:function(e,t){var n=!1;if(!_.isNull(e)){var r=e.split(",");if(r.length===4)this.map.zoomToExtent(new OpenLayers.Bounds(parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]))),n=!0;else if(r.length===2){var t=_.isNull(t)?5:parseInt(t,10),i=new OpenLayers.LonLat(parseFloat(r[0].trim()),parseFloat(r[1].trim()));this.map.setCenter(i,t),n=!0}}return n}})}(jQuery),function(e,t){e.widget("neatline.neatlinetimeline",{_create:function(){this._window=e(window),this.zoomContainer=e("#zoom-buttons"),this.zoomIn=this.zoomContainer.find(".zoom-in"),this.zoomOut=this.zoomContainer.find(".zoom-out"),this._idToTapeElements={},this._zoomSteps=this.getZoomIndexArray(),this._currentZoomStep=Neatline.timelineZoom,this._currentDate=null,this._instantiateSimile(),this._constructZoomButtons(),this.element.disableSelection()},_instantiateSimile:function(e){var t=this;this.zoomContainer.detach(),this.eventSource=new Timeline.DefaultEventSource;var n=this._zoomSteps[this._currentZoomStep],r=n.unit,i=n.pixelsPerInterval,s=Timeline.ClassicTheme.create();s.event.track.height=15,s.event.tape.height=10;var o=100;Neatline.timeline.isContextBand===1&&(o-=Neatline.timeline.contextBandHeight),this.bandInfos=[Timeline.createBandInfo({eventSource:this.eventSource,width:o+"%",intervalUnit:r,intervalPixels:i,zoomIndex:this._currentZoomStep,zoomSteps:this._zoomSteps,theme:s,timeZone:SimileAjax.DateTime.getTimezone()})];if(Neatline.timeline.isContextBand===1){var u=Neatline.timeline.contextBandUnit.toUpperCase();this.bandInfos.push(Timeline.createBandInfo({overview:!0,eventSource:this.eventSource,width:Neatline.timeline.contextBandHeight+"%",intervalUnit:Timeline.DateTime[u],intervalPixels:300})),this.bandInfos[1].syncWith=0,this.bandInfos[1].highlight=!0}var a=document.getElementById("timeline");this.timeline=Timeline.create(a,this.bandInfos),this.loadData(),e||(this._catchClickCallback(),this._catchZoomCallback()),this.timeline.getBand(0).addOnScrollListener(_.bind(function(){var e=this.timeline.getBand(0).getCenterVisibleDate();this._trigger("scroll",{},{date:e}),this._currentDate=e},this))},_constructZoomButtons:function(){var e=this;this.element.append(this.zoomContainer),this.zoomIn.bind("mousedown",function(){if(e._currentZoomStep>0){var t=e._getCenterOffset();e.timeline.getBand(0).zoom(!0,t.x,t.y)}e.refresh()}),this.zoomOut.bind("mousedown",function(){if(e._currentZoomStep<e._zoomSteps.length-1){var t=e._getCenterOffset();e.timeline.getBand(0).zoom(!1,t.x,t.y)}e.refresh()})},_catchClickCallback:function(){var e=this;Timeline.OriginalEventPainter.prototype._showBubble=function(t,n,r){e._trigger("eventclick",{},{recordid:r._eventID,slug:r._obj.slug})}},_catchZoomCallback:function(){var e=this;Timeline._Band.prototype.zoom=function(t,n,r,i){if(!this._zoomSteps)return;n+=this._viewOffset;var s=this._ether.pixelOffsetToDate(n),o=this._ether.zoom(t);this._etherPainter.zoom(o),this._moveEther(Math.round(-this._ether.dateToPixelOffset(s))),this._moveEther(n),t?e._incrementZoomStepDown():e._incrementZoomStepUp()}},loadData:function(){var e=this,t;this.timeline.loadJSON(Neatline.dataSources.timeline,_.bind(function(e,t){this.eventSource.clear(),this.eventSource.loadJSON(e,t)},this)),_.isNull(this._currentDate)?Neatline.focus_date!==null&&(t=Date.parse(Neatline.record.focus_date),this.timeline.getBand(0).setCenterVisibleDate(t)):(t=this._currentDate,this.timeline.getBand(0).setCenterVisibleDate(t));var n=this.timeline.getBand(0),r=n.getEventPainter();r.addEventPaintListener(_.bind(function(e,t,n,r){r!==null&&(this._buildSpanStyler(n,r),this._listenForHover(n,r))},this))},_buildSpanStyler:function(t,n){var r=e(n[0]);r.data("positioningStyles",r.attr("style")),r.spanstyler(),r.spanstyler("constructCss",t._obj.color,t._obj.left_ambiguity,t._obj.right_ambiguity),r.spanstyler("applyCss"),this._idToTapeElements[t._eventID]=[r]},_listenForHover:function(t,n){_.each(n,_.bind(function(n){e(n).bind({mouseenter:_.bind(function(){this._trigger("evententer",{},{id:t._eventID,title:t._text,description:t._description,show_bubble:t._obj.show_bubble})},this),mouseleave:_.bind(function(){this._trigger("eventleave",{},{id:t._eventID,title:t._text,description:t._description,show_bubble:t._obj.show_bubble})},this)})},this))},_getCenterOffset:function(){var t=this.timeline.getBand(0)._div;return{x:-parseInt(e(t).css("left"),10)+this.element.width()/2,y:-parseInt(e(t).css("top"),10)+this.element.height()/2}},zoomToEvent:function(t){var n=this;e.each(this.timeline._bands[0]._eventSource._events._idToEvent,function(e,r){r._eventID===parseInt(t,10)&&n.timeline.getBand(0).setCenterVisibleDate(r._start)})},zoomToEventBySlug:function(t){var n=this;e.each(this.timeline._bands[0]._eventSource._events._idToEvent,function(e,r){r._obj.slug===t&&n.timeline.getBand(0).setCenterVisibleDate(r._start)})},getCenterForSave:function(){return this.timeline.getBand(0).getCenterVisibleDate().toString()},getZoomForSave:function(){return this._currentZoomStep},setDateAmbiguity:function(t,n,r,i){var s=this;typeof this._idToTapeElements[t]!="undefined"&&e.each(this._idToTapeElements[t],function(e,t){t.attr("style",t.data("positioningStyles")),t.spanstyler("constructCss",n,r,i),t.spanstyler("applyCss")})},setDateColor:function(t,n){var r=this;typeof this._idToTapeElements[t]!="undefined"&&e.each(this._idToTapeElements[t],function(e,t){t.attr("style",t.data("positioningStyles")),t.spanstyler("constructCss",n,null,null),t.spanstyler("applyCss")})},renderDefaults:function(e,t,n){Neatline.record.is_context_band=n,Neatline.record.context_band_height=e,Neatline.record.context_band_unit=t,Neatline.timeline.isContextBand=n,Neatline.timeline.contextBandUnit=t,Neatline.timeline.contextBandHeight=e,this.reinstantiate()},getZoomIndexArray:function(){return new Array({pixelsPerInterval:300,unit:Timeline.DateTime.HOUR},{pixelsPerInterval:200,unit:Timeline.DateTime.HOUR},{pixelsPerInterval:100,unit:Timeline.DateTime.HOUR},{pixelsPerInterval:50,unit:Timeline.DateTime.HOUR},{pixelsPerInterval:300,unit:Timeline.DateTime.DAY},{pixelsPerInterval:200,unit:Timeline.DateTime.DAY},{pixelsPerInterval:100,unit:Timeline.DateTime.DAY},{pixelsPerInterval:50,unit:Timeline.DateTime.DAY},{pixelsPerInterval:300,unit:Timeline.DateTime.WEEK},{pixelsPerInterval:200,unit:Timeline.DateTime.WEEK},{pixelsPerInterval:100,unit:Timeline.DateTime.WEEK},{pixelsPerInterval:50,unit:Timeline.DateTime.WEEK},{pixelsPerInterval:300,unit:Timeline.DateTime.MONTH},{pixelsPerInterval:200,unit:Timeline.DateTime.MONTH},{pixelsPerInterval:100,unit:Timeline.DateTime.MONTH},{pixelsPerInterval:50,unit:Timeline.DateTime.MONTH},{pixelsPerInterval:300,unit:Timeline.DateTime.YEAR},{pixelsPerInterval:200,unit:Timeline.DateTime.YEAR},{pixelsPerInterval:100,unit:Timeline.DateTime.YEAR},{pixelsPerInterval:50,unit:Timeline.DateTime.YEAR},{pixelsPerInterval:300,unit:Timeline.DateTime.DECADE},{pixelsPerInterval:200,unit:Timeline.DateTime.DECADE},{pixelsPerInterval:100,unit:Timeline.DateTime.DECADE},{pixelsPerInterval:50,unit:Timeline.DateTime.DECADE},{pixelsPerInterval:300,unit:Timeline.DateTime.CENTURY},{pixelsPerInterval:200,unit:Timeline.DateTime.CENTURY},{pixelsPerInterval:100,unit:Timeline.DateTime.CENTURY},{pixelsPerInterval:50,unit:Timeline.DateTime.CENTURY})},_incrementZoomStepUp:function(){this._currentZoomStep<this._zoomSteps.length-1&&this._currentZoomStep++},_incrementZoomStepDown:function(){this._currentZoomStep>0&&this._currentZoomStep--},reinstantiate:function(){this.timeline.dispose(),this.timeline=t,this._instantiateSimile(),this._constructZoomButtons(),this.element.disableSelection()},refresh:function(){this.timeline.layout()},getAttr:function(e){return this[e]}})}(jQuery),function(e,t){"use strict";e.widget("neatline.neatlineitems",{options:{colors:{purple:"#724E85",background:"#f9f9f9",title:"#202020"},css:{def_opacity:.7,def_font_size:13,active_font_size:18}},_create:function(){this._window=e(window),this._body=e("body"),this.listContainer=e("#items-container"),this._idToItem={},this._slugToItem={},this._idToOffset={},this._currentRecord=null,this._currentRecordId=null,this._idOrdering=[],this._db=TAFFY(),this._getItems(),this._addResizeListener()},loadData:function(){this._getItems()},_getItems:function(){var t=this;e.ajax({url:Neatline.dataSources.undated,dataType:"json",success:function(e){t._renderItems(e),t._trigger("newitems"),t._setStartingVisibility()}})},_addResizeListener:function(){var e=this;this._window.bind("resize",function(){e._getItemOffsets()})},_renderItems:function(t){this._db=TAFFY(),this.listContainer.empty(),_.each(t,_.bind(function(t){var n=e('<li class="item-title" />'),r=e('<li class="item-description" />');n.html(t.title),n.attr("recordid",t.id),r.html(t.description),this.listContainer.append(n,r),n.data("expanded",!1),this._idOrdering.push(t.id);var i={recordid:t.id,slug:t.slug,title:n,description:r,start_visible_date:t.start_visible_date,end_visible_date:t.end_visible_date};this._db.insert(i),n.bind({mousedown:_.bind(function(){n.data("expanded")?this.contractDescription(i):(this.scrollToItem(t.id),this._trigger("itemclick",{},{recordid:t.id,slug:t.slug,scrollItems:!0}))},this),mouseenter:_.bind(function(){this._trigger("itementer",{},{recordid:t.id,slug:t.slug})},this),mouseleave:_.bind(function(){this._trigger("itemleave",{},{recordid:t.id,slug:t.slug})},this)})},this)),this._getItemOffsets()},scrollRight:function(){var e=this.getNewScrollId("right"),t=this._db({recordid:e}).first();this._trigger("itemclick",{},{recordid:e,slug:t.slug,scrollItems:!0})},scrollLeft:function(){var e=this.getNewScrollId("left"),t=this._db({recordid:e}).first();this._trigger("itemclick",{},{recordid:e,slug:t.slug,scrollItems:!0})},getNewScrollId:function(e){switch(e){case"left":if(_.isNull(this._currentRecordId))return this._idOrdering[this._idOrdering.length-1];var t=this._idOrdering.indexOf(this._currentRecordId);return t===0?this._idOrdering[this._idOrdering.length-1]:this._idOrdering[t-1];case"right":if(_.isNull(this._currentRecordId))return this._idOrdering[0];var t=this._idOrdering.indexOf(this._currentRecordId);return t===this._idOrdering.length-1?this._idOrdering[0]:this._idOrdering[t+1]}},_getItemOffsets:function(){var t=this;this.items=this.listContainer.find(".item-title"),this._idToOffset={},e.each(this.items,function(n,r){var r=e(r),i=r.attr("recordid");t._idToOffset[i]=r.position().top})},expandDescription:function(e){this.__activateTitle(e);if(e.description.html()!==""){e.description.css("display","list-item");var t=e.description[0].scrollHeight;e.description.animate({height:t},200)}this._currentRecord=e,this._currentRecordId=e.recordid,e.title.data("expanded",!0)},contractDescription:function(e){this.__deactivateTitle(e),e.description.animate({height:0},200,function(){e.description.css("display","none")}),this._currentRecord=null,this._currentRecordId=null,e.title.data("expanded",!1)},renderVisibility:function(e){var t=moment(e);this._db().each(_.bind(function(e){var n=moment(e.start_visible_date),r=moment(e.end_visible_date);if(!_.isNull(n)&&!_.isNull(r)){var i=t>n&&t<r;this._displayRecord(e,i)}else if(!_.isNull(n)&&_.isNull(r)){var i=t>n;this._displayRecord(e,i)}else if(_.isNull(n)&&!_.isNull(r)){var i=t<r;this._displayRecord(e,i)}},this))},_setStartingVisibility:function(){Neatline.record.focus_date?this.renderVisibility(Neatline.record.focus_date):this.renderVisibility(Date.now())},scrollToItem:function(e){var t=this._db({recordid:parseInt(e,10)}).first();this._showRecord(t)},scrollToItemBySlug:function(e){var t=this._db({slug:e}).first();this._showRecord(t)},_displayRecord:function(e,t){t?(e.title.css("display","list-item"),e.title.data("expanded")&&e.description.html()!==""&&e.description.css("display","list-item")):(e.title.css("display","none"),e.description.css("display","none"))},_showRecord:function(e){if(e){this._currentRecordId!==null&&this._currentRecordId!==e.recordid&&(this.__hideCurrentDescription(),this._currentRecord.title.data("expanded",!1));var t=e.title.position().top+this.element.scrollTop();t>this.element[0].scrollHeight&&(t=this.element[0].scrollHeight),this.element.animate({scrollTop:t+1},200),this.expandDescription(e)}},__activateTitle:function(e){e.title.data("expanded")||(e.title.addClass("selected"),this._trigger("itemactivate",{},{recordid:e.recordid,slug:e.slug,scrollItems:!0}))},__deactivateTitle:function(e){e.title.data("expanded")&&(e.title.removeClass("selected"),this._trigger("itemdeactivate",{},{recordid:e.recordid,slug:e.slug,scrollItems:!0}))},__hideCurrentDescription:function(){_.isNull(this._currentRecord)||(this.__deactivateTitle(this._currentRecord),this._currentRecord.description.css({height:0,display:"none"}))},getAttr:function(e){return this[e]},setAttr:function(e,t){return this[e]=t}})}(jQuery),function(e,t){"use strict";e.widget("neatline.positioner",{options:{draggable:!0,mapFullscreen:!0,colors:{drag_active:"#1e1e1e"},markup:{map:"#map",timeline:"#timeline",items:"#items"},constants:{h_percent:24,v_percent:84,drag_width:5},positions:{is_map:!1,is_timeline:!1,is_items:!1,top:"map",items_v_pos:"bottom",items_h_pos:"right",items_height:"full"}},_create:function(){this._window=e(window),this.map=e(this.options.markup.map),this.timeline=e(this.options.markup.timeline),this.items=e(this.options.markup.items),this._is_map=this.options.positions.is_map,this._is_timeline=this.options.positions.is_timeline,this._is_items=this.options.positions.is_items,this._top=this.options.positions.top,this._items_v_pos=this.options.positions.items_v_pos,this._items_h_pos=this.options.positions.items_h_pos,this._items_height=this.options.positions.items_height,this.v_drag=null,this.h_drag=null,this.positions={map:{height:null,width:null,top:null,left:null},timeline:{height:null,width:null,top:null,left:null},items:{height:null,width:null,top:null,left:null}},this.options.draggable&&this._constructDraggers(),this.measure()},measure:function(){this.width=this.element.width(),this.height=this.element.height(),this.minorWidth=this.width*(this.options.constants.h_percent/100),this.majorWidth=this.width-this.minorWidth,this.majorHeight=this.height*(this.options.constants.v_percent/100),this.minorHeight=this.height-this.majorHeight},compute:function(e,t,n,r,i,s,o){return this._is_map=e,this._is_timeline=t,this._is_items=n,this._top=r,this._items_v_pos=i,this._items_h_pos=s,this._items_height=o,this._is_map&&this._is_timeline&&this._is_items?this._top==="map"?(this._items_h_pos==="left"&&this._items_v_pos==="bottom"&&this._items_height==="partial"&&(this.positions={map:{height:this.majorHeight,width:this.width,top:0,left:0},timeline:{height:this.minorHeight,width:this.majorWidth,top:this.majorHeight,left:this.minorWidth},items:{height:this.minorHeight,width:this.minorWidth,top:this.majorHeight,left:0}},this.dragPositions={h:{height:this.minorHeight,width:this.options.constants.drag_width,top:this.majorHeight,left:this.minorWidth},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}),this._items_h_pos==="left"&&this._items_v_pos==="top"&&this._items_height==="partial"?(this.positions={map:{height:this.majorHeight,width:this.majorWidth,top:0,left:this.minorWidth},timeline:{height:this.minorHeight,width:this.width,top:this.majorHeight,left:0},items:{height:this.majorHeight,width:this.minorWidth,top:0,left:0}},this.dragPositions={h:{height:this.majorHeight,width:this.options.constants.drag_width,top:0,left:this.minorWidth},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}):this._items_h_pos==="left"&&this._items_height==="full"&&(this.positions={map:{height:this.majorHeight,width:this.majorWidth,top:0,left:this.minorWidth},timeline:{height:this.minorHeight,width:this.majorWidth,top:this.majorHeight,left:this.minorWidth},items:{height:this.height,width:this.minorWidth,top:0,left:0}},this.dragPositions={h:{height:this.height,width:this.options.constants.drag_width,top:0,left:this.minorWidth},v:{height:this.options.constants.drag_width,width:this.majorWidth,top:this.majorHeight,left:this.minorWidth}}),this._items_h_pos==="right"&&this._items_v_pos==="bottom"&&this._items_height==="partial"&&(this.positions={map:{height:this.majorHeight,width:this.width,top:0,left:0},timeline:{height:this.minorHeight,width:this.majorWidth,top:this.majorHeight,left:0},items:{height:this.minorHeight,width:this.minorWidth,top:this.majorHeight,left:this.majorWidth}},this.dragPositions={h:{height:this.minorHeight,width:this.options.constants.drag_width,top:this.majorHeight,left:this.majorWidth},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}),this._items_h_pos==="right"&&this._items_v_pos==="top"&&this._items_height==="partial"?(this.positions={map:{height:this.majorHeight,width:this.majorWidth,top:0,left:0},timeline:{height:this.minorHeight,width:this.width,top:this.majorHeight,left:0},items:{height:this.majorHeight,width:this.minorWidth,top:0,left:this.majorWidth}},this.dragPositions={h:{height:this.majorHeight,width:this.options.constants.drag_width,top:0,left:this.majorWidth},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}):this._items_h_pos==="right"&&this._items_height==="full"&&(this.positions={map:{height:this.majorHeight,width:this.majorWidth,top:0,left:0},timeline:{height:this.minorHeight,width:this.majorWidth,top:this.majorHeight,left:0},items:{height:this.height,width:this.minorWidth,top:0,left:this.majorWidth}},this.dragPositions={h:{height:this.height,width:this.options.constants.drag_width,top:0,left:this.majorWidth},v:{height:this.options.constants.drag_width,width:this.majorWidth,top:this.majorHeight,left:0}})):this._top==="timeline"&&(this._items_h_pos==="left"&&this._items_v_pos==="bottom"&&this._items_height==="partial"&&(this.positions={map:{height:this.minorHeight,width:this.majorWidth,top:this.majorHeight,left:this.minorWidth},timeline:{height:this.majorHeight,width:this.width,top:0,left:0},items:{height:this.minorHeight,width:this.minorWidth,top:this.majorHeight,left:0}},this.dragPositions={h:{height:this.minorHeight,width:this.options.constants.drag_width,top:this.majorHeight,left:this.minorWidth},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}),this._items_h_pos==="left"&&this._items_v_pos==="top"&&this._items_height==="partial"?(this.positions={map:{height:this.minorHeight,width:this.width,top:this.majorHeight,left:0},timeline:{height:this.majorHeight,width:this.majorWidth,top:0,left:this.minorWidth},items:{height:this.majorHeight,width:this.minorWidth,top:0,left:0}},this.dragPositions={h:{height:this.majorHeight,width:this.options.constants.drag_width,top:0,left:this.minorWidth},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}):this._items_h_pos==="left"&&this._items_height==="full"&&(this.positions={map:{height:this.minorHeight,width:this.majorWidth,top:this.majorHeight,left:this.minorWidth},timeline:{height:this.majorHeight,width:this.majorWidth,top:0,left:this.minorWidth},items:{height:this.height,width:this.minorWidth,top:0,left:0}},this.dragPositions={h:{height:this.height,width:this.options.constants.drag_width,top:0,left:this.minorWidth},v:{height:this.options.constants.drag_width,width:this.majorWidth,top:this.majorHeight,left:this.minorWidth}}),this._items_h_pos==="right"&&this._items_v_pos==="bottom"&&this._items_height==="partial"&&(this.positions={map:{height:this.minorHeight,width:this.majorWidth,top:this.majorHeight,left:0},timeline:{height:this.majorHeight,width:this.width,top:0,left:0},items:{height:this.minorHeight,width:this.minorWidth,top:this.majorHeight,left:this.majorWidth}},this.dragPositions={h:{height:this.minorHeight,width:this.options.constants.drag_width,top:this.majorHeight,left:this.majorWidth},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}),this._items_h_pos==="right"&&this._items_v_pos==="top"&&this._items_height==="partial"?(this.positions={map:{height:this.minorHeight,width:this.width,top:this.majorHeight,left:0},timeline:{height:this.majorHeight,width:this.majorWidth,top:0,left:0},items:{height:this.majorHeight,width:this.minorWidth,top:0,left:this.majorWidth}},this.dragPositions={h:{height:this.majorHeight,width:this.options.constants.drag_width,top:0,left:this.majorWidth},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}):this._items_h_pos==="right"&&this._items_height==="full"&&(this.positions={map:{height:this.minorHeight,width:this.majorWidth,top:this.majorHeight,left:0},timeline:{height:this.majorHeight,width:this.majorWidth,top:0,left:0},items:{height:this.height,width:this.minorWidth,top:0,left:this.majorWidth}},this.dragPositions={h:{height:this.height,width:this.options.constants.drag_width,top:0,left:this.majorWidth},v:{height:this.options.constants.drag_width,width:this.majorWidth,top:this.majorHeight,left:0}})):this._is_map&&this._is_items&&!this._is_timeline?this._items_h_pos==="right"?(this.positions={map:{height:this.height,width:this.majorWidth,top:0,left:0},timeline:{height:null,width:null,top:null,left:null},items:{height:this.height,width:this.minorWidth,top:0,left:this.majorWidth}},this.dragPositions={h:{height:this.height,width:this.options.constants.drag_width,top:0,left:this.majorWidth},v:{height:null,width:null,top:null,left:null}}):this._items_h_pos==="left"&&(this.positions={map:{height:this.height,width:this.majorWidth,top:0,left:this.minorWidth},timeline:{height:null,width:null,top:null,left:null},items:{height:this.height,width:this.minorWidth,top:0,left:0}},this.dragPositions={h:{height:this.height,width:this.options.constants.drag_width,top:0,left:this.majorWidth},v:{height:null,width:null,top:null,left:null}}):this._is_timeline&&this._is_items&&!this._is_map?this._items_h_pos==="right"?(this.positions={map:{height:null,width:null,top:null,left:null},timeline:{height:this.height,width:this.majorWidth,top:0,left:0},items:{height:this.height,width:this.minorWidth,top:0,left:this.majorWidth}},this.dragPositions={h:{height:this.height,width:this.options.constants.drag_width,top:0,left:this.majorWidth},v:{height:null,width:null,top:null,left:null}}):this._items_h_pos==="left"&&(this.positions={map:{height:null,width:null,top:null,left:null},timeline:{height:this.height,width:this.majorWidth,top:0,left:this.minorWidth},items:{height:this.height,width:this.minorWidth,top:0,left:0}},this.dragPositions={h:{height:this.height,width:this.options.constants.drag_width,top:0,left:this.majorWidth},v:{height:null,width:null,top:null,left:null}}):this._is_map&&this._is_timeline&&!this._is_items?this._top==="map"?(this.positions={map:{height:this.majorHeight,width:this.width,top:0,left:0},timeline:{height:this.minorHeight,width:this.width,top:this.majorHeight,left:0},items:{height:null,width:null,top:null,left:null}},this.dragPositions={h:{height:null,width:null,top:null,left:null},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}):this._top==="timeline"&&(this.positions={map:{height:this.minorHeight,width:this.width,top:this.majorHeight,left:0},timeline:{height:this.majorHeight,width:this.width,top:0,left:0},items:{height:null,width:null,top:null,left:null}},this.dragPositions={h:{height:null,width:null,top:null,left:null},v:{height:this.options.constants.drag_width,width:this.width,top:this.majorHeight,left:0}}):this._is_map&&!this._is_timeline&&!this._is_items?(this.positions={map:{height:this.height,width:this.width,top:0,left:0},timeline:{height:null,width:null,top:null,left:null},items:{height:null,width:null,top:null,left:null}},this.dragPositions={h:{height:null,width:null,top:null,left:null},v:{height:null,width:null,top:null,left:null}}):this._is_timeline&&!this._is_map&&!this._is_items&&(this.positions={map:{height:null,width:null,top:null,left:null},timeline:{height:this.height,width:this.width,top:0,left:0},items:{height:null,width:null,top:null,left:null}},this.dragPositions={h:{height:null,width:null,top:null,left:null},v:{height:null,width:null,top:null,left:null}}),this.options.draggable&&this._showDraggers(),this.positions},apply:function(){this._is_map?(this.map.css("display","block"),this.options.mapFullscreen?this.map.css({height:this.height,width:this.width,top:0,left:0}):this.map.css(this.positions.map)):this.map.css("display","none"),this._is_timeline?(this.timeline.css("display","block"),this.timeline.css(this.positions.timeline)):this.timeline.css("display","none"),this._is_items?(this.items.css("display","block"),this.items.css(this.positions.items)):this.items.css("display","none")},_constructDraggers:function(){var t=this;this.v_drag=e('<div class="v-drag">                              </div>'),this.h_drag=e('<div class="h-drag">                              </div>'),this.element.append(this.v_drag,this.h_drag),this.h_drag.bind({mousedown:function(e){var n=e.pageX,r=t.dragPositions.h.left;t.__highlightHorizontalHandle(),t.__disableSelection(),t._window.bind({mousemove:function(e){var i=r-(n-e.pageX),s=t.width-t.options.constants.drag_width;i<0?i=0:i>s&&(i=s),t.h_drag.css("left",i);switch(t._items_h_pos){case"left":t.options.constants.h_percent=i/t.width*100;break;case"right":t.options.constants.h_percent=(t.width-i)/t.width*100}t._trigger("drag",{},{h_percent:t.options.constants.h_percent,v_percent:t.options.constants.v_percent}),t.refresh()},mouseup:function(){t.refresh(),t.__unhighlightHorizontalHandle(),t.__enableSelection(),t._window.unbind("mousemove"),t._trigger("layoutChange")}})}}),this.v_drag.bind({mousedown:function(e){var n=e.pageY,r=t.dragPositions.v.top;t.__highlightVerticalHandle(),t.__disableSelection(),t._window.bind({mousemove:function(e){var i=r-(n-e.pageY),s=t.height-t.options.constants.drag_width;i<0?i=0:i>s&&(i=s),t.v_drag.css("top",i),t.options.constants.v_percent=i/t.height*100,t._trigger("drag",{},{h_percent:t.options.constants.h_percent,v_percent:t.options.constants.v_percent}),t.refresh()},mouseup:function(){t.refresh(),t.__unhighlightVerticalHandle(),t.__enableSelection(),t._window.unbind("mousemove"),t._window.unbind("mouseup"),t._trigger("layoutChange")}})}})},_showDraggers:function(){this._is_map&&this._is_timeline?this.v_drag.css("display","block"):this.v_drag.css("display","none"),this._is_items?this.h_drag.css("display","block"):this.h_drag.css("display","none"),this.h_drag.css(this.dragPositions.h),this.v_drag.css(this.dragPositions.v)},applyProportions:function(e,t){this.options.constants.h_percent=e,this.options.constants.v_percent=t,this.refresh()},refresh:function(){this.measure(),this.compute(this._is_map,this._is_timeline,this._is_items,this._top,this._items_v_pos,this._items_h_pos,this._items_height),this.apply()},__highlightHorizontalHandle:function(){this.h_drag.css("border-left","1px dashed "+this.options.colors.drag_active)},__unhighlightHorizontalHandle:function(){this.h_drag.css("border-left","")},__highlightVerticalHandle:function(){this.v_drag.css("border-top","1px dashed "+this.options.colors.drag_active)},__unhighlightVerticalHandle:function(){this.v_drag.css("border-top","")},__disableSelection:function(){this.element.css({"-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none"})},__enableSelection:function(){this.element.css({"-moz-user-select":"","-khtml-user-select":"","-webkit-user-select":"","user-select":""})},getAttr:function(e){return this[e]}})}(jQuery),function(e,t){"use strict";e.widget("neatline.bubbles",{_create:function(){this._body=e("body"),this._window=e(window),this.template=_.template(e("#bubble-template").html()),this.bubble=null,this.title=null,this.body=null,this.background=null,this.opacity=null,this.frozen=!1,this.connector=!1,this.onBubble=!1,this._window.bind("mouseleave",_.bind(function(){this.hide()},this))},show:function(t,n){if(this.frozen)return;if(t==""&&n=="")return;this.title=t,this.body=n,_.isNull(this.bubble)||this.bubble.remove(),this.bubble=e(this.template({title:t,body:n})),this.freezeLink=this.bubble.find("a.freeze-bubble"),this.closeLink=this.bubble.find("a.close-bubble"),this.moreInfoDiv=this.bubble.find("div.click-for-info"),this.titleDiv=this.bubble.find("div.title"),this.bodyDiv=this.bubble.find("div.body"),this.body===""&&(this.moreInfoDiv.hide(),this.bubble.addClass("no-body")),this._measureBubble(),this.element.append(this.bubble),this.background=this.bubble.css("background-color"),this.opacity=this.bubble.css("opacity"),this._window.bind({"mousemove.bubbles":_.bind(function(e){this.position(e)},this)})},close:function(){this._trigger("close"),this.frozen=!1,this.hide()},hide:function(){if(this.frozen||_.isNull(this.bubble))return;this.bubble.remove(),this.connector.remove(),this.bubble=null,this._window.unbind("mousemove.bubbles mousedown.bubbles")},freeze:function(){if(_.isNull(this.bubble))return;this.frozen=!0,this._window.unbind("mousemove.bubbles"),this.bubble.addClass("frozen"),this.opacity=this.bubble.css("opacity"),this._measureBubble(),this.position(this.event),this.bubble.bind({mouseenter:_.bind(function(){this.onBubble=!0},this),mouseleave:_.bind(function(){this.onBubble=!1},this)}),this._window.bind("mousedown.bubbles",_.bind(function(){this.onBubble||this.close()},this)),this.closeLink.mousedown(_.bind(function(){this.close()},this))},position:function(e){this.event=e;var t=this.element.outerWidth(),n=this.element.outerHeight(),r=this.element.offset(),i=parseInt(this.element.css("border-top-width"),10),s=parseInt(this.element.css("border-left-width"),10);r.top+=i,r.left+=s;var o=e.clientX-r.left,u=e.clientY-r.top+this._window.scrollTop();if(e.clientX<r.left||e.clientX>r.left+t||e.clientY<r.top||e.clientY>r.top+n){this._trigger("cursorleave"),this.hide();return}var a=u-this.bubbleHeight/3,f=o+100;f+this.bubbleWidth>t&&(f=o-this.bubbleWidth-100),a<0&&(a=0),a+this.bubbleHeight>n&&(a=n-this.bubbleHeight),this.bubbleHeight>n&&(a=0,this.bubbleHeight=n,this.bubble.css("overflow-y","scroll"),this.bubble.outerHeight(this.bubbleHeight)),this.bubble.css({left:f,top:a}),this.connector&&this.connector.remove();if(f>o){var l=e.clientX+20,c=r.top+a,h=f-o-20;this.connector=Raphael(l,c,h,this.bubbleHeight);var p=u-a,d=this.bubbleHeight*.2,v=this.bubbleHeight*.6;this.triangle=this.connector.path("M1,"+p+"L99,"+d+" 99,"+v+"Z")}else{var l=f+this.bubbleWidth+r.left,c=r.top+a,h=o-(f+this.bubbleWidth)-20;this.connector=Raphael(l,c,h,this.bubbleHeight);var p=u-a,d=this.bubbleHeight*.2,v=this.bubbleHeight*.6;this.triangle=this.connector.path("M0,"+d+"L"+h+","+p+" 0,"+v+"Z")}this.triangle.attr({fill:this.background,stroke:this.background,opacity:this.opacity})},_measureBubble:function(){var e=this.bubble.clone().css({top:-1e3,left:-1e3}).appendTo(this._body);this.bubbleHeight=e.outerHeight(),this.bubbleWidth=e.outerWidth(),e.remove()},getTitle:function(){return this.title},isFrozen:function(){return this.frozen}})}(jQuery),function(e,t){"use strict";e.widget("neatline.spanstyler",{_create:function(){this.leftPercent=null,this.rightPercent=null,this.baseStyle=this.element.attr("style")},constructCss:function(e,t,n){!_.isUndefined(t)&&!_.isUndefined(n)?(this.leftPercent=t,this.rightPercent=n):!_.isNull(this.leftPercent)&&!_.isNull(this.rightPercent)?(t=this.leftPercent,n=this.rightPercent):(t=0,n=99);var r=this.__hexToRgb(e),i=this.__rgbObjectToCssValue(r,1),s=this.__rgbObjectToCssValue(r,0),e=e[0]==="#"?e:"#"+e;this.css="background: "+e+"; "+"background: -moz-linear-gradient(left, "+s+" 0%, "+i+" "+t+"%, "+i+" "+n+"%, "+s+" 99%); "+"background: -webkit-gradient(linear, left top, right top, "+"color-stop(0%,"+s+"), "+"color-stop("+t+"%,"+i+"), "+"color-stop("+n+"%,"+i+"), "+"color-stop(99%,"+s+")); "+"background: -webkit-linear-gradient(left, "+s+" 0%, "+i+" "+t+"%, "+i+" "+n+"%, "+s+" 99%); "+"background: -o-linear-gradient(left, "+s+" 0%, "+i+" "+t+"%, "+i+" "+n+"%, "+s+" 99%); "+"background: -ms-linear-gradient(left, "+s+" 0%, "+i+" "+t+"%, "+i+" "+n+"%, "+s+" 99%); "+"background: linear-gradient(left, "+s+" 0%, "+i+" "+t+"%, "+i+" "+n+"%, "+s+" 99%); "},applyCss:function(){var e=typeof this.baseStyle=="undefined"?"":this.baseStyle;this.element.attr("style",e+this.css)},__hexToRgb:function(e){e[0]==="#"&&(e=e.slice(1));var t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return{red:t,green:n,blue:r}},__rgbObjectToCssValue:function(e,t){return"rgba("+e.red+", "+e.green+", "+e.blue+", "+t+")"},getAttr:function(e){return this[e]}})}(jQuery),Array.prototype.remove=function(e){for(var t=0;t<this.length;t++)if(this[t]===e){this.splice(t,1),this.remove(e);break}},Array.prototype.contains=function(e){var t=!1;for(var n=0;n<this.length;n++)this[n]===e&&(t=!0);return t},Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1},function(e){var t=0;e.getScrollbarWidth=function(){if(!t)if(e.browser.msie){var n=e('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body"),r=e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body");t=n.width()-r.width(),n.add(r).remove()}else{var i=e("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:-1e3}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});t=100-i.width(),i.parent().remove()}return t}}(jQuery),function(e){function s(e,t,i){var s=o(e);for(var u=0;u<t.length;u++){var a=[e,t[u]].join("-");r[a]=n(a,i||s.type,s.minZoom,s.maxZoom)}}function o(e){if(e in r)return r[e];throw"No such provider ("+e+")"}var t=" a. b. c. d.".split(" "),n=function(e,n,r,i){return{url:["http://{S}tile.stamen.com/",e,"/{Z}/{X}/{Y}.",n].join(""),type:n,subdomains:t.slice(),minZoom:r,maxZoom:i}},r={toner:n("toner","png",0,20),terrain:n("terrain","jpg",4,18),watercolor:n("watercolor","jpg",3,16)},i=['Map tiles by <a href="http://stamen.com">Stamen Design</a>, ','under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. ','Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, ','under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.'].join("");s("toner",["hybrid","labels","lines","background","lite"]),s("toner",["2010"]),s("toner",["2011","2011-lines","2011-labels","2011-lite"]),s("terrain",["background"]),s("terrain",["labels","lines"],"png"),e.stamen=e.stamen||{},e.stamen.tile=e.stamen.tile||{},e.stamen.tile.providers=r,e.stamen.tile.getProvider=o;if(typeof MM=="object"){var u=typeof MM.Template=="function"?MM.Template:MM.TemplatedMapProvider;MM.StamenTileLayer=function(e){var n=o(e);MM.Layer.call(this,new u(n.url,t)),this.provider.setZoomRange(n.minZoom,n.maxZoom),this.attribution=i},MM.extend(MM.StamenTileLayer,MM.Layer)}typeof L=="object"&&(L.StamenTileLayer=L.TileLayer.extend({initialize:function(e){var n=o(e),r=n.url.replace(/({[A-Z]})/g,function(e){return e.toLowerCase()});L.TileLayer.prototype.initialize.call(this,r,{minZoom:n.minZoom,maxZoom:n.maxZoom,subdomains:t,scheme:"xyz",attribution:i})}}));if(typeof OpenLayers=="object"){function a(e){return e.replace(/({.})/g,function(e){return"$"+e.toLowerCase()})}OpenLayers.Layer.Stamen=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(e,n){var r=o(n.provider||e),i=r.url,s=[];if(i.indexOf("{S}")>-1)for(var u=0;u<t.length;u++)s.push(a(i.replace("{S}",t[u])));else s.push(a(i));return n=OpenLayers.Util.extend({numZoomLevels:r.maxZoom,buffer:0,transitionEffect:"resize",crossOriginKeyword:"anonymous"},n),OpenLayers.Layer.OSM.prototype.initialize.call(this,e,s,n)}})}typeof google=="object"&&typeof google.maps=="object"&&(google.maps.StamenMapType=function(e){var n=o(e);return google.maps.ImageMapType.call(this,{getTileUrl:function(e,r){var i=(r+e.x+e.y)%t.length;return[n.url.replace("{S}",t[i]).replace("{Z}",r).replace("{X}",e.x).replace("{Y}",e.y)]},tileSize:new google.maps.Size(256,256),name:e,minZoom:n.minZoom,maxZoom:n.maxZoom})},google.maps.StamenMapType.prototype=new google.maps.ImageMapType("_"))}(typeof exports=="undefined"?this:exports),function(){var e=!1;if(document.location.search.length>0){var t=document.location.search.substr(1).split("&");for(var n=0;n<t.length;n++)t[n]=="timeline-use-local-resources"&&(e=!0)}var r=function(){if("Timeline"in window)return;window.Timeline=new Object,window.Timeline.DateTime=window.SimileAjax.DateTime;var e=!1,t=["timeline.js","band.js","themes.js","ethers.js","ether-painters.js","event-utils.js","labellers.js","sources.js","original-painter.js","detailed-painter.js","overview-painter.js","compact-painter.js","decorators.js","units.js"],n=["timeline.css","ethers.css","events.css"],r=["timeline.js","labellers.js"],i=[],s=["cs","de","en","es","fr","it","nl","ru","se","tr","vi","zh"];try{var o=["en"],u="en",a=null,f=function(t){var n=t.split("&");for(var r=0;r<n.length;r++){var i=n[r].split("=");i[0]=="locales"?o=o.concat(i[1].split(",")):i[0]=="defaultLocale"?u=i[1]:i[0]=="forceLocale"?(a=i[1],o=o.concat(i[1].split(","))):i[0]=="bundle"&&(e=i[1]!="false")}};(function(){if(typeof Timeline_urlPrefix!="string"){var e=document.documentElement.getElementsByTagName("head");for(var t=0;t<e.length;t++){var n=e[t].getElementsByTagName("script");for(var r=0;r<n.length;r++){var i=n[r].src,s=i.indexOf("timeline-api.js");if(s>=0){Timeline.urlPrefix=i.substr(0,s);var o=i.indexOf("?");o>0&&f(i.substr(o+1));return}}}throw new Error("Failed to derive URL prefix for Timeline API code files")}Timeline.urlPrefix=Timeline_urlPrefix,typeof Timeline_parameters=="string"&&f(Timeline_parameters)})();var l=function(e,t){SimileAjax.includeJavascriptFiles(document,e,t)},c=function(e,t){SimileAjax.includeCssFiles(document,e,t)};e?(l(Timeline.urlPrefix,["timeline-bundle.js"]),c(Timeline.urlPrefix,["timeline-bundle.css"])):(l(Timeline.urlPrefix+"scripts/",t),c(Timeline.urlPrefix+"styles/",n));var h=[];h[u]=!0;var p=function(e){for(var t=0;t<s.length;t++)if(e==s[t])return h[e]=!0,!0;return!1},d=function(e){if(p(e))return e;var t=e.indexOf("-");return t>0&&p(e.substr(0,t))?e.substr(0,t):null};for(var v=0;v<o.length;v++)d(o[v]);var m=u,g=("language"in navigator?navigator.language:navigator.browserLanguage).split(";");for(var v=0;v<g.length;v++){var y=d(g[v]);if(y!=null){m=y;break}}for(var v=0;v<s.length;v++){var y=s[v];h[y]&&(l(Timeline.urlPrefix+"scripts/l10n/"+y+"/",r),c(Timeline.urlPrefix+"styles/l10n/"+y+"/",i))}a==null?(Timeline.serverLocale=u,Timeline.clientLocale=m):(Timeline.serverLocale=a,Timeline.clientLocale=a)}catch(b){alert(b)}};if(typeof SimileAjax=="undefined"){window.SimileAjax_onLoad=r;var i=e?"http://127.0.0.1:9999/ajax/api/simile-ajax-api.js?bundle=false":"http://static.simile.mit.edu/ajax/api-2.2.0/simile-ajax-api.js";typeof Timeline_ajax_url=="string"&&(i=Timeline_ajax_url);var s=function(){var e=document.createElement("script");e.type="text/javascript",e.language="JavaScript",e.src=i,document.getElementsByTagName("head")[0].appendChild(e)};if(document.body==null)try{document.write("<script src='"+i+"' type='text/javascript'></script>")}catch(o){s()}else s()}else r()}();var TAFFY;(function(){if(!TAFFY){var e="2.4.1",t=1,n="000000",r=1e3,i={},s=function(e){return TAFFY.isArray(e)||TAFFY.isObject(e)?e:JSON.parse(e)},o=function(e,t,n){if(e&&(d.isArray(e)&&e.length==1||!d.isArray(e)))t(d.isArray(e)?e[0]:e,0);else for(var r,i,s=0,e=d.isArray(e)?e:[e],o=e.length;s<o;s++){var i=e[s];if(!d.isUndefined(i)||n||!1){r=t(i,s);if(r===d.EXIT)break}}},u=function(e,t){var n=0,r;for(var i in e){e.hasOwnProperty(i)&&(r=t(e[i],i,n++));if(r===d.EXIT)break}};i.extend=function(e,t){i[e]=function(){return t.apply(this,arguments)}};var a=function(e){if(d.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e))return!0;if(d.isObject(e)&&e.___id&&e.___s)return!0;if(d.isArray(e)){var t=!0;return o(e,function(e){if(!a(e))return t=!1,TAFFY.EXIT}),t}return!1},f=function(e){var t=[];d.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)&&(e={___id:e});if(d.isArray(e)){o(e,function(e){t.push(f(e))});var e=function(){var e=this,n=!1;return o(t,function(t){p(e,t)&&(n=!0)}),n};return e}if(d.isObject(e)){d.isObject(e)&&e.___id&&e.___s&&(e={___id:e.___id}),u(e,function(e,n){d.isObject(e)||(e={is:e}),u(e,function(e,r){var i=[],s=r==="hasAll"?function(e,t){t(e)}:o;s(e,function(e){var t=!0,s=!1,o=function(){var i=this[n];r.indexOf("!")===0&&(t=!1,r=r.substring(1,r.length));var o=r==="regex"?e.test(i):r==="lt"?i<e:r==="gt"?i>e:r==="lte"?i<=e:r==="gte"?i>=e:r==="left"?i.indexOf(e)===0:r==="leftnocase"?i.toLowerCase().indexOf(e.toLowerCase())===0:r==="right"?i.substring(i.length-e.length)===e:r==="rightnocase"?i.toLowerCase().substring(i.length-e.length)===e.toLowerCase():r==="like"?i.indexOf(e)>=0:r==="likenocase"?i.toLowerCase().indexOf(e.toLowerCase())>=0:r==="is"?i===e:r==="isnocase"?i.toLowerCase()===e.toLowerCase():r==="has"?d.has(i,e):r==="hasall"?d.hasAll(i,e):r.indexOf("is")===-1&&!TAFFY.isNull(i)&&!TAFFY.isUndefined(i)&&!TAFFY.isObject(e)&&!TAFFY.isArray(e)?e===i[r]:d[r]&&d.isFunction(d[r])&&r.indexOf("is")===0?d[r](i)===e:d[r]&&d.isFunction(d[r])?d[r](i,e):t===s;return o=o&&!t?!1:!o&&!t?!0:o,o};i.push(o)}),i.length===1?t.push(i[0]):t.push(function(){var e=this,t=!1;return o(i,function(n){n.apply(e)&&(t=!0)}),t})})});var e=function(){var e=this,n=!0;return n=t.length==1&&!t[0].apply(e)?!1:t.length==2&&(!t[0].apply(e)||!t[1].apply(e))?!1:t.length==3&&(!t[0].apply(e)||!t[1].apply(e)||!t[2].apply(e))?!1:t.length==4&&(!t[0].apply(e)||!t[1].apply(e)||!t[2].apply(e)||!t[3].apply(e))?!1:!0,t.length>4&&o(t,function(t){p(e,t)||(n=!1)}),n};return e}if(d.isFunction(e))return e},l=function(e,t){var n=function(e,n){var r=0;return d.each(t,function(t){var i=t.split(" "),s=i[0],o=i.length===1?"logical":i[1];if(o==="logical"){var u=c(e[s]),a=c(n[s]);d.each(u.length<=a.length?u:a,function(e,t){if(u[t]<a[t])return r=-1,TAFFY.EXIT;if(u[t]>a[t])return r=1,TAFFY.EXIT})}else if(o==="logicaldesc"){var u=c(e[s]),a=c(n[s]);d.each(u.length<=a.length?u:a,function(e,t){if(u[t]>a[t])return r=-1,TAFFY.EXIT;if(u[t]<a[t])return r=1,TAFFY.EXIT})}else{if(o==="asec"&&e[s]<n[s])return r=-1,d.EXIT;if(o==="asec"&&e[s]>n[s])return r=1,d.EXIT;if(o==="desc"&&e[s]>n[s])return r=-1,d.EXIT;if(o==="desc"&&e[s]<n[s])return r=1,d.EXIT}r===0&&o==="logical"&&u.length<a.length?r=-1:r===0&&o==="logical"&&u.length>a.length?r=1:r===0&&o==="logicaldesc"&&u.length>a.length?r=-1:r===0&&o==="logicaldesc"&&u.length<a.length&&(r=1);if(r!=0)return d.EXIT}),r};return e.sort(n)},c=null;(function(){var e={},t=0;c=function(n){return t>r&&(e={},t=0),e["_"+n]||function(){var r=String(n),i=[],s="_",o="";for(var u=0,a=r.length;u<a;u++){var f=r.charCodeAt(u);f>=48&&f<=57||f===46?(o!="n"&&(o="n",i.push(s.toLowerCase()),s=""),s+=r.charAt(u)):(o!="s"&&(o="s",i.push(parseFloat(s)),s=""),s+=r.charAt(u))}return i.push(o==="n"?parseFloat(s):s.toLowerCase()),i.shift(),e["_"+n]=i,t++,i}()}})();var h=function(){this.context({results:this.getDBI().query(this.context())})};i.extend("filter",function(){var e=TAFFY.mergeObj(this.context(),{run:null}),t=[];return o(e.q,function(e){t.push(e)}),e.q=t,o(arguments,function(t){e.q.push(f(t)),e.filterRaw.push(t)}),this.getroot(e)}),i.extend("order",function(e){var e=e.split(","),t=[];o(e,function(e){t.push(e.replace(/^\s*/,"").replace(/\s*$/,""))});var n=TAFFY.mergeObj(this.context(),{sort:null});return n.order=t,this.getroot(n)}),i.extend("limit",function(e){var t=TAFFY.mergeObj(this.context(),{});t.limit=e;if(t.run&&t.sort){var n=[];o(t.results,function(t,r){if(r+1>e)return TAFFY.EXIT;n.push(t)}),t.results=n}return this.getroot(t)}),i.extend("start",function(e){var t=TAFFY.mergeObj(this.context(),{});t.start=e;if(t.run&&t.sort&&!t.limit){var n=[];o(t.results,function(t,r){r+1>e&&n.push(t)}),t.results=n}else t=TAFFY.mergeObj(this.context(),{run:null,start:e});return this.getroot(t)}),i.extend("update",function(){var e=!0,t={},n=arguments;!TAFFY.isString(arguments[0])||arguments.length!=2&&arguments.length!=3?(t=n[0],n.length==2&&(e=n[0])):(t[arguments[0]]=arguments[1],arguments.length==3&&(e=arguments[2]));var r=this;return h.call(this),o(this.context().results,function(n){var i=t;TAFFY.isFunction(i)?i=i.apply(TAFFY.mergeObj(n,{})):d.isFunction(i)&&(i=i(TAFFY.mergeObj(n,{}))),TAFFY.isObject(i)&&r.getDBI().update(n.___id,i,e)}),this.context().results.length&&this.context({run:null}),this}),i.extend("remove",function(e){var t=this,n=0;return h.call(this),o(this.context().results,function(e){t.getDBI().remove(e.___id),n++}),this.context().results.length&&(this.context({run:null}),t.getDBI().removeCommit(e)),n}),i.extend("count",function(){return h.call(this),this.context().results.length}),i.extend("callback",function(e,t){if(e){var n=this;setTimeout(function(){h.call(n),e.call(n.getroot(n.context()))},t?t:0)}return null}),i.extend("get",function(){return h.call(this),this.context().results}),i.extend("stringify",function(){return JSON.stringify(this.get())}),i.extend("first",function(){return h.call(this),this.context().results[0]||!1}),i.extend("last",function(){return h.call(this),this.context().results[this.context().results.length-1]||!1}),i.extend("sum",function(){var e=0;h.call(this);var t=this;return o(arguments,function(n){o(t.context().results,function(t){e+=t[n]})}),e}),i.extend("min",function(e){var t=null;return h.call(this),o(this.context().results,function(n){if(t===null||n[e]<t)t=n[e]}),t}),i.extend("max",function(e){var t=null;return h.call(this),o(this.context().results,function(n){if(t===null||n[e]>t)t=n[e]}),t}),i.extend("select",function(){var e=[],t=arguments;return h.call(this),arguments.length===1?o(this.context().results,function(n){e.push(n[t[0]])}):o(this.context().results,function(n){var r=[];o(t,function(e){r.push(n[e])}),e.push(r)}),e}),i.extend("distinct",function(){var e=[],t=arguments;return h.call(this),arguments.length===1?o(this.context().results,function(n){var r=n[t[0]],i=!1;o(e,function(e){if(r===e)return i=!0,TAFFY.EXIT}),i||e.push(r)}):o(this.context().results,function(n){var r=[];o(t,function(e){r.push(n[e])});var i=!1;o(e,function(e){var n=!0;o(t,function(t,i){if(r[i]!=e[i])return n=!1,TAFFY.EXIT});if(n)return i=!0,TAFFY.EXIT}),i||e.push(r)}),e}),i.extend("supplant",function(e,t){var n=[];return h.call(this),o(this.context().results,function(t){n.push(e.replace(/{([^{}]*)}/g,function(e,n){var r=t[n];return typeof r=="string"||typeof r=="number"?r:e}))}),t?n:n.join("")}),i.extend("each",function(e){return h.call(this),o(this.context().results,e),this}),i.extend("map",function(e){var t=[];return h.call(this),o(this.context().results,function(n){t.push(e(n))}),t});var p=function(e,t){var n=!0;return o(t,function(t){switch(d.typeOf(t)){case"function":if(!t.apply(e))return n=!1,TAFFY.EXIT;break;case"array":n=t.length==1?p(e,t[0]):t.length==2?p(e,t[0])||p(e,t[1]):t.length==3?p(e,t[0])||p(e,t[1])||p(e,t[2]):t.length==4?p(e,t[0])||p(e,t[1])||p(e,t[2])||p(e,t[3]):!1,t.length>4&&o(t,function(t){p(e,t)&&(n=!0)})}}),n},d=function(e){var r=[],c={},h=1,v={template:!1,onInsert:!1,onUpdate:!1,onRemove:!1,onDBChange:!1,storageName:!1,forcePropertyCase:null,cacheSize:100},y=new Date,w=0,E=0,S={},x=function(e){if(e.length==0)return r;var t=[],n=!1;return o(e,function(e){d.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)&&r[c[e]]&&(t.push(r[c[e]]),n=!0),d.isObject(e)&&e.___id&&e.___s&&r[c[e.___id]]&&(t.push(r[c[e.___id]]),n=!0),d.isArray(e)&&o(e,function(e){o(x(e),function(e){t.push(e)})})}),n&&t.length>1&&(t=[]),t},T={dm:function(e){return e&&(y=e,S={},w=0,E=0),v.onDBChange&&setTimeout(function(){v.onDBChange.call(r)},0),v.storageName&&setTimeout(function(){localStorage.setItem("taffy_"+v.storageName,JSON.stringify(r))}),y},insert:function(e,i){var a=[],f=[],l=s(e);return o(l,function(e,s){if(d.isArray(e)&&s===0)return o(e,function(e){a.push(v.forcePropertyCase==="lower"?e.toLowerCase():v.forcePropertyCase==="upper"?e.toUpperCase():e)}),!0;if(d.isArray(e)){var l={};o(e,function(e,t){l[a[t]]=e}),e=l}else if(d.isObject(e)&&v.forcePropertyCase){var p={};u(e,function(t,n){p[v.forcePropertyCase==="lower"?n.toLowerCase():v.forcePropertyCase==="upper"?n.toUpperCase():n]=e[n]}),e=p}h++,e.___id="T"+String(n+t).slice(-6)+"R"+String(n+h).slice(-6),e.___s=!0,f.push(e.___id),v.template&&(e=d.mergeObj(v.template,e)),r.push(e),c[e.___id]=r.length-1,v.onInsert&&(i||TAFFY.isUndefined(i))&&v.onInsert.call(e),T.dm(new Date)}),N(f)},sort:function(e){return r=l(r,e.split(",")),c={},o(r,function(e,t){c[e.___id]=t}),T.dm(new Date),!0},update:function(e,t,n){var i={};v.forcePropertyCase&&(u(t,function(e,t){i[v.forcePropertyCase==="lower"?t.toLowerCase():v.forcePropertyCase==="upper"?t.toUpperCase():t]=e}),t=i);var s=r[c[e]],o=d.mergeObj(s,t),a={},f=!1;u(o,function(e,t){if(TAFFY.isUndefined(s[t])||s[t]!=e)a[t]=e,f=!0}),f&&(v.onUpdate&&(n||TAFFY.isUndefined(n))&&v.onUpdate.call(o,r[c[e]],a),r[c[e]]=o,T.dm(new Date))},remove:function(e){r[c[e]].___s=!1},removeCommit:function(e){for(var t=r.length-1;t>-1;t--)r[t].___s||(v.onRemove&&(e||TAFFY.isUndefined(e))&&v.onRemove.call(r[t]),c[r[t].___id]=undefined,r.splice(t,1));c={},o(r,function(e,t){c[e.___id]=t}),T.dm(new Date)},query:function(e){var t;if(v.cacheSize){var n="";o(e.filterRaw,function(e){if(d.isFunction(e))return n="nocache",TAFFY.EXIT}),n==""&&(n=JSON.stringify(d.mergeObj(e,{q:!1,run:!1,sort:!1})))}if(!e.results||!e.run||e.run&&T.dm()>e.run){var i=[];if(v.cacheSize&&S[n])return S[n].i=w++,S[n].results;if(e.q.length==0&&e.index.length==0)o(r,function(e){i.push(e)}),t=i;else{var s=x(e.index);o(s,function(t){(e.q.length==0||p(t,e.q))&&i.push(t)}),t=i}}else t=e.results;e.order.length>0&&(!e.run||!e.sort)&&(t=l(t,e.order));if(t.length&&(e.limit&&e.limit<t.length||e.start)){var a=[];o(t,function(t,n){if(!e.start||e.start&&n+1>=e.start)if(e.limit){var r=e.start?n+1-e.start:n;if(r<e.limit)a.push(t);else if(r>e.limit)return TAFFY.EXIT}else a.push(t)}),t=a}return v.cacheSize&&n!="nocache"&&(E++,setTimeout(function(){if(E>=v.cacheSize*2){E=0;var e=w-v.cacheSize,t={};u(function(n,r){n.i>=e&&(t[r]=n)}),S=t}},0),S[n]={i:w++,results:t}),t}},N=function(){var e=TAFFY.mergeObj(TAFFY.mergeObj(i,{insert:undefined}),{getDBI:function(){return T},getroot:function(e){return N.call(e)},context:function(e){return e&&(t=TAFFY.mergeObj(t,"results"in e?TAFFY.mergeObj(e,{run:new Date,sort:new Date}):e)),t},extend:undefined}),t=this&&this.q?this:{limit:!1,start:!1,q:[],filterRaw:[],index:[],order:[],results:!1,run:null,sort:null};return o(arguments,function(e){a(e)?t.index.push(e):t.q.push(f(e)),t.filterRaw.push(e)}),e};return t++,e&&T.insert(e),N.insert=T.insert,N.TAFFY=!0,N.sort=T.sort,N.settings=function(e){return e&&(v=TAFFY.mergeObj(v,e),e.template&&N().update(e.template)),v},N.store=function(e){var t=!1;if(localStorage){if(e){var n=localStorage.getItem("taffy_"+e);n&&n.length>0&&(N.insert(n),t=!0),r.length>0&&setTimeout(function(){localStorage.setItem("taffy_"+v.storageName,JSON.stringify(r))})}N.settings({storageName:e})}return N},N};TAFFY=d,d.each=o,d.eachin=u,d.extend=i.extend,TAFFY.EXIT="TAFFYEXIT",TAFFY.mergeObj=function(e,t){var n={};return u(e,function(t,r){n[r]=e[r]}),u(t,function(e,r){n[r]=t[r]}),n},TAFFY.has=function(e,t){var n=!0;if(e.TAFFY)return n=e(t),n.length>0?!0:!1;switch(d.typeOf(e)){case"object":if(d.isObject(t))u(t,function(r,i){if(n!==!0||!!d.isUndefined(e[i])||!e.hasOwnProperty(i))return n=!1,TAFFY.EXIT;n=d.has(e[i],t[i])});else if(d.isArray(t))o(t,function(r,i){n=d.has(e,t[i]);if(n)return TAFFY.EXIT});else if(d.isString(t))return TAFFY.isUndefined(e[t])?!1:!0;return n;case"array":if(d.isObject(t))o(e,function(r,i){n=d.has(e[i],t);if(n===!0)return TAFFY.EXIT});else if(d.isArray(t))o(t,function(r,i){o(e,function(r,s){n=d.has(e[s],t[i]);if(n===!0)return TAFFY.EXIT});if(n===!0)return TAFFY.EXIT});else if(d.isString(t)||d.isNumber(t))for(var r=0;r<e.length;r++){n=d.has(e[r],t);if(n)return!0}return n;case"string":if(d.isString(t)&&t===e)return!0;break;default:if(d.typeOf(e)===d.typeOf(t)&&e===t)return!0}return!1},TAFFY.hasAll=function(e,t){var n=TAFFY;if(n.isArray(t)){var r=!0;return o(t,function(t){r=n.has(e,t);if(r===!1)return TAFFY.EXIT}),r}return n.has(e,t)},TAFFY.typeOf=function(e){var t=typeof e;return t==="object"&&(e?typeof e.length=="number"&&!e.propertyIsEnumerable("length")&&(t="array"):t="null"),t},TAFFY.getObjectKeys=function(e){var t=[];return u(e,function(e,n){t.push(n)}),t.sort(),t},TAFFY.isSameArray=function(e,t){return TAFFY.isArray(e)&&TAFFY.isArray(t)&&e.join(",")===t.join(",")?!0:!1},TAFFY.isSameObject=function(e,t){var n=TAFFY,r=!0;return n.isObject(e)&&n.isObject(t)?n.isSameArray(n.getObjectKeys(e),n.getObjectKeys(t))?u(e,function(i,s){if(!(n.isObject(e[s])&&n.isObject(t[s])&&n.isSameObject(e[s],t[s])||n.isArray(e[s])&&n.isArray(t[s])&&n.isSameArray(e[s],t[s])||e[s]===t[s]))return r=!1,TAFFY.EXIT}):r=!1:r=!1,r},function(e){for(var t=0;t<e.length;t++)(function(e){TAFFY["is"+e]=function(t){return TAFFY.typeOf(t)===e.toLowerCase()?!0:!1}})(e[t])}(["String","Number","Object","Array","Boolean","Null","Function","Undefined"])}})(),typeof exports=="object"&&(exports.taffy=TAFFY);var JSON;JSON||(JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)r=rep[n],typeof r=="string"&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){function e(t,n,r){if(t===n)return t!==0||1/t==1/n;if(t==null||n==null)return t===n;t._chain&&(t=t._wrapped),n._chain&&(n=n._wrapped);if(t.isEqual&&E.isFunction(t.isEqual))return t.isEqual(n);if(n.isEqual&&E.isFunction(n.isEqual))return n.isEqual(t);var i=a.call(t);if(i!=a.call(n))return!1;switch(i){case"[object String]":return t==String(n);case"[object Number]":return t!=+t?n!=+n:t==0?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if(typeof t!="object"||typeof n!="object")return!1;for(var s=r.length;s--;)if(r[s]==t)return!0;r.push(t);var s=0,o=!0;if(i=="[object Array]"){if(s=t.length,o=s==n.length)for(;s--;)if(!(o=s in t==s in n&&e(t[s],n[s],r)))break}else{if("constructor"in t!="constructor"in n||t.constructor!=n.constructor)return!1;for(var u in t)if(E.has(t,u)&&(s++,!(o=E.has(n,u)&&e(t[u],n[u],r))))break;if(o){for(u in n)if(E.has(n,u)&&!(s--))break;o=!s}}return r.pop(),o}var t=this,n=t._,r={},i=Array.prototype,s=Object.prototype,o=i.slice,u=i.unshift,a=s.toString,f=s.hasOwnProperty,l=i.forEach,c=i.map,h=i.reduce,p=i.reduceRight,d=i.filter,v=i.every,m=i.some,g=i.indexOf,y=i.lastIndexOf,s=Array.isArray,b=Object.keys,w=Function.prototype.bind,E=function(e){return new L(e)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=E),exports._=E):t._=E,E.VERSION="1.3.1";var S=E.each=E.forEach=function(e,t,n){if(e!=null)if(l&&e.forEach===l)e.forEach(t,n);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(i in e&&t.call(n,e[i],i,e)===r)break}else for(i in e)if(E.has(e,i)&&t.call(n,e[i],i,e)===r)break};E.map=E.collect=function(e,t,n){var r=[];return e==null?r:c&&e.map===c?e.map(t,n):(S(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),e.length===+e.length&&(r.length=e.length),r)},E.reduce=E.foldl=E.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(h&&e.reduce===h)return r&&(t=E.bind(t,r)),i?e.reduce(t,n):e.reduce(t);S(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},E.reduceRight=E.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduceRight===p)return r&&(t=E.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=E.toArray(e).reverse();return r&&!i&&(t=E.bind(t,r)),i?E.reduce(s,t,n,r):E.reduce(s,t)},E.find=E.detect=function(e,t,n){var r;return x(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},E.filter=E.select=function(e,t,n){var r=[];return e==null?r:d&&e.filter===d?e.filter(t,n):(S(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},E.reject=function(e,t,n){var r=[];return e==null?r:(S(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},E.every=E.all=function(e,t,n){var i=!0;return e==null?i:v&&e.every===v?e.every(t,n):(S(e,function(e,s,o){if(!(i=i&&t.call(n,e,s,o)))return r}),i)};var x=E.some=E.any=function(e,t,n){t||(t=E.identity);var i=!1;return e==null?i:m&&e.some===m?e.some(t,n):(S(e,function(e,s,o){if(i||(i=t.call(n,e,s,o)))return r}),!!i)};E.include=E.contains=function(e,t){var n=!1;return e==null?n:g&&e.indexOf===g?e.indexOf(t)!=-1:n=x(e,function(e){return e===t})},E.invoke=function(e,t){var n=o.call(arguments,2);return E.map(e,function(e){return(E.isFunction(t)?t||e:e[t]).apply(e,n)})},E.pluck=function(e,t){return E.map(e,function(e){return e[t]})},E.max=function(e,t,n){if(!t&&E.isArray(e))return Math.max.apply(Math,e);if(!t&&E.isEmpty(e))return-Infinity;var r={computed:-Infinity};return S(e,function(e,i,s){i=t?t.call(n,e,i,s):e,i>=r.computed&&(r={value:e,computed:i})}),r.value},E.min=function(e,t,n){if(!t&&E.isArray(e))return Math.min.apply(Math,e);if(!t&&E.isEmpty(e))return Infinity;var r={computed:Infinity};return S(e,function(e,i,s){i=t?t.call(n,e,i,s):e,i<r.computed&&(r={value:e,computed:i})}),r.value},E.shuffle=function(e){var t=[],n;return S(e,function(e,r){r==0?t[0]=e:(n=Math.floor(Math.random()*(r+1)),t[r]=t[n],t[n]=e)}),t},E.sortBy=function(e,t,n){return E.pluck(E.map(e,function(e,r,i){return{value:e,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}),"value")},E.groupBy=function(e,t){var n={},r=E.isFunction(t)?t:function(e){return e[t]};return S(e,function(e,t){var i=r(e,t);(n[i]||(n[i]=[])).push(e)}),n},E.sortedIndex=function(e,t,n){n||(n=E.identity);for(var r=0,i=e.length;r<i;){var s=r+i>>1;n(e[s])<n(t)?r=s+1:i=s}return r},E.toArray=function(e){return e?e.toArray?e.toArray():E.isArray(e)?o.call(e):E.isArguments(e)?o.call(e):E.values(e):[]},E.size=function(e){return E.toArray(e).length},E.first=E.head=function(e,t,n){return t!=null&&!n?o.call(e,0,t):e[0]},E.initial=function(e,t,n){return o.call(e,0,e.length-(t==null||n?1:t))},E.last=function(e,t,n){return t!=null&&!n?o.call(e,Math.max(e.length-t,0)):e[e.length-1]},E.rest=E.tail=function(e,t,n){return o.call(e,t==null||n?1:t)},E.compact=function(e){return E.filter(e,function(e){return!!e})},E.flatten=function(e,t){return E.reduce(e,function(e,n){return E.isArray(n)?e.concat(t?n:E.flatten(n)):(e[e.length]=n,e)},[])},E.without=function(e){return E.difference(e,o.call(arguments,1))},E.uniq=E.unique=function(e,t,n){var n=n?E.map(e,n):e,r=[];return E.reduce(n,function(n,i,s){if(0==s||(t===!0?E.last(n)!=i:!E.include(n,i)))n[n.length]=i,r[r.length]=e[s];return n},[]),r},E.union=function(){return E.uniq(E.flatten(arguments,!0))},E.intersection=E.intersect=function(e){var t=o.call(arguments,1);return E.filter(E.uniq(e),function(e){return E.every(t,function(t){return E.indexOf(t,e)>=0})})},E.difference=function(e){var t=E.flatten(o.call(arguments,1));return E.filter(e,function(e){return!E.include(t,e)})},E.zip=function(){for(var e=o.call(arguments),t=E.max(E.pluck(e,"length")),n=Array(t),r=0;r<t;r++)n[r]=E.pluck(e,""+r);return n},E.indexOf=function(e,t,n){if(e==null)return-1;var r;if(n)return n=E.sortedIndex(e,t),e[n]===t?n:-1;if(g&&e.indexOf===g)return e.indexOf(t);for(n=0,r=e.length;n<r;n++)if(n in e&&e[n]===t)return n;return-1},E.lastIndexOf=function(e,t){if(e==null)return-1;if(y&&e.lastIndexOf===y)return e.lastIndexOf(t);for(var n=e.length;n--;)if(n in e&&e[n]===t)return n;return-1},E.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0);for(var n=arguments[2]||1,r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);i<r;)s[i++]=e,e+=n;return s};var T=function(){};E.bind=function(e,t){var n,r;if(e.bind===w&&w)return w.apply(e,o.call(arguments,1));if(!E.isFunction(e))throw new TypeError;return r=o.call(arguments,2),n=function(){if(this instanceof n){T.prototype=e.prototype;var i=new T,s=e.apply(i,r.concat(o.call(arguments)));return Object(s)===s?s:i}return e.apply(t,r.concat(o.call(arguments)))}},E.bindAll=function(e){var t=o.call(arguments,1);return t.length==0&&(t=E.functions(e)),S(t,function(t){e[t]=E.bind(e[t],e)}),e},E.memoize=function(e,t){var n={};return t||(t=E.identity),function(){var r=t.apply(this,arguments);return E.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},E.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(e,n)},t)},E.defer=function(e){return E.delay.apply(E,[e,1].concat(o.call(arguments,1)))},E.throttle=function(e,t){var n,r,i,s,o,u=E.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var a;i||(i=setTimeout(function(){i=null,o&&e.apply(n,r),u()},t)),s?o=!0:e.apply(n,r),u(),s=!0}},E.debounce=function(e,t){var n;return function(){var r=this,i=arguments;clearTimeout(n),n=setTimeout(function(){n=null,e.apply(r,i)},t)}},E.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments))}},E.wrap=function(e,t){return function(){var n=[e].concat(o.call(arguments,0));return t.apply(this,n)}},E.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},E.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},E.keys=b||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[],n;for(n in e)E.has(e,n)&&(t[t.length]=n);return t},E.values=function(e){return E.map(e,E.identity)},E.functions=E.methods=function(e){var t=[],n;for(n in e)E.isFunction(e[n])&&t.push(n);return t.sort()},E.extend=function(e){return S(o.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},E.defaults=function(e){return S(o.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},E.clone=function(e){return E.isObject(e)?E.isArray(e)?e.slice():E.extend({},e):e},E.tap=function(e,t){return t(e),e},E.isEqual=function(t,n){return e(t,n,[])},E.isEmpty=function(e){if(E.isArray(e)||E.isString(e))return e.length===0;for(var t in e)if(E.has(e,t))return!1;return!0},E.isElement=function(e){return!!e&&e.nodeType==1},E.isArray=s||function(e){return a.call(e)=="[object Array]"},E.isObject=function(e){return e===Object(e)},E.isArguments=function(e){return a.call(e)=="[object Arguments]"},E.isArguments(arguments)||(E.isArguments=function(e){return!!e&&!!E.has(e,"callee")}),E.isFunction=function(e){return a.call(e)=="[object Function]"},E.isString=function(e){return a.call(e)=="[object String]"},E.isNumber=function(e){return a.call(e)=="[object Number]"},E.isNaN=function(e){return e!==e},E.isBoolean=function(e){return e===!0||e===!1||a.call(e)=="[object Boolean]"},E.isDate=function(e){return a.call(e)=="[object Date]"},E.isRegExp=function(e){return a.call(e)=="[object RegExp]"},E.isNull=function(e){return e===null},E.isUndefined=function(e){return e===void 0},E.has=function(e,t){return f.call(e,t)},E.noConflict=function(){return t._=n,this},E.identity=function(e){return e},E.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},E.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},E.mixin=function(e){S(E.functions(e),function(t){O(t,E[t]=e[t])})};var N=0;E.uniqueId=function(e){var t=N++;return e?e+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,k=function(e){return e.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};E.template=function(e,t){var n=E.templateSettings,n="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(n.escape||C,function(e,t){return"',_.escape("+k(t)+"),'"}).replace(n.interpolate||C,function(e,t){return"',"+k(t)+",'"}).replace(n.evaluate||C,function(e,t){return"');"+k(t).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",r=new Function("obj","_",n);return t?r(t,E):function(e){return r.call(this,e,E)}},E.chain=function(e){return E(e).chain()};var L=function(e){this._wrapped=e};E.prototype=L.prototype;var A=function(e,t){return t?E(e).chain():e},O=function(e,t){L.prototype[e]=function(){var e=o.call(arguments);return u.call(e,this._wrapped),A(t.apply(E,e),this._chain)}};E.mixin(E),S("pop,push,reverse,shift,sort,splice,unshift".split(","),function(e){var t=i[e];L.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);var r=n.length;return(e=="shift"||e=="splice")&&r===0&&delete n[0],A(n,this._chain)}}),S(["concat","join","slice"],function(e){var t=i[e];L.prototype[e]=function(){return A(t.apply(this._wrapped,arguments),this._chain)}}),L.prototype.chain=function(){return this._chain=!0,this},L.prototype.value=function(){return this._wrapped}}.call(this),function(e,t){function n(e,t){this._d=e,this._isUTC=!!t}function r(e){return e<0?Math.ceil(e):Math.floor(e)}function i(e){var t=this._data={},n=e.years||e.y||0,i=e.months||e.M||0,s=e.weeks||e.w||0,o=e.days||e.d||0,u=e.hours||e.h||0,a=e.minutes||e.m||0,f=e.seconds||e.s||0,l=e.milliseconds||e.ms||0;this._milliseconds=l+f*1e3+a*6e4+u*36e5,this._days=o+s*7,this._months=i+n*12,t.milliseconds=l%1e3,f+=r(l/1e3),t.seconds=f%60,a+=r(f/60),t.minutes=a%60,u+=r(a/60),t.hours=u%24,o+=r(u/24),o+=s*7,t.days=o%30,i+=r(o/30),t.months=i%12,n+=r(i/12),t.years=n}function s(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function o(e,t,n){var r=t._milliseconds,i=t._days,s=t._months,o;r&&e._d.setTime(+e+r*n),i&&e.date(e.date()+i*n),s&&(o=e.date(),e.date(1).month(e.month()+s*n).date(Math.min(o,e.daysInMonth())))}function u(e){return Object.prototype.toString.call(e)==="[object Array]"}function a(t){return new e(t[0],t[1]||0,t[2]||1,t[3]||0,t[4]||0,t[5]||0,t[6]||0)}function f(t,n){function r(n){var g,y;switch(n){case"M":return i+1;case"Mo":return i+1+v(i+1);case"MM":return s(i+1,2);case"MMM":return E.monthsShort[i];case"MMMM":return E.months[i];case"D":return o;case"Do":return o+v(o);case"DD":return s(o,2);case"DDD":return g=new e(u,i,o),y=new e(u,0,1),~~((g-y)/864e5+1.5);case"DDDo":return g=r("DDD"),g+v(g);case"DDDD":return s(r("DDD"),3);case"d":return a;case"do":return a+v(a);case"ddd":return E.weekdaysShort[a];case"dddd":return E.weekdays[a];case"w":return g=new e(u,i,o-a+5),y=new e(g.getFullYear(),0,4),~~((g-y)/864e5/7+1.5);case"wo":return g=r("w"),g+v(g);case"ww":return s(r("w"),2);case"YY":return s(u%100,2);case"YYYY":return u;case"a":return m?m(l,c,!1):l>11?"pm":"am";case"A":return m?m(l,c,!0):l>11?"PM":"AM";case"H":return l;case"HH":return s(l,2);case"h":return l%12||12;case"hh":return s(l%12||12,2);case"m":return c;case"mm":return s(c,2);case"s":return h;case"ss":return s(h,2);case"S":return~~(p/100);case"SS":return s(~~(p/10),2);case"SSS":return s(p,3);case"Z":return(d<0?"-":"+")+s(~~(Math.abs(d)/60),2)+":"+s(~~(Math.abs(d)%60),2);case"ZZ":return(d<0?"-":"+")+s(~~(10*Math.abs(d)/6),4);case"L":case"LL":case"LLL":case"LLLL":case"LT":return f(t,E.longDateFormat[n]);default:return n.replace(/(^\[)|(\\)|\]$/g,"")}}var i=t.month(),o=t.date(),u=t.year(),a=t.day(),l=t.hours(),c=t.minutes(),h=t.seconds(),p=t.milliseconds(),d=-t.zone(),v=E.ordinal,m=E.meridiem;return n.replace(O,r)}function l(e){switch(e){case"S":return _;case"SS":return H;case"SSS":case"DDDD":return B;case"YYYY":return j;case"DDD":return P;case"MMM":case"MMMM":case"ddd":case"dddd":case"a":case"A":return F;case"Z":case"ZZ":return I;case"T":return q;case"MM":case"DD":case"dd":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return D;default:return new RegExp(e.replace("\\",""))}}function c(e,t,n,r){var i;switch(e){case"M":case"MM":n[1]=~~t-1;break;case"MMM":case"MMMM":for(i=0;i<12;i++)if(E.monthsParse[i].test(t)){n[1]=i;break}break;case"D":case"DD":case"DDD":case"DDDD":n[2]=~~t;break;case"YY":t=~~t,n[0]=t+(t>70?1900:2e3);break;case"YYYY":n[0]=~~Math.abs(t);break;case"a":case"A":r.isPm=t.toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":n[3]=~~t;break;case"m":case"mm":n[4]=~~t;break;case"s":case"ss":n[5]=~~t;break;case"S":n[6]=~~t*100;break;case"SS":n[6]=~~t*10;break;case"SSS":n[6]=~~t;break;case"Z":case"ZZ":r.isUTC=!0,i=(t+"").match(W),i&&i[1]&&(r.tzh=~~i[1]),i&&i[2]&&(r.tzm=~~i[2]),i&&i[0]==="+"&&(r.tzh=-r.tzh,r.tzm=-r.tzm)}}function h(t,n){var r=[0,0,1,0,0,0,0],i={tzh:0,tzm:0},s=n.match(O),o,u;for(o=0;o<s.length;o++)u=(l(s[o]).exec(t)||[0])[0],t=t.replace(l(s[o]),""),c(s[o],u,r,i);return i.isPm&&r[3]<12&&(r[3]+=12),i.isPm===!1&&r[3]===12&&(r[3]=0),r[3]+=i.tzh,r[4]+=i.tzm,i.isUTC?new e(e.UTC.apply({},r)):a(r)}function p(e,t){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)~~e[s]!==~~t[s]&&i++;return i+r}function d(e,t){var r,i=e.match(M),s,o=99,u,a,l;for(u=0;u<t.length;u++)a=h(e,t[u]),s=f(new n(a),t[u]).match(M),l=p(i,s),l<o&&(o=l,r=a);return r}function v(t){var n="YYYY-MM-DDT",r;if(R.exec(t)){for(r=0;r<3;r++)if(z[r][1].exec(t)){n+=z[r][0];break}return I.exec(t)?h(t,n+" Z"):h(t,n)}return new e(t)}function m(e,t,n,r){var i=E.relativeTime[e];return typeof i=="function"?i(t||1,!!n,e,r):i.replace(/%d/i,t||1)}function g(e,t){var n=x(Math.abs(e)/1e3),r=x(n/60),i=x(r/60),s=x(i/24),o=x(s/365),u=n<45&&["s",n]||r===1&&["m"]||r<45&&["mm",r]||i===1&&["h"]||i<22&&["hh",i]||s===1&&["d"]||s<=25&&["dd",s]||s<=45&&["M"]||s<345&&["MM",x(s/30)]||o===1&&["y"]||["yy",o];return u[2]=t,u[3]=e>0,m.apply({},u)}function y(e,t){E.fn[e]=function(e){var n=this._isUTC?"UTC":"";return e!=null?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}function b(e){E.duration.fn[e]=function(){return this._data[e]}}function w(e,t){E.duration.fn["as"+e]=function(){return+this/t}}var E,S="1.6.1",x=Math.round,T,N={},C="en",k=typeof module!="undefined",L="months|monthsShort|monthsParse|weekdays|weekdaysShort|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),A=/^\/?Date\((\-?\d+)/i,O=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|LT|LL?L?L?)/g,M=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,_=/\d/,D=/\d\d?/,P=/\d{1,3}/,H=/\d\d/,B=/\d{3}/,j=/\d{4}/,F=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,I=/[\+\-]\d\d:?\d\d/i,q=/T/i,R=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d)?)?)?([\+\-]\d\d:?\d\d)?)?/,U="YYYY-MM-DDTHH:mm:ssZ",z=[["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],W=/([\+\-]|\d\d)/gi,X="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),V="years|months|days|hours|minutes|seconds|milliseconds".split("|"),$={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Weeks:6048e5,Months:2592e6,Years:31536e6};E=function(r,i){if(r===null||r==="")return null;var s,o,f;return E.isMoment(r)?(s=new e(+r._d),f=r._isUTC):i?u(i)?s=d(r,i):s=h(r,i):(o=A.exec(r),s=r===t?new e:o?new e(+o[1]):r instanceof e?r:u(r)?a(r):typeof r=="string"?v(r):new e(r)),new n(s,f)},E.utc=function(t,r){return u(t)?new n(new e(e.UTC.apply({},t)),!0):r&&t?E(t+" +0000",r+" Z").utc():E(I.exec(t)?t:t+"+0000").utc()},E.unix=function(e){return E(e*1e3)},E.duration=function(e,t){var n=E.isDuration(e),r=typeof e=="number",s=n?e._data:r?{}:e;return r&&(t?s[t]=e:s.milliseconds=e),new i(s)},E.humanizeDuration=function(e,t,n){return E.duration(e,t).humanize(n)},E.version=S,E.defaultFormat=U,E.lang=function(e,t){var n,r,i=[];if(!e)return C;if(t){for(n=0;n<12;n++)i[n]=new RegExp("^"+t.months[n]+"|^"+t.monthsShort[n].replace(".",""),"i");t.monthsParse=t.monthsParse||i,N[e]=t}if(N[e]){for(n=0;n<L.length;n++)E[L[n]]=N[e][L[n]]||N.en[L[n]];C=e}else k&&(r=require("./lang/"+e),E.lang(e,r))},E.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:!1,calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"}}),E.isMoment=function(e){return e instanceof n},E.isDuration=function(e){return e instanceof i},E.fn=n.prototype={clone:function(){return E(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this._d.toString()},toDate:function(){return this._d},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){return f(this,e?e:E.defaultFormat)},add:function(e,t){var n=t?E.duration(+t,e):E.duration(e);return o(this,n,1),this},subtract:function(e,t){var n=t?E.duration(+t,e):E.duration(e);return o(this,n,-1),this},diff:function(e,t,n){var r=this._isUTC?E(e).utc():E(e).local(),i=(this.zone()-r.zone())*6e4,s=this._d-r._d-i,o=this.year()-r.year(),u=this.month()-r.month(),a=this.date()-r.date(),f;return t==="months"?f=o*12+u+a/30:t==="years"?f=o+(u+a/30)/12:f=t==="seconds"?s/1e3:t==="minutes"?s/6e4:t==="hours"?s/36e5:t==="days"?s/864e5:t==="weeks"?s/6048e5:s,n?f:x(f)},from:function(e,t){return E.duration(this.diff(e)).humanize(!t)},fromNow:function(e){return this.from(E(),e)},calendar:function(){var e=this.diff(E().sod(),"days",!0),t=E.calendar,n=t.sameElse,r=e<-6?n:e<-1?t.lastWeek:e<0?t.lastDay:e<1?t.sameDay:e<2?t.nextDay:e<7?t.nextWeek:n;return this.format(typeof r=="function"?r.apply(this):r)},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<E([this.year()]).zone()||this.zone()<E([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e==null?t:this.add({d:e-t})},sod:function(){return this.clone().hours(0).minutes(0).seconds(0).milliseconds(0)},eod:function(){return this.sod().add({d:1,ms:-1})},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return this.clone().month(this.month()+1).date(0).date()}};for(T=0;T<X.length;T++)y(X[T].toLowerCase(),X[T]);y("year","FullYear"),E.duration.fn=i.prototype={weeks:function(){return r(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months*2592e6},humanize:function(e){var t=+this,n=E.relativeTime,r=g(t,!e);return e&&(r=(t<=0?n.past:n.future).replace(/%s/i,r)),r}};for(T=0;T<V.length;T++)b(V[T]);for(T in $)$.hasOwnProperty(T)&&w(T,$[T]);k&&(module.exports=E),typeof window!="undefined"&&typeof ender=="undefined"&&(window.moment=E),typeof define=="function"&&define.amd&&define("moment",[],function(){return E})}(Date),function(e,t){var n=e.parse,r=[1,4,5,6,7,10,11];e.parse=function(i){var s,o,a=0;if(o=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(i)){for(var l=0,h;h=r[l];++l)o[h]=+o[h]||0;o[2]=(+o[2]||1)-1,o[3]=+o[3]||1,o[8]!=="Z"&&o[9]!==t&&(a=o[10]*60+o[11],o[9]==="+"&&(a=0-a)),s=e.UTC(o[1],o[2],o[3],o[4],o[5]+a,o[6],o[7])}else s=n?n(i):NaN;return s}}(Date)(function(e){var t="0.3.4",n="hasOwnProperty",r=/[\.\/]/,i="*",s=function(){},o=function(e,t){return e-t},u,a,f={n:{}},l=function(e,t){var n=f,r=a,i=Array.prototype.slice.call(arguments,2),s=l.listeners(e),c=0,p=!1,d,v=[],m={},y=[],b=u,w=[];u=e,a=0;for(var E=0,S=s.length;E<S;E++)"zIndex"in s[E]&&(v.push(s[E].zIndex),s[E].zIndex<0&&(m[s[E].zIndex]=s[E]));v.sort(o);while(v[c]<0){d=m[v[c++]],y.push(d.apply(t,i));if(a)return a=r,y}for(E=0;E<S;E++){d=s[E];if("zIndex"in d)if(d.zIndex==v[c]){y.push(d.apply(t,i));if(a)break;do{c++,d=m[v[c]],d&&y.push(d.apply(t,i));if(a)break}while(d)}else m[d.zIndex]=d;else{y.push(d.apply(t,i));if(a)break}}return a=r,u=b,y.length?y:null};l.listeners=function(e){var t=e.split(r),n=f,s,o,u,a,l,c,h,p,v=[n],m=[];for(a=0,l=t.length;a<l;a++){p=[];for(c=0,h=v.length;c<h;c++){n=v[c].n,o=[n[t[a]],n[i]],u=2;while(u--)s=o[u],s&&(p.push(s),m=m.concat(s.f||[]))}v=p}return m},l.on=function(e,t){var n=e.split(r),i=f;for(var o=0,u=n.length;o<u;o++)i=i.n,!i[n[o]]&&(i[n[o]]={n:{}}),i=i[n[o]];i.f=i.f||[];for(o=0,u=i.f.length;o<u;o++)if(i.f[o]==t)return s;return i.f.push(t),function(e){+e==+e&&(t.zIndex=+e)}},l.stop=function(){a=1},l.nt=function(e){return e?(new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)")).test(u):u},l.off=l.unbind=function(e,t){var s=e.split(r),o,u,a,l,h,p,v,m=[f];for(l=0,h=s.length;l<h;l++)for(p=0;p<m.length;p+=a.length-2){a=[p,1],o=m[p].n;if(s[l]!=i)o[s[l]]&&a.push(o[s[l]]);else for(u in o)o[n](u)&&a.push(o[u]);m.splice.apply(m,a)}for(l=0,h=m.length;l<h;l++){o=m[l];while(o.n){if(t){if(o.f){for(p=0,v=o.f.length;p<v;p++)if(o.f[p]==t){o.f.splice(p,1);break}!o.f.length&&delete o.f}for(u in o.n)if(o.n[n](u)&&o.n[u].f){var g=o.n[u].f;for(p=0,v=g.length;p<v;p++)if(g[p]==t){g.splice(p,1);break}!g.length&&delete o.n[u].f}}else{delete o.f;for(u in o.n)o.n[n](u)&&o.n[u].f&&delete o.n[u].f}o=o.n}}},l.once=function(e,t){var n=function(){var r=t.apply(this,arguments);return l.unbind(e,n),r};return l.on(e,n)},l.version=t,l.toString=function(){return"You are running Eve "+t},typeof module!="undefined"&&module.exports?module.exports=l:typeof define!="undefined"?define("eve",[],function(){return l}):e.eve=l})(this),function(){function e(e){for(var t=0;t<An.length;t++)An[t].el.paper==e&&An.splice(t--,1)}function t(e,t,n,i,s,u){n=at(n);var a,f,l,c=[],h,p,d,v=e.ms,m={},g={},y={};if(i)for(E=0,x=An.length;E<x;E++){var b=An[E];if(b.el.id==t.id&&b.anim==e){b.percent!=n?(An.splice(E,1),l=1):f=b,t.attr(b.totalOrigin);break}}else i=+g;for(var E=0,x=e.percents.length;E<x;E++){if(e.percents[E]==n||e.percents[E]>i*e.top){n=e.percents[E],p=e.percents[E-1]||0,v=v/e.top*(n-p),h=e.percents[E+1],a=e.anim[n];break}i&&t.attr(e.anim[e.percents[E]])}if(!!a){if(!f){for(var T in a)if(a[C](T))if(ht[C](T)||t.paper.customAttributes[C](T)){m[T]=t.attr(T),m[T]==null&&(m[T]=ct[T]),g[T]=a[T];switch(ht[T]){case J:y[T]=(g[T]-m[T])/v;break;case"colour":m[T]=w.getRGB(m[T]);var N=w.getRGB(g[T]);y[T]={r:(N.r-m[T].r)/v,g:(N.g-m[T].g)/v,b:(N.b-m[T].b)/v};break;case"path":var k=Qt(m[T],g[T]),L=k[1];m[T]=k[0],y[T]=[];for(E=0,x=m[T].length;E<x;E++){y[T][E]=[0];for(var A=1,O=m[T][E].length;A<O;A++)y[T][E][A]=(L[E][A]-m[T][E][A])/v}break;case"transform":var M=t._,_=an(M[T],g[T]);if(_){m[T]=_.from,g[T]=_.to,y[T]=[],y[T].real=!0;for(E=0,x=m[T].length;E<x;E++){y[T][E]=[m[T][E][0]];for(A=1,O=m[T][E].length;A<O;A++)y[T][E][A]=(g[T][E][A]-m[T][E][A])/v}}else{var P=t.matrix||new o,H={_:{transform:M.transform},getBBox:function(){return t.getBBox(1)}};m[T]=[P.a,P.b,P.c,P.d,P.e,P.f],on(H,g[T]),g[T]=H._.transform,y[T]=[(H.matrix.a-P.a)/v,(H.matrix.b-P.b)/v,(H.matrix.c-P.c)/v,(H.matrix.d-P.d)/v,(H.matrix.e-P.e)/v,(H.matrix.f-P.f)/v]}break;case"csv":var B=j(a[T])[F](S),I=j(m[T])[F](S);if(T=="clip-rect"){m[T]=I,y[T]=[],E=I.length;while(E--)y[T][E]=(B[E]-m[T][E])/v}g[T]=B;break;default:B=[][D](a[T]),I=[][D](m[T]),y[T]=[],E=t.paper.customAttributes[T].length;while(E--)y[T][E]=((B[E]||0)-(I[E]||0))/v}}var q=a.easing,R=w.easing_formulas[q];if(!R){R=j(q).match(st);if(R&&R.length==5){var U=R;R=function(e){return r(e,+U[1],+U[2],+U[3],+U[4],v)}}else R=Nt}d=a.start||e.start||+(new Date),b={anim:e,percent:n,timestamp:d,start:d+(e.del||0),status:0,initstatus:i||0,stop:!1,ms:v,easing:R,from:m,diff:y,to:g,el:t,callback:a.callback,prev:p,next:h,repeat:u||e.times,origin:t.attr(),totalOrigin:s},An.push(b);if(i&&!f&&!l){b.stop=!0,b.start=new Date-v*i;if(An.length==1)return Mn()}l&&(b.start=new Date-b.ms*i),An.length==1&&On(Mn)}else f.initstatus=i,f.start=new Date-f.ms*i;eve("raphael.anim.start."+t.id,t,e)}}function n(e,t){var n=[],r={};this.ms=t,this.times=1;if(e){for(var i in e)e[C](i)&&(r[at(i)]=e[i],n.push(at(i)));n.sort(xt)}this.anim=r,this.top=n[n.length-1],this.percents=n}function r(e,t,n,r,i,s){function o(e,t){var n,r,i,s,o,u;for(i=e,u=0;u<8;u++){s=a(i)-e;if(X(s)<t)return i;o=(3*c*i+2*l)*i+f;if(X(o)<1e-6)break;i-=s/o}n=0,r=1,i=e;if(i<n)return n;if(i>r)return r;while(n<r){s=a(i);if(X(s-e)<t)return i;e>s?n=i:r=i,i=(r-n)/2+n}return i}function u(e,t){var n=o(e,t);return((d*n+p)*n+h)*n}function a(e){return((c*e+l)*e+f)*e}var f=3*t,l=3*(r-t)-f,c=1-f-l,h=3*n,p=3*(i-n)-h,d=1-h-p;return u(e,1/(200*s))}function i(){return this.x+B+this.y+B+this.width+" × "+this.height}function s(){return this.x+B+this.y}function o(e,t,n,r,i,s){e!=null?(this.a=+e,this.b=+t,this.c=+n,this.d=+r,this.e=+i,this.f=+s):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function u(e,t,n){e=w._path2curve(e),t=w._path2curve(t);var r,i,s,o,u,f,l,c,h,p,d=n?0:[];for(var v=0,m=e.length;v<m;v++){var g=e[v];if(g[0]=="M")r=u=g[1],i=f=g[2];else{g[0]=="C"?(h=[r,i].concat(g.slice(1)),r=h[6],i=h[7]):(h=[r,i,r,i,u,f,u,f],r=u,i=f);for(var y=0,b=t.length;y<b;y++){var E=t[y];if(E[0]=="M")s=l=E[1],o=c=E[2];else{E[0]=="C"?(p=[s,o].concat(E.slice(1)),s=p[6],o=p[7]):(p=[s,o,s,o,l,c,l,c],s=l,o=c);var S=a(h,p,n);if(n)d+=S;else{for(var x=0,T=S.length;x<T;x++)S[x].segment1=v,S[x].segment2=y,S[x].bez1=h,S[x].bez2=p;d=d.concat(S)}}}}}return d}function a(e,t,n){var r=w.bezierBBox(e),i=w.bezierBBox(t);if(!w.isBBoxIntersect(r,i))return n?0:[];var s=p.apply(0,e),o=p.apply(0,t),u=~~(s/5),a=~~(o/5),f=[],l=[],h={},d=n?0:[];for(var v=0;v<u+1;v++){var m=w.findDotsAtSegment.apply(w,e.concat(v/u));f.push({x:m.x,y:m.y,t:v/u})}for(v=0;v<a+1;v++)m=w.findDotsAtSegment.apply(w,t.concat(v/a)),l.push({x:m.x,y:m.y,t:v/a});for(v=0;v<u;v++)for(var g=0;g<a;g++){var y=f[v],b=f[v+1],E=l[g],S=l[g+1],x=X(b.x-y.x)<.001?"y":"x",T=X(S.x-E.x)<.001?"y":"x",N=c(y.x,y.y,b.x,b.y,E.x,E.y,S.x,S.y);if(N){if(h[N.x.toFixed(4)]==N.y.toFixed(4))continue;h[N.x.toFixed(4)]=N.y.toFixed(4);var C=y.t+X((N[x]-y[x])/(b[x]-y[x]))*(b.t-y.t),k=E.t+X((N[T]-E[T])/(S[T]-E[T]))*(S.t-E.t);C>=0&&C<=1&&k>=0&&k<=1&&(n?d++:d.push({x:N.x,y:N.y,t1:C,t2:k}))}}return d}function f(e,t){return a(e,t,1)}function l(e,t){return a(e,t)}function c(e,t,n,r,i,s,o,u){if(!(z(e,n)<W(i,o)||W(e,n)>z(i,o)||z(t,r)<W(s,u)||W(t,r)>z(s,u))){var a=(e*r-t*n)*(i-o)-(e-n)*(i*u-s*o),f=(e*r-t*n)*(s-u)-(t-r)*(i*u-s*o),l=(e-n)*(s-u)-(t-r)*(i-o);if(!l)return;var c=a/l,h=f/l,p=+c.toFixed(2),d=+h.toFixed(2);if(p<+W(e,n).toFixed(2)||p>+z(e,n).toFixed(2)||p<+W(i,o).toFixed(2)||p>+z(i,o).toFixed(2)||d<+W(t,r).toFixed(2)||d>+z(t,r).toFixed(2)||d<+W(s,u).toFixed(2)||d>+z(s,u).toFixed(2))return;return{x:c,y:h}}}function h(e,t,n,r,i,s,o,u,a){if(!(a<0||p(e,t,n,r,i,s,o,u)<a)){var f=1,l=f/2,c=f-l,h,d=.01;h=p(e,t,n,r,i,s,o,u,c);while(X(h-a)>d)l/=2,c+=(h<a?1:-1)*l,h=p(e,t,n,r,i,s,o,u,c);return c}}function p(e,t,n,r,i,s,o,u,a){a==null&&(a=1),a=a>1?1:a<0?0:a;var f=a/2,l=12,c=[-0.1252,.1252,-0.3678,.3678,-0.5873,.5873,-0.7699,.7699,-0.9041,.9041,-0.9816,.9816],h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0;for(var v=0;v<l;v++){var m=f*c[v]+f,g=d(m,e,n,i,o),y=d(m,t,r,s,u),b=g*g+y*y;p+=h[v]*U.sqrt(b)}return f*p}function d(e,t,n,r,i){var s=-3*t+9*n-9*r+3*i,o=e*s+6*t-12*n+6*r;return e*o-3*t+3*n}function v(e,t){var n=[];for(var r=0,i=e.length;i-2*!t>r;r+=2){var s=[{x:+e[r-2],y:+e[r-1]},{x:+e[r],y:+e[r+1]},{x:+e[r+2],y:+e[r+3]},{x:+e[r+4],y:+e[r+5]}];t?r?i-4==r?s[3]={x:+e[0],y:+e[1]}:i-2==r&&(s[2]={x:+e[0],y:+e[1]},s[3]={x:+e[2],y:+e[3]}):s[0]={x:+e[i-2],y:+e[i-1]}:i-4==r?s[3]=s[2]:r||(s[0]={x:+e[r],y:+e[r+1]}),n.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return n}function m(){return this.hex}function g(e,t,n){function r(){var i=Array.prototype.slice.call(arguments,0),s=i.join("␀"),o=r.cache=r.cache||{},u=r.count=r.count||[];return o[C](s)?(y(u,s),n?n(o[s]):o[s]):(u.length>=1e3&&delete o[u.shift()],u.push(s),o[s]=e[_](t,i),n?n(o[s]):o[s])}return r}function y(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function b(e){if(Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e[C](n)&&(t[n]=b(e[n]));return t}function w(e){if(w.is(e,"function"))return E?e():eve.on("raphael.DOMload",e);if(w.is(e,Q))return w._engine.create[_](w,e.splice(0,3+w.is(e[0],J))).add(e);var t=Array.prototype.slice.call(arguments,0);if(w.is(t[t.length-1],"function")){var n=t.pop();return E?n.call(w._engine.create[_](w,t)):eve.on("raphael.DOMload",function(){n.call(w._engine.create[_](w,t))})}return w._engine.create[_](w,arguments)}w.version="2.1.0",w.eve=eve;var E,S=/[, ]+/,x={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},T=/\{(\d+)\}/g,N="prototype",C="hasOwnProperty",k={doc:document,win:window},L={was:Object.prototype[C].call(k.win,"Raphael"),is:k.win.Raphael},A=function(){this.ca=this.customAttributes={}},O,M="appendChild",_="apply",D="concat",P="createTouch"in k.doc,H="",B=" ",j=String,F="split",I="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[F](B),q={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},R=j.prototype.toLowerCase,U=Math,z=U.max,W=U.min,X=U.abs,V=U.pow,$=U.PI,J="number",K="string",Q="array",G="toString",Y="fill",Z=Object.prototype.toString,et={},tt="push",nt=w._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,rt=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,it={NaN:1,Infinity:1,"-Infinity":1},st=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ot=U.round,ut="setAttribute",at=parseFloat,ft=parseInt,lt=j.prototype.toUpperCase,ct=w._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},ht=w._availableAnimAttrs={blur:J,"clip-rect":"csv",cx:J,cy:J,fill:"colour","fill-opacity":J,"font-size":J,height:J,opacity:J,path:"path",r:J,rx:J,ry:J,stroke:"colour","stroke-opacity":J,"stroke-width":J,transform:"transform",width:J,x:J,y:J},pt=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,dt=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,vt={hs:1,rg:1},mt=/,?([achlmqrstvxz]),?/gi,gt=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,yt=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,bt=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,wt=w._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,Et={},St=function(e,t){return e.key-t.key},xt=function(e,t){return at(e)-at(t)},Tt=function(){},Nt=function(e){return e},Ct=w._rectPath=function(e,t,n,r,i){return i?[["M",e+i,t],["l",n-i*2,0],["a",i,i,0,0,1,i,i],["l",0,r-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-n,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-r],["a",i,i,0,0,1,i,-i],["z"]]:[["M",e,t],["l",n,0],["l",0,r],["l",-n,0],["z"]]},kt=function(e,t,n,r){return r==null&&(r=n),[["M",e,t],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]]},Lt=w._getPath={path:function(e){return e.attr("path")},circle:function(e){var t=e.attrs;return kt(t.cx,t.cy,t.r)},ellipse:function(e){var t=e.attrs;return kt(t.cx,t.cy,t.rx,t.ry)},rect:function(e){var t=e.attrs;return Ct(t.x,t.y,t.width,t.height,t.r)},image:function(e){var t=e.attrs;return Ct(t.x,t.y,t.width,t.height)},text:function(e){var t=e._getBBox();return Ct(t.x,t.y,t.width,t.height)}},At=w.mapPath=function(e,t){if(!t)return e;var n,r,i,s,o,u,a;e=Qt(e);for(i=0,o=e.length;i<o;i++){a=e[i];for(s=1,u=a.length;s<u;s+=2)n=t.x(a[s],a[s+1]),r=t.y(a[s],a[s+1]),a[s]=n,a[s+1]=r}return e};w._g=k,w.type=k.win.SVGAngle||k.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(w.type=="VML"){var Ot=k.doc.createElement("div"),Mt;Ot.innerHTML='<v:shape adj="1"/>',Mt=Ot.firstChild,Mt.style.behavior="url(#default#VML)";if(!Mt||typeof Mt.adj!="object")return w.type=H;Ot=null}w.svg=!(w.vml=w.type=="VML"),w._Paper=A,w.fn=O=A.prototype=w.prototype,w._id=0,w._oid=0,w.is=function(e,t){return t=R.call(t),t=="finite"?!it[C](+e):t=="array"?e instanceof Array:t=="null"&&e===null||t==typeof e&&e!==null||t=="object"&&e===Object(e)||t=="array"&&Array.isArray&&Array.isArray(e)||Z.call(e).slice(8,-1).toLowerCase()==t},w.angle=function(e,t,n,r,i,s){if(i==null){var o=e-n,u=t-r;return!o&&!u?0:(180+U.atan2(-u,-o)*180/$+360)%360}return w.angle(e,t,i,s)-w.angle(n,r,i,s)},w.rad=function(e){return e%360*$/180},w.deg=function(e){return e*180/$%360},w.snapTo=function(e,t,n){n=w.is(n,"finite")?n:10;if(w.is(e,Q)){var r=e.length;while(r--)if(X(e[r]-t)<=n)return e[r]}else{e=+e;var i=t%e;if(i<n)return t-i;if(i>e-n)return t-i+e}return t};var _t=w.createUUID=function(e,t){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(e,t).toUpperCase()}}(/[xy]/g,function(e){var t=U.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)});w.setWindow=function(e){eve("raphael.setWindow",w,k.win,e),k.win=e,k.doc=k.win.document,w._engine.initWin&&w._engine.initWin(k.win)};var Dt=function(e){if(w.vml){var t=/^\s+|\s+$/g,n;try{var r=new ActiveXObject("htmlfile");r.write("<body>"),r.close(),n=r.body}catch(i){n=createPopup().document.body}var s=n.createTextRange();Dt=g(function(e){try{n.style.color=j(e).replace(t,H);var r=s.queryCommandValue("ForeColor");return r=(r&255)<<16|r&65280|(r&16711680)>>>16,"#"+("000000"+r.toString(16)).slice(-6)}catch(i){return"none"}})}else{var o=k.doc.createElement("i");o.title="Raphaël Colour Picker",o.style.display="none",k.doc.body.appendChild(o),Dt=g(function(e){return o.style.color=e,k.doc.defaultView.getComputedStyle(o,H).getPropertyValue("color")})}return Dt(e)},Pt=function(){return"hsb("+[this.h,this.s,this.b]+")"},Ht=function(){return"hsl("+[this.h,this.s,this.l]+")"},Bt=function(){return this.hex},jt=function(e,t,n){t==null&&w.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(n=e.b,t=e.g,e=e.r);if(t==null&&w.is(e,K)){var r=w.getRGB(e);e=r.r,t=r.g,n=r.b}if(e>1||t>1||n>1)e/=255,t/=255,n/=255;return[e,t,n]},Ft=function(e,t,n,r){e*=255,t*=255,n*=255;var i={r:e,g:t,b:n,hex:w.rgb(e,t,n),toString:Bt};return w.is(r,"finite")&&(i.opacity=r),i};w.color=function(e){var t;return w.is(e,"object")&&"h"in e&&"s"in e&&"b"in e?(t=w.hsb2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.hex=t.hex):w.is(e,"object")&&"h"in e&&"s"in e&&"l"in e?(t=w.hsl2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.hex=t.hex):(w.is(e,"string")&&(e=w.getRGB(e)),w.is(e,"object")&&"r"in e&&"g"in e&&"b"in e?(t=w.rgb2hsl(e),e.h=t.h,e.s=t.s,e.l=t.l,t=w.rgb2hsb(e),e.v=t.b):(e={hex:"none"},e.r=e.g=e.b=e.h=e.s=e.v=e.l=-1)),e.toString=Bt,e},w.hsb2rgb=function(e,t,n,r){this.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(n=e.b,t=e.s,e=e.h,r=e.o),e*=360;var i,s,o,u,a;return e=e%360/60,a=n*t,u=a*(1-X(e%2-1)),i=s=o=n-a,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],Ft(i,s,o,r)},w.hsl2rgb=function(e,t,n,r){this.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(n=e.l,t=e.s,e=e.h);if(e>1||t>1||n>1)e/=360,t/=100,n/=100;e*=360;var i,s,o,u,a;return e=e%360/60,a=2*t*(n<.5?n:1-n),u=a*(1-X(e%2-1)),i=s=o=n-a/2,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],Ft(i,s,o,r)},w.rgb2hsb=function(e,t,n){n=jt(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o;return s=z(e,t,n),o=s-W(e,t,n),r=o==0?null:s==e?(t-n)/o:s==t?(n-e)/o+2:(e-t)/o+4,r=(r+360)%6*60/360,i=o==0?0:o/s,{h:r,s:i,b:s,toString:Pt}},w.rgb2hsl=function(e,t,n){n=jt(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o,u,a;return o=z(e,t,n),u=W(e,t,n),a=o-u,r=a==0?null:o==e?(t-n)/a:o==t?(n-e)/a+2:(e-t)/a+4,r=(r+360)%6*60/360,s=(o+u)/2,i=a==0?0:s<.5?a/(2*s):a/(2-2*s),{h:r,s:i,l:s,toString:Ht}},w._path2string=function(){return this.join(",").replace(mt,"$1")};var It=w._preload=function(e,t){var n=k.doc.createElement("img");n.style.cssText="position:absolute;left:-9999em;top:-9999em",n.onload=function(){t.call(this),this.onload=null,k.doc.body.removeChild(this)},n.onerror=function(){k.doc.body.removeChild(this)},k.doc.body.appendChild(n),n.src=e};w.getRGB=g(function(e){if(!e||!!((e=j(e)).indexOf("-")+1))return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:m};if(e=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:m};!vt[C](e.toLowerCase().substring(0,2))&&e.charAt()!="#"&&(e=Dt(e));var t,n,r,i,s,o,u,a=e.match(rt);return a?(a[2]&&(i=ft(a[2].substring(5),16),r=ft(a[2].substring(3,5),16),n=ft(a[2].substring(1,3),16)),a[3]&&(i=ft((o=a[3].charAt(3))+o,16),r=ft((o=a[3].charAt(2))+o,16),n=ft((o=a[3].charAt(1))+o,16)),a[4]&&(u=a[4][F](dt),n=at(u[0]),u[0].slice(-1)=="%"&&(n*=2.55),r=at(u[1]),u[1].slice(-1)=="%"&&(r*=2.55),i=at(u[2]),u[2].slice(-1)=="%"&&(i*=2.55),a[1].toLowerCase().slice(0,4)=="rgba"&&(s=at(u[3])),u[3]&&u[3].slice(-1)=="%"&&(s/=100)),a[5]?(u=a[5][F](dt),n=at(u[0]),u[0].slice(-1)=="%"&&(n*=2.55),r=at(u[1]),u[1].slice(-1)=="%"&&(r*=2.55),i=at(u[2]),u[2].slice(-1)=="%"&&(i*=2.55),(u[0].slice(-3)=="deg"||u[0].slice(-1)=="°")&&(n/=360),a[1].toLowerCase().slice(0,4)=="hsba"&&(s=at(u[3])),u[3]&&u[3].slice(-1)=="%"&&(s/=100),w.hsb2rgb(n,r,i,s)):a[6]?(u=a[6][F](dt),n=at(u[0]),u[0].slice(-1)=="%"&&(n*=2.55),r=at(u[1]),u[1].slice(-1)=="%"&&(r*=2.55),i=at(u[2]),u[2].slice(-1)=="%"&&(i*=2.55),(u[0].slice(-3)=="deg"||u[0].slice(-1)=="°")&&(n/=360),a[1].toLowerCase().slice(0,4)=="hsla"&&(s=at(u[3])),u[3]&&u[3].slice(-1)=="%"&&(s/=100),w.hsl2rgb(n,r,i,s)):(a={r:n,g:r,b:i,toString:m},a.hex="#"+(16777216|i|r<<8|n<<16).toString(16).slice(1),w.is(s,"finite")&&(a.opacity=s),a)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:m}},w),w.hsb=g(function(e,t,n){return w.hsb2rgb(e,t,n).hex}),w.hsl=g(function(e,t,n){return w.hsl2rgb(e,t,n).hex}),w.rgb=g(function(e,t,n){return"#"+(16777216|n|t<<8|e<<16).toString(16).slice(1)}),w.getColor=function(e){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||.75},n=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,t.h>1&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),n.hex},w.getColor.reset=function(){delete this.start},w.parsePathString=function(e){if(!e)return null;var t=qt(e);if(t.arr)return Ut(t.arr);var n={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},r=[];return w.is(e,Q)&&w.is(e[0],Q)&&(r=Ut(e)),r.length||j(e).replace(gt,function(e,t,i){var s=[],o=t.toLowerCase();i.replace(bt,function(e,t){t&&s.push(+t)}),o=="m"&&s.length>2&&(r.push([t][D](s.splice(0,2))),o="l",t=t=="m"?"l":"L");if(o=="r")r.push([t][D](s));else while(s.length>=n[o]){r.push([t][D](s.splice(0,n[o])));if(!n[o])break}}),r.toString=w._path2string,t.arr=Ut(r),r},w.parseTransformString=g(function(e){if(!e)return null;var t={r:3,s:4,t:2,m:6},n=[];return w.is(e,Q)&&w.is(e[0],Q)&&(n=Ut(e)),n.length||j(e).replace(yt,function(e,t,r){var i=[],s=R.call(t);r.replace(bt,function(e,t){t&&i.push(+t)}),n.push([t][D](i))}),n.toString=w._path2string,n});var qt=function(e){var t=qt.ps=qt.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[C](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]};w.findDotsAtSegment=function(e,t,n,r,i,s,o,u,a){var f=1-a,l=V(f,3),c=V(f,2),h=a*a,p=h*a,d=l*e+c*3*a*n+f*3*a*a*i+p*o,v=l*t+c*3*a*r+f*3*a*a*s+p*u,m=e+2*a*(n-e)+h*(i-2*n+e),g=t+2*a*(r-t)+h*(s-2*r+t),y=n+2*a*(i-n)+h*(o-2*i+n),b=r+2*a*(s-r)+h*(u-2*s+r),w=f*e+a*n,E=f*t+a*r,S=f*i+a*o,x=f*s+a*u,T=90-U.atan2(m-y,g-b)*180/$;return(m>y||g<b)&&(T+=180),{x:d,y:v,m:{x:m,y:g},n:{x:y,y:b},start:{x:w,y:E},end:{x:S,y:x},alpha:T}},w.bezierBBox=function(e,t,n,r,i,s,o,u){w.is(e,"array")||(e=[e,t,n,r,i,s,o,u]);var a=Kt.apply(null,e);return{x:a.min.x,y:a.min.y,x2:a.max.x,y2:a.max.y,width:a.max.x-a.min.x,height:a.max.y-a.min.y}},w.isPointInsideBBox=function(e,t,n){return t>=e.x&&t<=e.x2&&n>=e.y&&n<=e.y2},w.isBBoxIntersect=function(e,t){var n=w.isPointInsideBBox;return n(t,e.x,e.y)||n(t,e.x2,e.y)||n(t,e.x,e.y2)||n(t,e.x2,e.y2)||n(e,t.x,t.y)||n(e,t.x2,t.y)||n(e,t.x,t.y2)||n(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)},w.pathIntersection=function(e,t){return u(e,t)},w.pathIntersectionNumber=function(e,t){return u(e,t,1)},w.isPointInsidePath=function(e,t,n){var r=w.pathBBox(e);return w.isPointInsideBBox(r,t,n)&&u(e,[["M",t,n],["H",r.x2+10]],1)%2==1},w._removedFactory=function(e){return function(){eve("raphael.log",null,"Raphaël: you are calling to method “"+e+"” of removed object",e)}};var Rt=w.pathBBox=function(e){var t=qt(e);if(t.bbox)return t.bbox;if(!e)return{x:0,y:0,width:0,height:0,x2:0,y2:0};e=Qt(e);var n=0,r=0,i=[],s=[],o;for(var u=0,a=e.length;u<a;u++){o=e[u];if(o[0]=="M")n=o[1],r=o[2],i.push(n),s.push(r);else{var f=Kt(n,r,o[1],o[2],o[3],o[4],o[5],o[6]);i=i[D](f.min.x,f.max.x),s=s[D](f.min.y,f.max.y),n=o[5],r=o[6]}}var l=W[_](0,i),c=W[_](0,s),h=z[_](0,i),p=z[_](0,s),d={x:l,y:c,x2:h,y2:p,width:h-l,height:p-c};return t.bbox=b(d),d},Ut=function(e){var t=b(e);return t.toString=w._path2string,t},zt=w._pathToRelative=function(e){var t=qt(e);if(t.rel)return Ut(t.rel);if(!w.is(e,Q)||!w.is(e&&e[0],Q))e=w.parsePathString(e);var n=[],r=0,i=0,s=0,o=0,u=0;e[0][0]=="M"&&(r=e[0][1],i=e[0][2],s=r,o=i,u++,n.push(["M",r,i]));for(var a=u,f=e.length;a<f;a++){var l=n[a]=[],c=e[a];if(c[0]!=R.call(c[0])){l[0]=R.call(c[0]);switch(l[0]){case"a":l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5],l[6]=+(c[6]-r).toFixed(3),l[7]=+(c[7]-i).toFixed(3);break;case"v":l[1]=+(c[1]-i).toFixed(3);break;case"m":s=c[1],o=c[2];default:for(var h=1,p=c.length;h<p;h++)l[h]=+(c[h]-(h%2?r:i)).toFixed(3)}}else{l=n[a]=[],c[0]=="m"&&(s=c[1]+r,o=c[2]+i);for(var d=0,v=c.length;d<v;d++)n[a][d]=c[d]}var m=n[a].length;switch(n[a][0]){case"z":r=s,i=o;break;case"h":r+=+n[a][m-1];break;case"v":i+=+n[a][m-1];break;default:r+=+n[a][m-2],i+=+n[a][m-1]}}return n.toString=w._path2string,t.rel=Ut(n),n},Wt=w._pathToAbsolute=function(e){var t=qt(e);if(t.abs)return Ut(t.abs);if(!w.is(e,Q)||!w.is(e&&e[0],Q))e=w.parsePathString(e);if(!e||!e.length)return[["M",0,0]];var n=[],r=0,i=0,s=0,o=0,u=0;e[0][0]=="M"&&(r=+e[0][1],i=+e[0][2],s=r,o=i,u++,n[0]=["M",r,i]);var a=e.length==3&&e[0][0]=="M"&&e[1][0].toUpperCase()=="R"&&e[2][0].toUpperCase()=="Z";for(var f,l,c=u,h=e.length;c<h;c++){n.push(f=[]),l=e[c];if(l[0]!=lt.call(l[0])){f[0]=lt.call(l[0]);switch(f[0]){case"A":f[1]=l[1],f[2]=l[2],f[3]=l[3],f[4]=l[4],f[5]=l[5],f[6]=+(l[6]+r),f[7]=+(l[7]+i);break;case"V":f[1]=+l[1]+i;break;case"H":f[1]=+l[1]+r;break;case"R":var p=[r,i][D](l.slice(1));for(var d=2,m=p.length;d<m;d++)p[d]=+p[d]+r,p[++d]=+p[d]+i;n.pop(),n=n[D](v(p,a));break;case"M":s=+l[1]+r,o=+l[2]+i;default:for(d=1,m=l.length;d<m;d++)f[d]=+l[d]+(d%2?r:i)}}else if(l[0]=="R")p=[r,i][D](l.slice(1)),n.pop(),n=n[D](v(p,a)),f=["R"][D](l.slice(-2));else for(var g=0,y=l.length;g<y;g++)f[g]=l[g];switch(f[0]){case"Z":r=s,i=o;break;case"H":r=f[1];break;case"V":i=f[1];break;case"M":s=f[f.length-2],o=f[f.length-1];default:r=f[f.length-2],i=f[f.length-1]}}return n.toString=w._path2string,t.abs=Ut(n),n},Xt=function(e,t,n,r){return[e,t,n,r,n,r]},Vt=function(e,t,n,r,i,s){var o=1/3,u=2/3;return[o*e+u*n,o*t+u*r,o*i+u*n,o*s+u*r,i,s]},$t=function(e,t,n,r,i,s,o,u,a,f){var l=$*120/180,c=$/180*(+i||0),h=[],p,d=g(function(e,t,n){var r=e*U.cos(n)-t*U.sin(n),i=e*U.sin(n)+t*U.cos(n);return{x:r,y:i}});if(!f){p=d(e,t,-c),e=p.x,t=p.y,p=d(u,a,-c),u=p.x,a=p.y;var v=U.cos($/180*i),m=U.sin($/180*i),y=(e-u)/2,b=(t-a)/2,w=y*y/(n*n)+b*b/(r*r);w>1&&(w=U.sqrt(w),n=w*n,r=w*r);var E=n*n,S=r*r,x=(s==o?-1:1)*U.sqrt(X((E*S-E*b*b-S*y*y)/(E*b*b+S*y*y))),T=x*n*b/r+(e+u)/2,N=x*-r*y/n+(t+a)/2,C=U.asin(((t-N)/r).toFixed(9)),k=U.asin(((a-N)/r).toFixed(9));C=e<T?$-C:C,k=u<T?$-k:k,C<0&&(C=$*2+C),k<0&&(k=$*2+k),o&&C>k&&(C-=$*2),!o&&k>C&&(k-=$*2)}else C=f[0],k=f[1],T=f[2],N=f[3];var L=k-C;if(X(L)>l){var A=k,O=u,M=a;k=C+l*(o&&k>C?1:-1),u=T+n*U.cos(k),a=N+r*U.sin(k),h=$t(u,a,n,r,i,0,o,O,M,[k,A,T,N])}L=k-C;var _=U.cos(C),P=U.sin(C),H=U.cos(k),B=U.sin(k),j=U.tan(L/4),I=4/3*n*j,q=4/3*r*j,R=[e,t],z=[e+I*P,t-q*_],W=[u+I*B,a-q*H],V=[u,a];z[0]=2*R[0]-z[0],z[1]=2*R[1]-z[1];if(f)return[z,W,V][D](h);h=[z,W,V][D](h).join()[F](",");var J=[];for(var K=0,Q=h.length;K<Q;K++)J[K]=K%2?d(h[K-1],h[K],c).y:d(h[K],h[K+1],c).x;return J},Jt=function(e,t,n,r,i,s,o,u,a){var f=1-a;return{x:V(f,3)*e+V(f,2)*3*a*n+f*3*a*a*i+V(a,3)*o,y:V(f,3)*t+V(f,2)*3*a*r+f*3*a*a*s+V(a,3)*u}},Kt=g(function(e,t,n,r,i,s,o,u){var a=i-2*n+e-(o-2*i+n),f=2*(n-e)-2*(i-n),l=e-n,c=(-f+U.sqrt(f*f-4*a*l))/2/a,h=(-f-U.sqrt(f*f-4*a*l))/2/a,p=[t,u],d=[e,o],v;return X(c)>"1e12"&&(c=.5),X(h)>"1e12"&&(h=.5),c>0&&c<1&&(v=Jt(e,t,n,r,i,s,o,u,c),d.push(v.x),p.push(v.y)),h>0&&h<1&&(v=Jt(e,t,n,r,i,s,o,u,h),d.push(v.x),p.push(v.y)),a=s-2*r+t-(u-2*s+r),f=2*(r-t)-2*(s-r),l=t-r,c=(-f+U.sqrt(f*f-4*a*l))/2/a,h=(-f-U.sqrt(f*f-4*a*l))/2/a,X(c)>"1e12"&&(c=.5),X(h)>"1e12"&&(h=.5),c>0&&c<1&&(v=Jt(e,t,n,r,i,s,o,u,c),d.push(v.x),p.push(v.y)),h>0&&h<1&&(v=Jt(e,t,n,r,i,s,o,u,h),d.push(v.x),p.push(v.y)),{min:{x:W[_](0,d),y:W[_](0,p)},max:{x:z[_](0,d),y:z[_](0,p)}}}),Qt=w._path2curve=g(function(e,t){var n=!t&&qt(e);if(!t&&n.curve)return Ut(n.curve);var r=Wt(e),i=t&&Wt(t),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u=function(e,t){var n,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null);switch(e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"][D]($t[_](0,[t.x,t.y][D](e.slice(1))));break;case"S":n=t.x+(t.x-(t.bx||t.x)),r=t.y+(t.y-(t.by||t.y)),e=["C",n,r][D](e.slice(1));break;case"T":t.qx=t.x+(t.x-(t.qx||t.x)),t.qy=t.y+(t.y-(t.qy||t.y)),e=["C"][D](Vt(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"][D](Vt(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"][D](Xt(t.x,t.y,e[1],e[2]));break;case"H":e=["C"][D](Xt(t.x,t.y,e[1],t.y));break;case"V":e=["C"][D](Xt(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"][D](Xt(t.x,t.y,t.X,t.Y))}return e},a=function(e,t){if(e[t].length>7){e[t].shift();var n=e[t];while(n.length)e.splice(t++,0,["C"][D](n.splice(0,6)));e.splice(t,1),c=z(r.length,i&&i.length||0)}},f=function(e,t,n,s,o){e&&t&&e[o][0]=="M"&&t[o][0]!="M"&&(t.splice(o,0,["M",s.x,s.y]),n.bx=0,n.by=0,n.x=e[o][1],n.y=e[o][2],c=z(r.length,i&&i.length||0))};for(var l=0,c=z(r.length,i&&i.length||0);l<c;l++){r[l]=u(r[l],s),a(r,l),i&&(i[l]=u(i[l],o)),i&&a(i,l),f(r,i,s,o,l),f(i,r,o,s,l);var h=r[l],p=i&&i[l],d=h.length,v=i&&p.length;s.x=h[d-2],s.y=h[d-1],s.bx=at(h[d-4])||s.x,s.by=at(h[d-3])||s.y,o.bx=i&&(at(p[v-4])||o.x),o.by=i&&(at(p[v-3])||o.y),o.x=i&&p[v-2],o.y=i&&p[v-1]}return i||(n.curve=Ut(r)),i?[r,i]:r},null,Ut),Gt=w._parseDots=g(function(e){var t=[];for(var n=0,r=e.length;n<r;n++){var i={},s=e[n].match(/^([^:]*):?([\d\.]*)/);i.color=w.getRGB(s[1]);if(i.color.error)return null;i.color=i.color.hex,s[2]&&(i.offset=s[2]+"%"),t.push(i)}for(n=1,r=t.length-1;n<r;n++)if(!t[n].offset){var o=at(t[n-1].offset||0),u=0;for(var a=n+1;a<r;a++)if(t[a].offset){u=t[a].offset;break}u||(u=100,a=r),u=at(u);var f=(u-o)/(a-n+1);for(;n<a;n++)o+=f,t[n].offset=o+"%"}return t}),Yt=w._tear=function(e,t){e==t.top&&(t.top=e.prev),e==t.bottom&&(t.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)},Zt=w._tofront=function(e,t){t.top!==e&&(Yt(e,t),e.next=null,e.prev=t.top,t.top.next=e,t.top=e)},en=w._toback=function(e,t){t.bottom!==e&&(Yt(e,t),e.next=t.bottom,e.prev=null,t.bottom.prev=e,t.bottom=e)},tn=w._insertafter=function(e,t,n){Yt(e,n),t==n.top&&(n.top=e),t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e},nn=w._insertbefore=function(e,t,n){Yt(e,n),t==n.bottom&&(n.bottom=e),t.prev&&(t.prev.next=e),e.prev=t.prev,t.prev=e,e.next=t},rn=w.toMatrix=function(e,t){var n=Rt(e),r={_:{transform:H},getBBox:function(){return n}};return on(r,t),r.matrix},sn=w.transformPath=function(e,t){return At(e,rn(e,t))},on=w._extractTransform=function(e,t){if(t==null)return e._.transform;t=j(t).replace(/\.{3}|\u2026/g,e._.transform||H);var n=w.parseTransformString(t),r=0,i=0,s=0,u=1,a=1,f=e._,l=new o;f.transform=n||[];if(n)for(var c=0,h=n.length;c<h;c++){var p=n[c],d=p.length,v=j(p[0]).toLowerCase(),m=p[0]!=v,g=m?l.invert():0,y,b,E,S,x;v=="t"&&d==3?m?(y=g.x(0,0),b=g.y(0,0),E=g.x(p[1],p[2]),S=g.y(p[1],p[2]),l.translate(E-y,S-b)):l.translate(p[1],p[2]):v=="r"?d==2?(x=x||e.getBBox(1),l.rotate(p[1],x.x+x.width/2,x.y+x.height/2),r+=p[1]):d==4&&(m?(E=g.x(p[2],p[3]),S=g.y(p[2],p[3]),l.rotate(p[1],E,S)):l.rotate(p[1],p[2],p[3]),r+=p[1]):v=="s"?d==2||d==3?(x=x||e.getBBox(1),l.scale(p[1],p[d-1],x.x+x.width/2,x.y+x.height/2),u*=p[1],a*=p[d-1]):d==5&&(m?(E=g.x(p[3],p[4]),S=g.y(p[3],p[4]),l.scale(p[1],p[2],E,S)):l.scale(p[1],p[2],p[3],p[4]),u*=p[1],a*=p[2]):v=="m"&&d==7&&l.add(p[1],p[2],p[3],p[4],p[5],p[6]),f.dirtyT=1,e.matrix=l}e.matrix=l,f.sx=u,f.sy=a,f.deg=r,f.dx=i=l.e,f.dy=s=l.f,u==1&&a==1&&!r&&f.bbox?(f.bbox.x+=+i,f.bbox.y+=+s):f.dirtyT=1},un=function(e){var t=e[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return e.length==4?[t,0,e[2],e[3]]:[t,0];case"s":return e.length==5?[t,1,1,e[3],e[4]]:e.length==3?[t,1,1]:[t,1]}},an=w._equaliseTransform=function(e,t){t=j(t).replace(/\.{3}|\u2026/g,e),e=w.parseTransformString(e)||[],t=w.parseTransformString(t)||[];var n=z(e.length,t.length),r=[],i=[],s=0,o,u,a,f;for(;s<n;s++){a=e[s]||un(t[s]),f=t[s]||un(a);if(a[0]!=f[0]||a[0].toLowerCase()=="r"&&(a[2]!=f[2]||a[3]!=f[3])||a[0].toLowerCase()=="s"&&(a[3]!=f[3]||a[4]!=f[4]))return;r[s]=[],i[s]=[];for(o=0,u=z(a.length,f.length);o<u;o++)o in a&&(r[s][o]=a[o]),o in f&&(i[s][o]=f[o])}return{from:r,to:i}};w._getContainer=function(e,t,n,r){var i;i=r==null&&!w.is(e,"object")?k.doc.getElementById(e):e;if(i!=null)return i.tagName?t==null?{container:i,width:i.style.pixelWidth||i.offsetWidth,height:i.style.pixelHeight||i.offsetHeight}:{container:i,width:t,height:n}:{container:1,x:e,y:t,width:n,height:r}},w.pathToRelative=zt,w._engine={},w.path2curve=Qt,w.matrix=function(e,t,n,r,i,s){return new o(e,t,n,r,i,s)},function(e){function t(e){var t=U.sqrt(n(e));e[0]&&(e[0]/=t),e[1]&&(e[1]/=t)}function n(e){return e[0]*e[0]+e[1]*e[1]}e.add=function(e,t,n,r,i,s){var u=[[],[],[]],a=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],f=[[e,n,i],[t,r,s],[0,0,1]],l,c,h,p;e&&e instanceof o&&(f=[[e.a,e.c,e.e],[e.b,e.d,e.f],[0,0,1]]);for(l=0;l<3;l++)for(c=0;c<3;c++){p=0;for(h=0;h<3;h++)p+=a[l][h]*f[h][c];u[l][c]=p}this.a=u[0][0],this.b=u[1][0],this.c=u[0][1],this.d=u[1][1],this.e=u[0][2],this.f=u[1][2]},e.invert=function(){var e=this,t=e.a*e.d-e.b*e.c;return new o(e.d/t,-e.b/t,-e.c/t,e.a/t,(e.c*e.f-e.d*e.e)/t,(e.b*e.e-e.a*e.f)/t)},e.clone=function(){return new o(this.a,this.b,this.c,this.d,this.e,this.f)},e.translate=function(e,t){this.add(1,0,0,1,e,t)},e.scale=function(e,t,n,r){t==null&&(t=e),(n||r)&&this.add(1,0,0,1,n,r),this.add(e,0,0,t,0,0),(n||r)&&this.add(1,0,0,1,-n,-r)},e.rotate=function(e,t,n){e=w.rad(e),t=t||0,n=n||0;var r=+U.cos(e).toFixed(9),i=+U.sin(e).toFixed(9);this.add(r,i,-i,r,t,n),this.add(1,0,0,1,-t,-n)},e.x=function(e,t){return e*this.a+t*this.c+this.e},e.y=function(e,t){return e*this.b+t*this.d+this.f},e.get=function(e){return+this[j.fromCharCode(97+e)].toFixed(4)},e.toString=function(){return w.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},e.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},e.split=function(){var e={};e.dx=this.e,e.dy=this.f;var r=[[this.a,this.c],[this.b,this.d]];e.scalex=U.sqrt(n(r[0])),t(r[0]),e.shear=r[0][0]*r[1][0]+r[0][1]*r[1][1],r[1]=[r[1][0]-r[0][0]*e.shear,r[1][1]-r[0][1]*e.shear],e.scaley=U.sqrt(n(r[1])),t(r[1]),e.shear/=e.scaley;var i=-r[0][1],s=r[1][1];return s<0?(e.rotate=w.deg(U.acos(s)),i<0&&(e.rotate=360-e.rotate)):e.rotate=w.deg(U.asin(i)),e.isSimple=!+e.shear.toFixed(9)&&(e.scalex.toFixed(9)==e.scaley.toFixed(9)||!e.rotate),e.isSuperSimple=!+e.shear.toFixed(9)&&e.scalex.toFixed(9)==e.scaley.toFixed(9)&&!e.rotate,e.noRotation=!+e.shear.toFixed(9)&&!e.rotate,e},e.toTransformString=function(e){var t=e||this[F]();return t.isSimple?(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx||t.dy?"t"+[t.dx,t.dy]:H)+(t.scalex!=1||t.scaley!=1?"s"+[t.scalex,t.scaley,0,0]:H)+(t.rotate?"r"+[t.rotate,0,0]:H)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(o.prototype);var fn=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(fn&&fn[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&fn&&fn[1]<8?O.safari=function(){var e=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){e.remove()})}:O.safari=Tt;var ln=function(){this.returnValue=!1},cn=function(){return this.originalEvent.preventDefault()},hn=function(){this.cancelBubble=!0},pn=function(){return this.originalEvent.stopPropagation()},dn=function(){if(k.doc.addEventListener)return function(e,t,n,r){var i=P&&q[t]?q[t]:t,s=function(i){var s=k.doc.documentElement.scrollTop||k.doc.body.scrollTop,o=k.doc.documentElement.scrollLeft||k.doc.body.scrollLeft,u=i.clientX+o,a=i.clientY+s;if(P&&q[C](t))for(var f=0,l=i.targetTouches&&i.targetTouches.length;f<l;f++)if(i.targetTouches[f].target==e){var c=i;i=i.targetTouches[f],i.originalEvent=c,i.preventDefault=cn,i.stopPropagation=pn;break}return n.call(r,i,u,a)};return e.addEventListener(i,s,!1),function(){return e.removeEventListener(i,s,!1),!0}};if(k.doc.attachEvent)return function(e,t,n,r){var i=function(e){e=e||k.win.event;var t=k.doc.documentElement.scrollTop||k.doc.body.scrollTop,i=k.doc.documentElement.scrollLeft||k.doc.body.scrollLeft,s=e.clientX+i,o=e.clientY+t;return e.preventDefault=e.preventDefault||ln,e.stopPropagation=e.stopPropagation||hn,n.call(r,e,s,o)};e.attachEvent("on"+t,i);var s=function(){return e.detachEvent("on"+t,i),!0};return s}}(),vn=[],mn=function(e){var t=e.clientX,n=e.clientY,r=k.doc.documentElement.scrollTop||k.doc.body.scrollTop,i=k.doc.documentElement.scrollLeft||k.doc.body.scrollLeft,s,o=vn.length;while(o--){s=vn[o];if(P){var u=e.touches.length,a;while(u--){a=e.touches[u];if(a.identifier==s.el._drag.id){t=a.clientX,n=a.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}}else e.preventDefault();var f=s.el.node,l,c=f.nextSibling,h=f.parentNode,p=f.style.display;k.win.opera&&h.removeChild(f),f.style.display="none",l=s.el.paper.getElementByPoint(t,n),f.style.display=p,k.win.opera&&(c?h.insertBefore(f,c):h.appendChild(f)),l&&eve("raphael.drag.over."+s.el.id,s.el,l),t+=i,n+=r,eve("raphael.drag.move."+s.el.id,s.move_scope||s.el,t-s.el._drag.x,n-s.el._drag.y,t,n,e)}},gn=function(e){w.unmousemove(mn).unmouseup(gn);var t=vn.length,n;while(t--)n=vn[t],n.el._drag={},eve("raphael.drag.end."+n.el.id,n.end_scope||n.start_scope||n.move_scope||n.el,e);vn=[]},yn=w.el={};for(var bn=I.length;bn--;)(function(e){w[e]=yn[e]=function(t,n){return w.is(t,"function")&&(this.events=this.events||[],this.events.push({name:e,f:t,unbind:dn(this.shape||this.node||k.doc,e,t,n||this)})),this},w["un"+e]=yn["un"+e]=function(t){var n=this.events||[],r=n.length;while(r--)if(n[r].name==e&&n[r].f==t)return n[r].unbind(),n.splice(r,1),!n.length&&delete this.events,this;return this}})(I[bn]);yn.data=function(e,t){var n=Et[this.id]=Et[this.id]||{};if(arguments.length==1){if(w.is(e,"object")){for(var r in e)e[C](r)&&this.data(r,e[r]);return this}return eve("raphael.data.get."+this.id,this,n[e],e),n[e]}return n[e]=t,eve("raphael.data.set."+this.id,this,t,e),this},yn.removeData=function(e){return e==null?Et[this.id]={}:Et[this.id]&&delete Et[this.id][e],this},yn.hover=function(e,t,n,r){return this.mouseover(e,n).mouseout(t,r||n)},yn.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)};var wn=[];yn.drag=function(e,t,n,r,i,s){function o(o){(o.originalEvent||o).preventDefault();var u=k.doc.documentElement.scrollTop||k.doc.body.scrollTop,a=k.doc.documentElement.scrollLeft||k.doc.body.scrollLeft;this._drag.x=o.clientX+a,this._drag.y=o.clientY+u,this._drag.id=o.identifier,!vn.length&&w.mousemove(mn).mouseup(gn),vn.push({el:this,move_scope:r,start_scope:i,end_scope:s}),t&&eve.on("raphael.drag.start."+this.id,t),e&&eve.on("raphael.drag.move."+this.id,e),n&&eve.on("raphael.drag.end."+this.id,n),eve("raphael.drag.start."+this.id,i||r||this,o.clientX+a,o.clientY+u,o)}return this._drag={},wn.push({el:this,start:o}),this.mousedown(o),this},yn.onDragOver=function(e){e?eve.on("raphael.drag.over."+this.id,e):eve.unbind("raphael.drag.over."+this.id)},yn.undrag=function(){var e=wn.length;while(e--)wn[e].el==this&&(this.unmousedown(wn[e].start),wn.splice(e,1),eve.unbind("raphael.drag.*."+this.id));!wn.length&&w.unmousemove(mn).unmouseup(gn)},O.circle=function(e,t,n){var r=w._engine.circle(this,e||0,t||0,n||0);return this.__set__&&this.__set__.push(r),r},O.rect=function(e,t,n,r,i){var s=w._engine.rect(this,e||0,t||0,n||0,r||0,i||0);return this.__set__&&this.__set__.push(s),s},O.ellipse=function(e,t,n,r){var i=w._engine.ellipse(this,e||0,t||0,n||0,r||0);return this.__set__&&this.__set__.push(i),i},O.path=function(e){e&&!w.is(e,K)&&!w.is(e[0],Q)&&(e+=H);var t=w._engine.path(w.format[_](w,arguments),this);return this.__set__&&this.__set__.push(t),t},O.image=function(e,t,n,r,i){var s=w._engine.image(this,e||"about:blank",t||0,n||0,r||0,i||0);return this.__set__&&this.__set__.push(s),s},O.text=function(e,t,n){var r=w._engine.text(this,e||0,t||0,j(n));return this.__set__&&this.__set__.push(r),r},O.set=function(e){!w.is(e,"array")&&(e=Array.prototype.splice.call(arguments,0,arguments.length));var t=new Dn(e);return this.__set__&&this.__set__.push(t),t},O.setStart=function(e){this.__set__=e||this.set()},O.setFinish=function(e){var t=this.__set__;return delete this.__set__,t},O.setSize=function(e,t){return w._engine.setSize.call(this,e,t)},O.setViewBox=function(e,t,n,r,i){return w._engine.setViewBox.call(this,e,t,n,r,i)},O.top=O.bottom=null,O.raphael=w;var En=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.body,i=n.documentElement,s=i.clientTop||r.clientTop||0,o=i.clientLeft||r.clientLeft||0,u=t.top+(k.win.pageYOffset||i.scrollTop||r.scrollTop)-s,a=t.left+(k.win.pageXOffset||i.scrollLeft||r.scrollLeft)-o;return{y:u,x:a}};O.getElementByPoint=function(e,t){var n=this,r=n.canvas,i=k.doc.elementFromPoint(e,t);if(k.win.opera&&i.tagName=="svg"){var s=En(r),o=r.createSVGRect();o.x=e-s.x,o.y=t-s.y,o.width=o.height=1;var u=r.getIntersectionList(o,null);u.length&&(i=u[u.length-1])}if(!i)return null;while(i.parentNode&&i!=r.parentNode&&!i.raphael)i=i.parentNode;return i==n.canvas.parentNode&&(i=r),i=i&&i.raphael?n.getById(i.raphaelid):null,i},O.getById=function(e){var t=this.bottom;while(t){if(t.id==e)return t;t=t.next}return null},O.forEach=function(e,t){var n=this.bottom;while(n){if(e.call(t,n)===!1)return this;n=n.next}return this},O.getElementsByPoint=function(e,t){var n=this.set();return this.forEach(function(r){r.isPointInside(e,t)&&n.push(r)}),n},yn.isPointInside=function(e,t){var n=this.realPath=this.realPath||Lt[this.type](this);return w.isPointInsidePath(n,e,t)},yn.getBBox=function(e){if(this.removed)return{};var t=this._;if(e){if(t.dirty||!t.bboxwt)this.realPath=Lt[this.type](this),t.bboxwt=Rt(this.realPath),t.bboxwt.toString=i,t.dirty=0;return t.bboxwt}if(t.dirty||t.dirtyT||!t.bbox){if(t.dirty||!this.realPath)t.bboxwt=0,this.realPath=Lt[this.type](this);t.bbox=Rt(At(this.realPath,this.matrix)),t.bbox.toString=i,t.dirty=t.dirtyT=0}return t.bbox},yn.clone=function(){if(this.removed)return null;var e=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(e),e},yn.glow=function(e){if(this.type=="text")return null;e=e||{};var t={width:(e.width||10)+(+this.attr("stroke-width")||1),fill:e.fill||!1,opacity:e.opacity||.5,offsetx:e.offsetx||0,offsety:e.offsety||0,color:e.color||"#000"},n=t.width/2,r=this.paper,i=r.set(),s=this.realPath||Lt[this.type](this);s=this.matrix?At(s,this.matrix):s;for(var o=1;o<n+1;o++)i.push(r.path(s).attr({stroke:t.color,fill:t.fill?t.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(t.width/n*o).toFixed(3),opacity:+(t.opacity/n).toFixed(3)}));return i.insertBefore(this).translate(t.offsetx,t.offsety)};var Sn={},xn=function(e,t,n,r,i,s,o,u,a){return a==null?p(e,t,n,r,i,s,o,u):w.findDotsAtSegment(e,t,n,r,i,s,o,u,h(e,t,n,r,i,s,o,u,a))},Tn=function(e,t){return function(n,r,i){n=Qt(n);var s,o,u,a,f="",l={},c,h=0;for(var p=0,d=n.length;p<d;p++){u=n[p];if(u[0]=="M")s=+u[1],o=+u[2];else{a=xn(s,o,u[1],u[2],u[3],u[4],u[5],u[6]);if(h+a>r){if(t&&!l.start){c=xn(s,o,u[1],u[2],u[3],u[4],u[5],u[6],r-h),f+=["C"+c.start.x,c.start.y,c.m.x,c.m.y,c.x,c.y];if(i)return f;l.start=f,f=["M"+c.x,c.y+"C"+c.n.x,c.n.y,c.end.x,c.end.y,u[5],u[6]].join(),h+=a,s=+u[5],o=+u[6];continue}if(!e&&!t)return c=xn(s,o,u[1],u[2],u[3],u[4],u[5],u[6],r-h),{x:c.x,y:c.y,alpha:c.alpha}}h+=a,s=+u[5],o=+u[6]}f+=u.shift()+u}return l.end=f,c=e?h:t?l:w.findDotsAtSegment(s,o,u[0],u[1],u[2],u[3],u[4],u[5],1),c.alpha&&(c={x:c.x,y:c.y,alpha:c.alpha}),c}},Nn=Tn(1),Cn=Tn(),kn=Tn(0,1);w.getTotalLength=Nn,w.getPointAtLength=Cn,w.getSubpath=function(e,t,n){if(this.getTotalLength(e)-n<1e-6)return kn(e,t).end;var r=kn(e,n,1);return t?kn(r,t).end:r},yn.getTotalLength=function(){if(this.type=="path")return this.node.getTotalLength?this.node.getTotalLength():Nn(this.attrs.path)},yn.getPointAtLength=function(e){if(this.type=="path")return Cn(this.attrs.path,e)},yn.getSubpath=function(e,t){if(this.type=="path")return w.getSubpath(this.attrs.path,e,t)};var Ln=w.easing_formulas={linear:function(e){return e},"<":function(e){return V(e,1.7)},">":function(e){return V(e,.48)},"<>":function(e){var t=.48-e/1.04,n=U.sqrt(.1734+t*t),r=n-t,i=V(X(r),1/3)*(r<0?-1:1),s=-n-t,o=V(X(s),1/3)*(s<0?-1:1),u=i+o+.5;return(1-u)*3*u*u+u*u*u},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){e-=1;var t=1.70158;return e*e*((t+1)*e+t)+1},elastic:function(e){return e==!!e?e:V(2,-10*e)*U.sin((e-.075)*2*$/.3)+1},bounce:function(e){var t=7.5625,n=2.75,r;return e<1/n?r=t*e*e:e<2/n?(e-=1.5/n,r=t*e*e+.75):e<2.5/n?(e-=2.25/n,r=t*e*e+.9375):(e-=2.625/n,r=t*e*e+.984375),r}};Ln.easeIn=Ln["ease-in"]=Ln["<"],Ln.easeOut=Ln["ease-out"]=Ln[">"],Ln.easeInOut=Ln["ease-in-out"]=Ln["<>"],Ln["back-in"]=Ln.backIn,Ln["back-out"]=Ln.backOut;var An=[],On=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,16)},Mn=function(){var e=+(new Date),n=0;for(;n<An.length;n++){var r=An[n];if(r.el.removed||r.paused)continue;var i=e-r.start,s=r.ms,o=r.easing,u=r.from,a=r.diff,f=r.to,l=r.t,c=r.el,h={},p,d={},v;r.initstatus?(i=(r.initstatus*r.anim.top-r.prev)/(r.percent-r.prev)*s,r.status=r.initstatus,delete r.initstatus,r.stop&&An.splice(n--,1)):r.status=(r.prev+(r.percent-r.prev)*(i/s))/r.anim.top;if(i<0)continue;if(i<s){var m=o(i/s);for(var g in u)if(u[C](g)){switch(ht[g]){case J:p=+u[g]+m*s*a[g];break;case"colour":p="rgb("+[_n(ot(u[g].r+m*s*a[g].r)),_n(ot(u[g].g+m*s*a[g].g)),_n(ot(u[g].b+m*s*a[g].b))].join(",")+")";break;case"path":p=[];for(var y=0,b=u[g].length;y<b;y++){p[y]=[u[g][y][0]];for(var E=1,S=u[g][y].length;E<S;E++)p[y][E]=+u[g][y][E]+m*s*a[g][y][E];p[y]=p[y].join(B)}p=p.join(B);break;case"transform":if(a[g].real){p=[];for(y=0,b=u[g].length;y<b;y++){p[y]=[u[g][y][0]];for(E=1,S=u[g][y].length;E<S;E++)p[y][E]=u[g][y][E]+m*s*a[g][y][E]}}else{var x=function(e){return+u[g][e]+m*s*a[g][e]};p=[["m",x(0),x(1),x(2),x(3),x(4),x(5)]]}break;case"csv":if(g=="clip-rect"){p=[],y=4;while(y--)p[y]=+u[g][y]+m*s*a[g][y]}break;default:var T=[][D](u[g]);p=[],y=c.paper.customAttributes[g].length;while(y--)p[y]=+T[y]+m*s*a[g][y]}h[g]=p}c.attr(h),function(e,t,n){setTimeout(function(){eve("raphael.anim.frame."+e,t,n)})}(c.id,c,r.anim)}else{(function(e,t,n){setTimeout(function(){eve("raphael.anim.frame."+t.id,t,n),eve("raphael.anim.finish."+t.id,t,n),w.is(e,"function")&&e.call(t)})})(r.callback,c,r.anim),c.attr(f),An.splice(n--,1);if(r.repeat>1&&!r.next){for(v in f)f[C](v)&&(d[v]=r.totalOrigin[v]);r.el.attr(d),t(r.anim,r.el,r.anim.percents[0],null,r.totalOrigin,r.repeat-1)}r.next&&!r.stop&&t(r.anim,r.el,r.next,null,r.totalOrigin,r.repeat)}}w.svg&&c&&c.paper&&c.paper.safari(),An.length&&On(Mn)},_n=function(e){return e>255?255:e<0?0:e};yn.animateWith=function(e,r,i,s,o,u){var a=this;if(a.removed)return u&&u.call(a),a;var f=i instanceof n?i:w.animation(i,s,o,u),l,c;t(f,a,f.percents[0],null,a.attr());for(var h=0,p=An.length;h<p;h++)if(An[h].anim==r&&An[h].el==e){An[p-1].start=An[h].start;break}return a},yn.onAnimation=function(e){return e?eve.on("raphael.anim.frame."+this.id,e):eve.unbind("raphael.anim.frame."+this.id),this},n.prototype.delay=function(e){var t=new n(this.anim,this.ms);return t.times=this.times,t.del=+e||0,t},n.prototype.repeat=function(e){var t=new n(this.anim,this.ms);return t.del=this.del,t.times=U.floor(z(e,0))||1,t},w.animation=function(e,t,r,i){if(e instanceof n)return e;if(w.is(r,"function")||!r)i=i||r||null,r=null;e=Object(e),t=+t||0;var s={},o,u;for(u in e)e[C](u)&&at(u)!=u&&at(u)+"%"!=u&&(o=!0,s[u]=e[u]);return o?(r&&(s.easing=r),i&&(s.callback=i),new n({100:s},t)):new n(e,t)},yn.animate=function(e,r,i,s){var o=this;if(o.removed)return s&&s.call(o),o;var u=e instanceof n?e:w.animation(e,r,i,s);return t(u,o,u.percents[0],null,o.attr()),o},yn.setTime=function(e,t){return e&&t!=null&&this.status(e,W(t,e.ms)/e.ms),this},yn.status=function(e,n){var r=[],i=0,s,o;if(n!=null)return t(e,this,-1,W(n,1)),this;s=An.length;for(;i<s;i++){o=An[i];if(o.el.id==this.id&&(!e||o.anim==e)){if(e)return o.status;r.push({anim:o.anim,status:o.status})}}return e?0:r},yn.pause=function(e){for(var t=0;t<An.length;t++)An[t].el.id==this.id&&(!e||An[t].anim==e)&&eve("raphael.anim.pause."+this.id,this,An[t].anim)!==!1&&(An[t].paused=!0);return this},yn.resume=function(e){for(var t=0;t<An.length;t++)if(An[t].el.id==this.id&&(!e||An[t].anim==e)){var n=An[t];eve("raphael.anim.resume."+this.id,this,n.anim)!==!1&&(delete n.paused,this.status(n.anim,n.status))}return this},yn.stop=function(e){for(var t=0;t<An.length;t++)An[t].el.id==this.id&&(!e||An[t].anim==e)&&eve("raphael.anim.stop."+this.id,this,An[t].anim)!==!1&&An.splice(t--,1);return this},eve.on("raphael.remove",e),eve.on("raphael.clear",e),yn.toString=function(){return"Raphaël’s object"};var Dn=function(e){this.items=[],this.length=0,this.type="set";if(e)for(var t=0,n=e.length;t<n;t++)e[t]&&(e[t].constructor==yn.constructor||e[t].constructor==Dn)&&(this[this.items.length]=this.items[this.items.length]=e[t],this.length++)},Pn=Dn.prototype;Pn.push=function(){var e,t;for(var n=0,r=arguments.length;n<r;n++)e=arguments[n],e&&(e.constructor==yn.constructor||e.constructor==Dn)&&(t=this.items.length,this[t]=this.items[t]=e,this.length++);return this},Pn.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},Pn.forEach=function(e,t){for(var n=0,r=this.items.length;n<r;n++)if(e.call(t,this.items[n],n)===!1)return this;return this};for(var Hn in yn)yn[C](Hn)&&(Pn[Hn]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e][_](n,t)})}}(Hn));Pn.attr=function(e,t){if(e&&w.is(e,Q)&&w.is(e[0],"object"))for(var n=0,r=e.length;n<r;n++)this.items[n].attr(e[n]);else for(var i=0,s=this.items.length;i<s;i++)this.items[i].attr(e,t);return this},Pn.clear=function(){while(this.length)this.pop()},Pn.splice=function(e,t,n){e=e<0?z(this.length+e,0):e,t=z(0,W(this.length-e,t));var r=[],i=[],s=[],o;for(o=2;o<arguments.length;o++)s.push(arguments[o]);for(o=0;o<t;o++)i.push(this[e+o]);for(;o<this.length-e;o++)r.push(this[e+o]);var u=s.length;for(o=0;o<u+r.length;o++)this.items[e+o]=this[e+o]=o<u?s[o]:r[o-u];o=this.items.length=this.length-=t-u;while(this[o])delete this[o++];return new Dn(i)},Pn.exclude=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]==e)return this.splice(t,1),!0},Pn.animate=function(e,t,n,r){(w.is(n,"function")||!n)&&(r=n||null);var i=this.items.length,s=i,o,u=this,a;if(!i)return this;r&&(a=function(){!--i&&r.call(u)}),n=w.is(n,K)?n:a;var f=w.animation(e,t,n,a);o=this.items[--s].animate(f);while(s--)this.items[s]&&!this.items[s].removed&&this.items[s].animateWith(o,f,f);return this},Pn.insertAfter=function(e){var t=this.items.length;while(t--)this.items[t].insertAfter(e);return this},Pn.getBBox=function(){var e=[],t=[],n=[],r=[];for(var i=this.items.length;i--;)if(!this.items[i].removed){var s=this.items[i].getBBox();e.push(s.x),t.push(s.y),n.push(s.x+s.width),r.push(s.y+s.height)}return e=W[_](0,e),t=W[_](0,t),n=z[_](0,n),r=z[_](0,r),{x:e,y:t,x2:n,y2:r,width:n-e,height:r-t}},Pn.clone=function(e){e=new Dn;for(var t=0,n=this.items.length;t<n;t++)e.push(this.items[t].clone());return e},Pn.toString=function(){return"Raphaël‘s set"},w.registerFont=function(e){if(!e.face)return e;this.fonts=this.fonts||{};var t={w:e.w,face:{},glyphs:{}},n=e.face["font-family"];for(var r in e.face)e.face[C](r)&&(t.face[r]=e.face[r]);this.fonts[n]?this.fonts[n].push(t):this.fonts[n]=[t];if(!e.svg){t.face["units-per-em"]=ft(e.face["units-per-em"],10);for(var i in e.glyphs)if(e.glyphs[C](i)){var s=e.glyphs[i];t.glyphs[i]={w:s.w,k:{},d:s.d&&"M"+s.d.replace(/[mlcxtrv]/g,function(e){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[e]||"M"})+"z"};if(s.k)for(var o in s.k)s[C](o)&&(t.glyphs[i].k[o]=s.k[o])}}return e},O.getFont=function(e,t,n,r){r=r||"normal",n=n||"normal",t=+t||{normal:400,bold:700,lighter:300,bolder:800}[t]||400;if(!!w.fonts){var i=w.fonts[e];if(!i){var s=new RegExp("(^|\\s)"+e.replace(/[^\w\d\s+!~.:_-]/g,H)+"(\\s|$)","i");for(var o in w.fonts)if(w.fonts[C](o)&&s.test(o)){i=w.fonts[o];break}}var u;if(i)for(var a=0,f=i.length;a<f;a++){u=i[a];if(u.face["font-weight"]==t&&(u.face["font-style"]==n||!u.face["font-style"])&&u.face["font-stretch"]==r)break}return u}},O.print=function(e,t,n,r,i,s,o){s=s||"middle",o=z(W(o||0,1),-1);var u=j(n)[F](H),a=0,f=0,l=H,c;w.is(r,n)&&(r=this.getFont(r));if(r){c=(i||16)/r.face["units-per-em"];var h=r.face.bbox[F](S),p=+h[0],d=h[3]-h[1],v=0,m=+h[1]+(s=="baseline"?d+ +r.face.descent:d/2);for(var g=0,y=u.length;g<y;g++){if(u[g]=="\n")a=0,E=0,f=0,v+=d;else{var b=f&&r.glyphs[u[g-1]]||{},E=r.glyphs[u[g]];a+=f?(b.w||r.w)+(b.k&&b.k[u[g]]||0)+r.w*o:0,f=1}E&&E.d&&(l+=w.transformPath(E.d,["t",a*c,v*c,"s",c,c,p,m,"t",(e-p)/c,(t-m)/c]))}}return this.path(l).attr({fill:"#000",stroke:"none"})},O.add=function(e){if(w.is(e,"array")){var t=this.set(),n=0,r=e.length,i;for(;n<r;n++)i=e[n]||{},x[C](i.type)&&t.push(this[i.type]().attr(i))}return t},w.format=function(e,t){var n=w.is(t,Q)?[0][D](t):arguments;return e&&w.is(e,K)&&n.length-1&&(e=e.replace(T,function(e,t){return n[++t]==null?H:n[t]})),e||H},w.fullfill=function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r){var i=r;return n.replace(t,function(e,t,n,r,s){t=t||r,i&&(t in i&&(i=i[t]),typeof i=="function"&&s&&(i=i()))}),i=(i==null||i==r?e:i)+"",i};return function(t,r){return String(t).replace(e,function(e,t){return n(e,t,r)})}}(),w.ninja=function(){return L.was?k.win.Raphael=L.is:delete Raphael,w},w.st=Pn,function(e,t,n){function r(){/in/.test(e.readyState)?setTimeout(r,9):w.eve("raphael.DOMload")}e.readyState==null&&e.addEventListener&&(e.addEventListener(t,n=function(){e.removeEventListener(t,n,!1),e.readyState="complete"},!1),e.readyState="loading"),r()}(document,"DOMContentLoaded"),L.was?k.win.Raphael=w:Raphael=w,eve.on("raphael.DOMload",function(){E=!0})}(),window.Raphael.svg&&function(e){var t="hasOwnProperty",n=String,r=parseFloat,i=parseInt,s=Math,o=s.max,u=s.abs,a=s.pow,f=/[, ]+/,l=e.eve,c="",h=" ",p="http://www.w3.org/1999/xlink",d={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},v={};e.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var m=function(r,i){if(i){typeof r=="string"&&(r=m(r));for(var s in i)i[t](s)&&(s.substring(0,6)=="xlink:"?r.setAttributeNS(p,s.substring(6),n(i[s])):r.setAttribute(s,n(i[s])))}else r=e._g.doc.createElementNS("http://www.w3.org/2000/svg",r),r.style&&(r.style.webkitTapHighlightColor="rgba(0,0,0,0)");return r},g=function(t,i){var f="linear",l=t.id+i,h=.5,p=.5,d=t.node,v=t.paper,g=d.style,y=e._g.doc.getElementById(l);if(!y){i=n(i).replace(e._radial_gradient,function(e,t,n){f="radial";if(t&&n){h=r(t),p=r(n);var i=(p>.5)*2-1;a(h-.5,2)+a(p-.5,2)>.25&&(p=s.sqrt(.25-a(h-.5,2))*i+.5)&&p!=.5&&(p=p.toFixed(5)-1e-5*i)}return c}),i=i.split(/\s*\-\s*/);if(f=="linear"){var b=i.shift();b=-r(b);if(isNaN(b))return null;var w=[0,0,s.cos(e.rad(b)),s.sin(e.rad(b))],E=1/(o(u(w[2]),u(w[3]))||1);w[2]*=E,w[3]*=E,w[2]<0&&(w[0]=-w[2],w[2]=0),w[3]<0&&(w[1]=-w[3],w[3]=0)}var S=e._parseDots(i);if(!S)return null;l=l.replace(/[\(\)\s,\xb0#]/g,"_"),t.gradient&&l!=t.gradient.id&&(v.defs.removeChild(t.gradient),delete t.gradient);if(!t.gradient){y=m(f+"Gradient",{id:l}),t.gradient=y,m(y,f=="radial"?{fx:h,fy:p}:{x1:w[0],y1:w[1],x2:w[2],y2:w[3],gradientTransform:t.matrix.invert()}),v.defs.appendChild(y);for(var x=0,T=S.length;x<T;x++)y.appendChild(m("stop",{offset:S[x].offset?S[x].offset:x?"100%":"0%","stop-color":S[x].color||"#fff"}))}}return m(d,{fill:"url(#"+l+")",opacity:1,"fill-opacity":1}),g.fill=c,g.opacity=1,g.fillOpacity=1,1},y=function(e){var t=e.getBBox(1);m(e.pattern,{patternTransform:e.matrix.invert()+" translate("+t.x+","+t.y+")"})},b=function(r,i,s){if(r.type=="path"){var o=n(i).toLowerCase().split("-"),u=r.paper,a=s?"end":"start",f=r.node,l=r.attrs,h=l["stroke-width"],p=o.length,g="classic",y,b,w,E,S,x=3,T=3,N=5;while(p--)switch(o[p]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":g=o[p];break;case"wide":T=5;break;case"narrow":T=2;break;case"long":x=5;break;case"short":x=2}g=="open"?(x+=2,T+=2,N+=2,w=1,E=s?4:1,S={fill:"none",stroke:l.stroke}):(E=w=x/2,S={fill:l.stroke,stroke:"none"}),r._.arrows?s?(r._.arrows.endPath&&v[r._.arrows.endPath]--,r._.arrows.endMarker&&v[r._.arrows.endMarker]--):(r._.arrows.startPath&&v[r._.arrows.startPath]--,r._.arrows.startMarker&&v[r._.arrows.startMarker]--):r._.arrows={};if(g!="none"){var C="raphael-marker-"+g,k="raphael-marker-"+a+g+x+T;e._g.doc.getElementById(C)?v[C]++:(u.defs.appendChild(m(m("path"),{"stroke-linecap":"round",d:d[g],id:C})),v[C]=1);var L=e._g.doc.getElementById(k),A;L?(v[k]++,A=L.getElementsByTagName("use")[0]):(L=m(m("marker"),{id:k,markerHeight:T,markerWidth:x,orient:"auto",refX:E,refY:T/2}),A=m(m("use"),{"xlink:href":"#"+C,transform:(s?"rotate(180 "+x/2+" "+T/2+") ":c)+"scale("+x/N+","+T/N+")","stroke-width":(1/((x/N+T/N)/2)).toFixed(4)}),L.appendChild(A),u.defs.appendChild(L),v[k]=1),m(A,S);var O=w*(g!="diamond"&&g!="oval");s?(y=r._.arrows.startdx*h||0,b=e.getTotalLength(l.path)-O*h):(y=O*h,b=e.getTotalLength(l.path)-(r._.arrows.enddx*h||0)),S={},S["marker-"+a]="url(#"+k+")";if(b||y)S.d=Raphael.getSubpath(l.path,y,b);m(f,S),r._.arrows[a+"Path"]=C,r._.arrows[a+"Marker"]=k,r._.arrows[a+"dx"]=O,r._.arrows[a+"Type"]=g,r._.arrows[a+"String"]=i}else s?(y=r._.arrows.startdx*h||0,b=e.getTotalLength(l.path)-y):(y=0,b=e.getTotalLength(l.path)-(r._.arrows.enddx*h||0)),r._.arrows[a+"Path"]&&m(f,{d:Raphael.getSubpath(l.path,y,b)}),delete r._.arrows[a+"Path"],delete r._.arrows[a+"Marker"],delete r._.arrows[a+"dx"],delete r._.arrows[a+"Type"],delete r._.arrows[a+"String"];for(S in v)if(v[t](S)&&!v[S]){var M=e._g.doc.getElementById(S);M&&M.parentNode.removeChild(M)}}},w={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},E=function(e,t,r){t=w[n(t).toLowerCase()];if(t){var i=e.attrs["stroke-width"]||"1",s={round:i,square:i,butt:0}[e.attrs["stroke-linecap"]||r["stroke-linecap"]]||0,o=[],u=t.length;while(u--)o[u]=t[u]*i+(u%2?1:-1)*s;m(e.node,{"stroke-dasharray":o.join(",")})}},S=function(r,s){var a=r.node,l=r.attrs,h=a.style.visibility;a.style.visibility="hidden";for(var d in s)if(s[t](d)){if(!e._availableAttrs[t](d))continue;var v=s[d];l[d]=v;switch(d){case"blur":r.blur(v);break;case"href":case"title":case"target":var w=a.parentNode;if(w.tagName.toLowerCase()!="a"){var S=m("a");w.insertBefore(S,a),S.appendChild(a),w=S}d=="target"?w.setAttributeNS(p,"show",v=="blank"?"new":v):w.setAttributeNS(p,d,v);break;case"cursor":a.style.cursor=v;break;case"transform":r.transform(v);break;case"arrow-start":b(r,v);break;case"arrow-end":b(r,v,1);break;case"clip-rect":var x=n(v).split(f);if(x.length==4){r.clip&&r.clip.parentNode.parentNode.removeChild(r.clip.parentNode);var N=m("clipPath"),C=m("rect");N.id=e.createUUID(),m(C,{x:x[0],y:x[1],width:x[2],height:x[3]}),N.appendChild(C),r.paper.defs.appendChild(N),m(a,{"clip-path":"url(#"+N.id+")"}),r.clip=C}if(!v){var k=a.getAttribute("clip-path");if(k){var L=e._g.doc.getElementById(k.replace(/(^url\(#|\)$)/g,c));L&&L.parentNode.removeChild(L),m(a,{"clip-path":c}),delete r.clip}}break;case"path":r.type=="path"&&(m(a,{d:v?l.path=e._pathToAbsolute(v):"M0,0"}),r._.dirty=1,r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1)));break;case"width":a.setAttribute(d,v),r._.dirty=1;if(!l.fx)break;d="x",v=l.x;case"x":l.fx&&(v=-l.x-(l.width||0));case"rx":if(d=="rx"&&r.type=="rect")break;case"cx":a.setAttribute(d,v),r.pattern&&y(r),r._.dirty=1;break;case"height":a.setAttribute(d,v),r._.dirty=1;if(!l.fy)break;d="y",v=l.y;case"y":l.fy&&(v=-l.y-(l.height||0));case"ry":if(d=="ry"&&r.type=="rect")break;case"cy":a.setAttribute(d,v),r.pattern&&y(r),r._.dirty=1;break;case"r":r.type=="rect"?m(a,{rx:v,ry:v}):a.setAttribute(d,v),r._.dirty=1;break;case"src":r.type=="image"&&a.setAttributeNS(p,"href",v);break;case"stroke-width":if(r._.sx!=1||r._.sy!=1)v/=o(u(r._.sx),u(r._.sy))||1;r.paper._vbSize&&(v*=r.paper._vbSize),a.setAttribute(d,v),l["stroke-dasharray"]&&E(r,l["stroke-dasharray"],s),r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1));break;case"stroke-dasharray":E(r,v,s);break;case"fill":var A=n(v).match(e._ISURL);if(A){N=m("pattern");var O=m("image");N.id=e.createUUID(),m(N,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),m(O,{x:0,y:0,"xlink:href":A[1]}),N.appendChild(O),function(t){e._preload(A[1],function(){var e=this.offsetWidth,n=this.offsetHeight;m(t,{width:e,height:n}),m(O,{width:e,height:n}),r.paper.safari()})}(N),r.paper.defs.appendChild(N),m(a,{fill:"url(#"+N.id+")"}),r.pattern=N,r.pattern&&y(r);break}var M=e.getRGB(v);if(!M.error)delete s.gradient,delete l.gradient,!e.is(l.opacity,"undefined")&&e.is(s.opacity,"undefined")&&m(a,{opacity:l.opacity}),!e.is(l["fill-opacity"],"undefined")&&e.is(s["fill-opacity"],"undefined")&&m(a,{"fill-opacity":l["fill-opacity"]});else if((r.type=="circle"||r.type=="ellipse"||n(v).charAt()!="r")&&g(r,v)){if("opacity"in l||"fill-opacity"in l){var _=e._g.doc.getElementById(a.getAttribute("fill").replace(/^url\(#|\)$/g,c));if(_){var D=_.getElementsByTagName("stop");m(D[D.length-1],{"stop-opacity":("opacity"in l?l.opacity:1)*("fill-opacity"in l?l["fill-opacity"]:1)})}}l.gradient=v,l.fill="none";break}M[t]("opacity")&&m(a,{"fill-opacity":M.opacity>1?M.opacity/100:M.opacity});case"stroke":M=e.getRGB(v),a.setAttribute(d,M.hex),d=="stroke"&&M[t]("opacity")&&m(a,{"stroke-opacity":M.opacity>1?M.opacity/100:M.opacity}),d=="stroke"&&r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1));break;case"gradient":(r.type=="circle"||r.type=="ellipse"||n(v).charAt()!="r")&&g(r,v);break;case"opacity":l.gradient&&!l[t]("stroke-opacity")&&m(a,{"stroke-opacity":v>1?v/100:v});case"fill-opacity":if(l.gradient){_=e._g.doc.getElementById(a.getAttribute("fill").replace(/^url\(#|\)$/g,c)),_&&(D=_.getElementsByTagName("stop"),m(D[D.length-1],{"stop-opacity":v}));break};default:d=="font-size"&&(v=i(v,10)+"px");var P=d.replace(/(\-.)/g,function(e){return e.substring(1).toUpperCase()});a.style[P]=v,r._.dirty=1,a.setAttribute(d,v)}}T(r,s),a.style.visibility=h},x=1.2,T=function(r,s){if(r.type=="text"&&!!(s[t]("text")||s[t]("font")||s[t]("font-size")||s[t]("x")||s[t]("y"))){var o=r.attrs,u=r.node,a=u.firstChild?i(e._g.doc.defaultView.getComputedStyle(u.firstChild,c).getPropertyValue("font-size"),10):10;if(s[t]("text")){o.text=s.text;while(u.firstChild)u.removeChild(u.firstChild);var f=n(s.text).split("\n"),l=[],h;for(var p=0,d=f.length;p<d;p++)h=m("tspan"),p&&m(h,{dy:a*x,x:o.x}),h.appendChild(e._g.doc.createTextNode(f[p])),u.appendChild(h),l[p]=h}else{l=u.getElementsByTagName("tspan");for(p=0,d=l.length;p<d;p++)p?m(l[p],{dy:a*x,x:o.x}):m(l[0],{dy:0})}m(u,{x:o.x,y:o.y}),r._.dirty=1;var v=r._getBBox(),g=o.y-(v.y+v.height/2);g&&e.is(g,"finite")&&m(l[0],{dy:g})}},N=function(t,n){var r=0,i=0;this[0]=this.node=t,t.raphael=!0,this.id=e._oid++,t.raphaelid=this.id,this.matrix=e.matrix(),this.realPath=null,this.paper=n,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},C=e.el;N.prototype=C,C.constructor=N,e._engine.path=function(e,t){var n=m("path");t.canvas&&t.canvas.appendChild(n);var r=new N(n,t);return r.type="path",S(r,{fill:"none",stroke:"#000",path:e}),r},C.rotate=function(e,t,i){if(this.removed)return this;e=n(e).split(f),e.length-1&&(t=r(e[1]),i=r(e[2])),e=r(e[0]),i==null&&(t=i);if(t==null||i==null){var s=this.getBBox(1);t=s.x+s.width/2,i=s.y+s.height/2}return this.transform(this._.transform.concat([["r",e,t,i]])),this},C.scale=function(e,t,i,s){if(this.removed)return this;e=n(e).split(f),e.length-1&&(t=r(e[1]),i=r(e[2]),s=r(e[3])),e=r(e[0]),t==null&&(t=e),s==null&&(i=s);if(i==null||s==null)var o=this.getBBox(1);return i=i==null?o.x+o.width/2:i,s=s==null?o.y+o.height/2:s,this.transform(this._.transform.concat([["s",e,t,i,s]])),this},C.translate=function(e,t){return this.removed?this:(e=n(e).split(f),e.length-1&&(t=r(e[1])),e=r(e[0])||0,t=+t||0,this.transform(this._.transform.concat([["t",e,t]])),this)},C.transform=function(n){var r=this._;if(n==null)return r.transform;e._extractTransform(this,n),this.clip&&m(this.clip,{transform:this.matrix.invert()}),this.pattern&&y(this),this.node&&m(this.node,{transform:this.matrix});if(r.sx!=1||r.sy!=1){var i=this.attrs[t]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":i})}return this},C.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},C.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},C.remove=function(){if(!this.removed&&!!this.node.parentNode){var t=this.paper;t.__set__&&t.__set__.exclude(this),l.unbind("raphael.*.*."+this.id),this.gradient&&t.defs.removeChild(this.gradient),e._tear(this,t),this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var n in this)this[n]=typeof this[n]=="function"?e._removedFactory(n):null;this.removed=!0}},C._getBBox=function(){if(this.node.style.display=="none"){this.show();var e=!0}var t={};try{t=this.node.getBBox()}catch(n){}finally{t=t||{}}return e&&this.hide(),t},C.attr=function(n,r){if(this.removed)return this;if(n==null){var i={};for(var s in this.attrs)this.attrs[t](s)&&(i[s]=this.attrs[s]);return i.gradient&&i.fill=="none"&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(r==null&&e.is(n,"string")){if(n=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;if(n=="transform")return this._.transform;var o=n.split(f),u={};for(var a=0,c=o.length;a<c;a++)n=o[a],n in this.attrs?u[n]=this.attrs[n]:e.is(this.paper.customAttributes[n],"function")?u[n]=this.paper.customAttributes[n].def:u[n]=e._availableAttrs[n];return c-1?u:u[o[0]]}if(r==null&&e.is(n,"array")){u={};for(a=0,c=n.length;a<c;a++)u[n[a]]=this.attr(n[a]);return u}if(r!=null){var h={};h[n]=r}else n!=null&&e.is(n,"object")&&(h=n);for(var p in h)l("raphael.attr."+p+"."+this.id,this,h[p]);for(p in this.paper.customAttributes)if(this.paper.customAttributes[t](p)&&h[t](p)&&e.is(this.paper.customAttributes[p],"function")){var d=this.paper.customAttributes[p].apply(this,[].concat(h[p]));this.attrs[p]=h[p];for(var v in d)d[t](v)&&(h[v]=d[v])}return S(this,h),this},C.toFront=function(){if(this.removed)return this;this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var t=this.paper;return t.top!=this&&e._tofront(this,t),this},C.toBack=function(){if(this.removed)return this;var t=this.node.parentNode;t.tagName.toLowerCase()=="a"?t.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):t.firstChild!=this.node&&t.insertBefore(this.node,this.node.parentNode.firstChild),e._toback(this,this.paper);var n=this.paper;return this},C.insertAfter=function(t){if(this.removed)return this;var n=t.node||t[t.length-1].node;return n.nextSibling?n.parentNode.insertBefore(this.node,n.nextSibling):n.parentNode.appendChild(this.node),e._insertafter(this,t,this.paper),this},C.insertBefore=function(t){if(this.removed)return this;var n=t.node||t[0].node;return n.parentNode.insertBefore(this.node,n),e._insertbefore(this,t,this.paper),this},C.blur=function(t){var n=this;if(+t!==0){var r=m("filter"),i=m("feGaussianBlur");n.attrs.blur=t,r.id=e.createUUID(),m(i,{stdDeviation:+t||1.5}),r.appendChild(i),n.paper.defs.appendChild(r),n._blur=r,m(n.node,{filter:"url(#"+r.id+")"})}else n._blur&&(n._blur.parentNode.removeChild(n._blur),delete n._blur,delete n.attrs.blur),n.node.removeAttribute("filter")},e._engine.circle=function(e,t,n,r){var i=m("circle");e.canvas&&e.canvas.appendChild(i);var s=new N(i,e);return s.attrs={cx:t,cy:n,r:r,fill:"none",stroke:"#000"},s.type="circle",m(i,s.attrs),s},e._engine.rect=function(e,t,n,r,i,s){var o=m("rect");e.canvas&&e.canvas.appendChild(o);var u=new N(o,e);return u.attrs={x:t,y:n,width:r,height:i,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},u.type="rect",m(o,u.attrs),u},e._engine.ellipse=function(e,t,n,r,i){var s=m("ellipse");e.canvas&&e.canvas.appendChild(s);var o=new N(s,e);return o.attrs={cx:t,cy:n,rx:r,ry:i,fill:"none",stroke:"#000"},o.type="ellipse",m(s,o.attrs),o},e._engine.image=function(e,t,n,r,i,s){var o=m("image");m(o,{x:n,y:r,width:i,height:s,preserveAspectRatio:"none"}),o.setAttributeNS(p,"href",t),e.canvas&&e.canvas.appendChild(o);var u=new N(o,e);return u.attrs={x:n,y:r,width:i,height:s,src:t},u.type="image",u},e._engine.text=function(t,n,r,i){var s=m("text");t.canvas&&t.canvas.appendChild(s);var o=new N(s,t);return o.attrs={x:n,y:r,"text-anchor":"middle",text:i,font:e._availableAttrs.font,stroke:"none",fill:"#000"},o.type="text",S(o,o.attrs),o},e._engine.setSize=function(e,t){return this.width=e||this.width,this.height=t||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},e._engine.create=function(){var t=e._getContainer.apply(0,arguments),n=t&&t.container,r=t.x,i=t.y,s=t.width,o=t.height;if(!n)throw new Error("SVG container not found.");var u=m("svg"),a="overflow:hidden;",f;return r=r||0,i=i||0,s=s||512,o=o||342,m(u,{height:o,version:1.1,width:s,xmlns:"http://www.w3.org/2000/svg"}),n==1?(u.style.cssText=a+"position:absolute;left:"+r+"px;top:"+i+"px",e._g.doc.body.appendChild(u),f=1):(u.style.cssText=a+"position:relative",n.firstChild?n.insertBefore(u,n.firstChild):n.appendChild(u)),n=new e._Paper,n.width=s,n.height=o,n.canvas=u,n.clear(),n._left=n._top=0,f&&(n.renderfix=function(){}),n.renderfix(),n},e._engine.setViewBox=function(e,t,n,r,i){l("raphael.setViewBox",this,this._viewBox,[e,t,n,r,i]);var s=o(n/this.width,r/this.height),u=this.top,a=i?"meet":"xMinYMin",f,c;e==null?(this._vbSize&&(s=1),delete this._vbSize,f="0 0 "+this.width+h+this.height):(this._vbSize=s,f=e+h+t+h+n+h+r),m(this.canvas,{viewBox:f,preserveAspectRatio:a});while(s&&u)c="stroke-width"in u.attrs?u.attrs["stroke-width"]:1,u.attr({"stroke-width":c}),u._.dirty=1,u._.dirtyT=1,u=u.prev;return this._viewBox=[e,t,n,r,!!i],this},e.prototype.renderfix=function(){var e=this.canvas,t=e.style,n;try{n=e.getScreenCTM()||e.createSVGMatrix()}catch(r){n=e.createSVGMatrix()}var i=-n.e%1,s=-n.f%1;if(i||s)i&&(this._left=(this._left+i)%1,t.left=this._left+"px"),s&&(this._top=(this._top+s)%1,t.top=this._top+"px")},e.prototype.clear=function(){e.eve("raphael.clear",this);var t=this.canvas;while(t.firstChild)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=m("desc")).appendChild(e._g.doc.createTextNode("Created with Raphaël "+e.version)),t.appendChild(this.desc),t.appendChild(this.defs=m("defs"))},e.prototype.remove=function(){l("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=typeof this[t]=="function"?e._removedFactory(t):null};var k=e.st;for(var L in C)C[t](L)&&!k[t](L)&&(k[L]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e].apply(n,t)})}}(L))}(window.Raphael),window.Raphael.vml&&function(e){var t="hasOwnProperty",n=String,r=parseFloat,i=Math,s=i.round,o=i.max,u=i.min,a=i.abs,f="fill",l=/[, ]+/,c=e.eve,h=" progid:DXImageTransform.Microsoft",p=" ",d="",v={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,g=/ progid:\S+Blur\([^\)]+\)/g,y=/-?[^,\s-]+/g,b="position:absolute;left:0;top:0;width:1px;height:1px",w=21600,E={path:1,rect:1,image:1},S={circle:1,ellipse:1},x=function(t){var r=/[ahqstv]/ig,i=e._pathToAbsolute;n(t).match(r)&&(i=e._path2curve),r=/[clmz]/g;if(i==e._pathToAbsolute&&!n(t).match(r)){var o=n(t).replace(m,function(e,t,n){var r=[],i=t.toLowerCase()=="m",o=v[t];return n.replace(y,function(e){i&&r.length==2&&(o+=r+v[t=="m"?"l":"L"],r=[]),r.push(s(e*w))}),o+r});return o}var u=i(t),a,f;o=[];for(var l=0,c=u.length;l<c;l++){a=u[l],f=u[l][0].toLowerCase(),f=="z"&&(f="x");for(var h=1,g=a.length;h<g;h++)f+=s(a[h]*w)+(h!=g-1?",":d);o.push(f)}return o.join(p)},T=function(t,n,r){var i=e.matrix();return i.rotate(-t,.5,.5),{dx:i.x(n,r),dy:i.y(n,r)}},N=function(e,t,n,r,i,s){var o=e._,u=e.matrix,l=o.fillpos,c=e.node,h=c.style,d=1,v="",m,g=w/t,y=w/n;h.visibility="hidden";if(!!t&&!!n){c.coordsize=a(g)+p+a(y),h.rotation=s*(t*n<0?-1:1);if(s){var b=T(s,r,i);r=b.dx,i=b.dy}t<0&&(v+="x"),n<0&&(v+=" y")&&(d=-1),h.flip=v,c.coordorigin=r*-g+p+i*-y;if(l||o.fillsize){var E=c.getElementsByTagName(f);E=E&&E[0],c.removeChild(E),l&&(b=T(s,u.x(l[0],l[1]),u.y(l[0],l[1])),E.position=b.dx*d+p+b.dy*d),o.fillsize&&(E.size=o.fillsize[0]*a(t)+p+o.fillsize[1]*a(n)),c.appendChild(E)}h.visibility="visible"}};e.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var C=function(e,t,r){var i=n(t).toLowerCase().split("-"),s=r?"end":"start",o=i.length,u="classic",a="medium",f="medium";while(o--)switch(i[o]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":u=i[o];break;case"wide":case"narrow":f=i[o];break;case"long":case"short":a=i[o]}var l=e.node.getElementsByTagName("stroke")[0];l[s+"arrow"]=u,l[s+"arrowlength"]=a,l[s+"arrowwidth"]=f},k=function(i,a){i.attrs=i.attrs||{};var c=i.node,h=i.attrs,v=c.style,m,g=E[i.type]&&(a.x!=h.x||a.y!=h.y||a.width!=h.width||a.height!=h.height||a.cx!=h.cx||a.cy!=h.cy||a.rx!=h.rx||a.ry!=h.ry||a.r!=h.r),y=S[i.type]&&(h.cx!=a.cx||h.cy!=a.cy||h.r!=a.r||h.rx!=a.rx||h.ry!=a.ry),b=i;for(var T in a)a[t](T)&&(h[T]=a[T]);g&&(h.path=e._getPath[i.type](i),i._.dirty=1),a.href&&(c.href=a.href),a.title&&(c.title=a.title),a.target&&(c.target=a.target),a.cursor&&(v.cursor=a.cursor),"blur"in a&&i.blur(a.blur);if(a.path&&i.type=="path"||g)c.path=x(~n(h.path).toLowerCase().indexOf("r")?e._pathToAbsolute(h.path):h.path),i.type=="image"&&(i._.fillpos=[h.x,h.y],i._.fillsize=[h.width,h.height],N(i,1,1,0,0,0));"transform"in a&&i.transform(a.transform);if(y){var k=+h.cx,A=+h.cy,O=+h.rx||+h.r||0,_=+h.ry||+h.r||0;c.path=e.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",s((k-O)*w),s((A-_)*w),s((k+O)*w),s((A+_)*w),s(k*w))}if("clip-rect"in a){var D=n(a["clip-rect"]).split(l);if(D.length==4){D[2]=+D[2]+ +D[0],D[3]=+D[3]+ +D[1];var P=c.clipRect||e._g.doc.createElement("div"),H=P.style;H.clip=e.format("rect({1}px {2}px {3}px {0}px)",D),c.clipRect||(H.position="absolute",H.top=0,H.left=0,H.width=i.paper.width+"px",H.height=i.paper.height+"px",c.parentNode.insertBefore(P,c),P.appendChild(c),c.clipRect=P)}a["clip-rect"]||c.clipRect&&(c.clipRect.style.clip="auto")}if(i.textpath){var B=i.textpath.style;a.font&&(B.font=a.font),a["font-family"]&&(B.fontFamily='"'+a["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,d)+'"'),a["font-size"]&&(B.fontSize=a["font-size"]),a["font-weight"]&&(B.fontWeight=a["font-weight"]),a["font-style"]&&(B.fontStyle=a["font-style"])}"arrow-start"in a&&C(b,a["arrow-start"]),"arrow-end"in a&&C(b,a["arrow-end"],1);if(a.opacity!=null||a["stroke-width"]!=null||a.fill!=null||a.src!=null||a.stroke!=null||a["stroke-width"]!=null||a["stroke-opacity"]!=null||a["fill-opacity"]!=null||a["stroke-dasharray"]!=null||a["stroke-miterlimit"]!=null||a["stroke-linejoin"]!=null||a["stroke-linecap"]!=null){var I=c.getElementsByTagName(f),q=!1;I=I&&I[0],!I&&(q=I=M(f)),i.type=="image"&&a.src&&(I.src=a.src),a.fill&&(I.on=!0);if(I.on==null||a.fill=="none"||a.fill===null)I.on=!1;if(I.on&&a.fill){var R=n(a.fill).match(e._ISURL);if(R){I.parentNode==c&&c.removeChild(I),I.rotate=!0,I.src=R[1],I.type="tile";var U=i.getBBox(1);I.position=U.x+p+U.y,i._.fillpos=[U.x,U.y],e._preload(R[1],function(){i._.fillsize=[this.offsetWidth,this.offsetHeight]})}else I.color=e.getRGB(a.fill).hex,I.src=d,I.type="solid",e.getRGB(a.fill).error&&(b.type in{circle:1,ellipse:1}||n(a.fill).charAt()!="r")&&L(b,a.fill,I)&&(h.fill="none",h.gradient=a.fill,I.rotate=!1)}if("fill-opacity"in a||"opacity"in a){var W=((+h["fill-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+e.getRGB(a.fill).o+1||2)-1);W=u(o(W,0),1),I.opacity=W,I.src&&(I.color="none")}c.appendChild(I);var X=c.getElementsByTagName("stroke")&&c.getElementsByTagName("stroke")[0],V=!1;!X&&(V=X=M("stroke"));if(a.stroke&&a.stroke!="none"||a["stroke-width"]||a["stroke-opacity"]!=null||a["stroke-dasharray"]||a["stroke-miterlimit"]||a["stroke-linejoin"]||a["stroke-linecap"])X.on=!0;(a.stroke=="none"||a.stroke===null||X.on==null||a.stroke==0||a["stroke-width"]==0)&&(X.on=!1);var $=e.getRGB(a.stroke);X.on&&a.stroke&&(X.color=$.hex),W=((+h["stroke-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+$.o+1||2)-1);var J=(r(a["stroke-width"])||1)*.75;W=u(o(W,0),1),a["stroke-width"]==null&&(J=h["stroke-width"]),a["stroke-width"]&&(X.weight=J),J&&J<1&&(W*=J)&&(X.weight=1),X.opacity=W,a["stroke-linejoin"]&&(X.joinstyle=a["stroke-linejoin"]||"miter"),X.miterlimit=a["stroke-miterlimit"]||8,a["stroke-linecap"]&&(X.endcap=a["stroke-linecap"]=="butt"?"flat":a["stroke-linecap"]=="square"?"square":"round");if(a["stroke-dasharray"]){var K={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};X.dashstyle=K[t](a["stroke-dasharray"])?K[a["stroke-dasharray"]]:d}V&&c.appendChild(X)}if(b.type=="text"){b.paper.canvas.style.display=d;var Q=b.paper.span,G=100,Y=h.font&&h.font.match(/\d+(?:\.\d*)?(?=px)/);v=Q.style,h.font&&(v.font=h.font),h["font-family"]&&(v.fontFamily=h["font-family"]),h["font-weight"]&&(v.fontWeight=h["font-weight"]),h["font-style"]&&(v.fontStyle=h["font-style"]),Y=r(h["font-size"]||Y&&Y[0])||10,v.fontSize=Y*G+"px",b.textpath.string&&(Q.innerHTML=n(b.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var Z=Q.getBoundingClientRect();b.W=h.w=(Z.right-Z.left)/G,b.H=h.h=(Z.bottom-Z.top)/G,b.X=h.x,b.Y=h.y+b.H/2,("x"in a||"y"in a)&&(b.path.v=e.format("m{0},{1}l{2},{1}",s(h.x*w),s(h.y*w),s(h.x*w)+1));var et=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var tt=0,nt=et.length;tt<nt;tt++)if(et[tt]in a){b._.dirty=1;break}switch(h["text-anchor"]){case"start":b.textpath.style["v-text-align"]="left",b.bbx=b.W/2;break;case"end":b.textpath.style["v-text-align"]="right",b.bbx=-b.W/2;break;default:b.textpath.style["v-text-align"]="center",b.bbx=0}b.textpath.style["v-text-kern"]=!0}},L=function(t,s,o){t.attrs=t.attrs||{};var u=t.attrs,a=Math.pow,f,l,c="linear",h=".5 .5";t.attrs.gradient=s,s=n(s).replace(e._radial_gradient,function(e,t,n){return c="radial",t&&n&&(t=r(t),n=r(n),a(t-.5,2)+a(n-.5,2)>.25&&(n=i.sqrt(.25-a(t-.5,2))*((n>.5)*2-1)+.5),h=t+p+n),d}),s=s.split(/\s*\-\s*/);if(c=="linear"){var v=s.shift();v=-r(v);if(isNaN(v))return null}var m=e._parseDots(s);if(!m)return null;t=t.shape||t.node;if(m.length){t.removeChild(o),o.on=!0,o.method="none",o.color=m[0].color,o.color2=m[m.length-1].color;var g=[];for(var y=0,b=m.length;y<b;y++)m[y].offset&&g.push(m[y].offset+p+m[y].color);o.colors=g.length?g.join():"0% "+o.color,c=="radial"?(o.type="gradientTitle",o.focus="100%",o.focussize="0 0",o.focusposition=h,o.angle=0):(o.type="gradient",o.angle=(270-v)%360),t.appendChild(o)}return 1},A=function(t,n){this[0]=this.node=t,t.raphael=!0,this.id=e._oid++,t.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=n,this.matrix=e.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},O=e.el;A.prototype=O,O.constructor=A,O.transform=function(t){if(t==null)return this._.transform;var r=this.paper._viewBoxShift,i=r?"s"+[r.scale,r.scale]+"-1-1t"+[r.dx,r.dy]:d,s;r&&(s=t=n(t).replace(/\.{3}|\u2026/g,this._.transform||d)),e._extractTransform(this,i+t);var o=this.matrix.clone(),u=this.skew,a=this.node,f,l=~n(this.attrs.fill).indexOf("-"),c=!n(this.attrs.fill).indexOf("url(");o.translate(-0.5,-0.5);if(c||l||this.type=="image"){u.matrix="1 0 0 1",u.offset="0 0",f=o.split();if(l&&f.noRotation||!f.isSimple){a.style.filter=o.toFilter();var h=this.getBBox(),v=this.getBBox(1),m=h.x-v.x,g=h.y-v.y;a.coordorigin=m*-w+p+g*-w,N(this,1,1,m,g,0)}else a.style.filter=d,N(this,f.scalex,f.scaley,f.dx,f.dy,f.rotate)}else a.style.filter=d,u.matrix=n(o),u.offset=o.offset();return s&&(this._.transform=s),this},O.rotate=function(e,t,i){if(this.removed)return this;if(e!=null){e=n(e).split(l),e.length-1&&(t=r(e[1]),i=r(e[2])),e=r(e[0]),i==null&&(t=i);if(t==null||i==null){var s=this.getBBox(1);t=s.x+s.width/2,i=s.y+s.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",e,t,i]])),this}},O.translate=function(e,t){return this.removed?this:(e=n(e).split(l),e.length-1&&(t=r(e[1])),e=r(e[0])||0,t=+t||0,this._.bbox&&(this._.bbox.x+=e,this._.bbox.y+=t),this.transform(this._.transform.concat([["t",e,t]])),this)},O.scale=function(e,t,i,s){if(this.removed)return this;e=n(e).split(l),e.length-1&&(t=r(e[1]),i=r(e[2]),s=r(e[3]),isNaN(i)&&(i=null),isNaN(s)&&(s=null)),e=r(e[0]),t==null&&(t=e),s==null&&(i=s);if(i==null||s==null)var o=this.getBBox(1);return i=i==null?o.x+o.width/2:i,s=s==null?o.y+o.height/2:s,this.transform(this._.transform.concat([["s",e,t,i,s]])),this._.dirtyT=1,this},O.hide=function(){return!this.removed&&(this.node.style.display="none"),this},O.show=function(){return!this.removed&&(this.node.style.display=d),this},O._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},O.remove=function(){if(!this.removed&&!!this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),e.eve.unbind("raphael.*.*."+this.id),e._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)this[t]=typeof this[t]=="function"?e._removedFactory(t):null;this.removed=!0}},O.attr=function(n,r){if(this.removed)return this;if(n==null){var i={};for(var s in this.attrs)this.attrs[t](s)&&(i[s]=this.attrs[s]);return i.gradient&&i.fill=="none"&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(r==null&&e.is(n,"string")){if(n==f&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;var o=n.split(l),u={};for(var a=0,h=o.length;a<h;a++)n=o[a],n in this.attrs?u[n]=this.attrs[n]:e.is(this.paper.customAttributes[n],"function")?u[n]=this.paper.customAttributes[n].def:u[n]=e._availableAttrs[n];return h-1?u:u[o[0]]}if(this.attrs&&r==null&&e.is(n,"array")){u={};for(a=0,h=n.length;a<h;a++)u[n[a]]=this.attr(n[a]);return u}var p;r!=null&&(p={},p[n]=r),r==null&&e.is(n,"object")&&(p=n);for(var d in p)c("raphael.attr."+d+"."+this.id,this,p[d]);if(p){for(d in this.paper.customAttributes)if(this.paper.customAttributes[t](d)&&p[t](d)&&e.is(this.paper.customAttributes[d],"function")){var v=this.paper.customAttributes[d].apply(this,[].concat(p[d]));this.attrs[d]=p[d];for(var m in v)v[t](m)&&(p[m]=v[m])}p.text&&this.type=="text"&&(this.textpath.string=p.text),k(this,p)}return this},O.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&e._tofront(this,this.paper),this},O.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),e._toback(this,this.paper)),this)},O.insertAfter=function(t){return this.removed?this:(t.constructor==e.st.constructor&&(t=t[t.length-1]),t.node.nextSibling?t.node.parentNode.insertBefore(this.node,t.node.nextSibling):t.node.parentNode.appendChild(this.node),e._insertafter(this,t,this.paper),this)},O.insertBefore=function(t){return this.removed?this:(t.constructor==e.st.constructor&&(t=t[0]),t.node.parentNode.insertBefore(this.node,t.node),e._insertbefore(this,t,this.paper),this)},O.blur=function(t){var n=this.node.runtimeStyle,r=n.filter;r=r.replace(g,d),+t!==0?(this.attrs.blur=t,n.filter=r+p+h+".Blur(pixelradius="+(+t||1.5)+")",n.margin=e.format("-{0}px 0 0 -{0}px",s(+t||1.5))):(n.filter=r,n.margin=0,delete this.attrs.blur)},e._engine.path=function(e,t){var n=M("shape");n.style.cssText=b,n.coordsize=w+p+w,n.coordorigin=t.coordorigin;var r=new A(n,t),i={fill:"none",stroke:"#000"};e&&(i.path=e),r.type="path",r.path=[],r.Path=d,k(r,i),t.canvas.appendChild(n);var s=M("skew");return s.on=!0,n.appendChild(s),r.skew=s,r.transform(d),r},e._engine.rect=function(t,n,r,i,s,o){var u=e._rectPath(n,r,i,s,o),a=t.path(u),f=a.attrs;return a.X=f.x=n,a.Y=f.y=r,a.W=f.width=i,a.H=f.height=s,f.r=o,f.path=u,a.type="rect",a},e._engine.ellipse=function(e,t,n,r,i){var s=e.path(),o=s.attrs;return s.X=t-r,s.Y=n-i,s.W=r*2,s.H=i*2,s.type="ellipse",k(s,{cx:t,cy:n,rx:r,ry:i}),s},e._engine.circle=function(e,t,n,r){var i=e.path(),s=i.attrs;return i.X=t-r,i.Y=n-r,i.W=i.H=r*2,i.type="circle",k(i,{cx:t,cy:n,r:r}),i},e._engine.image=function(t,n,r,i,s,o){var u=e._rectPath(r,i,s,o),a=t.path(u).attr({stroke:"none"}),l=a.attrs,c=a.node,h=c.getElementsByTagName(f)[0];return l.src=n,a.X=l.x=r,a.Y=l.y=i,a.W=l.width=s,a.H=l.height=o,l.path=u,a.type="image",h.parentNode==c&&c.removeChild(h),h.rotate=!0,h.src=n,h.type="tile",a._.fillpos=[r,i],a._.fillsize=[s,o],c.appendChild(h),N(a,1,1,0,0,0),a},e._engine.text=function(t,r,i,o){var u=M("shape"),a=M("path"),f=M("textpath");r=r||0,i=i||0,o=o||"",a.v=e.format("m{0},{1}l{2},{1}",s(r*w),s(i*w),s(r*w)+1),a.textpathok=!0,f.string=n(o),f.on=!0,u.style.cssText=b,u.coordsize=w+p+w,u.coordorigin="0 0";var l=new A(u,t),c={fill:"#000",stroke:"none",font:e._availableAttrs.font,text:o};l.shape=u,l.path=a,l.textpath=f,l.type="text",l.attrs.text=n(o),l.attrs.x=r,l.attrs.y=i,l.attrs.w=1,l.attrs.h=1,k(l,c),u.appendChild(f),u.appendChild(a),t.canvas.appendChild(u);var h=M("skew");return h.on=!0,u.appendChild(h),l.skew=h,l.transform(d),l},e._engine.setSize=function(t,n){var r=this.canvas.style;return this.width=t,this.height=n,t==+t&&(t+="px"),n==+n&&(n+="px"),r.width=t,r.height=n,r.clip="rect(0 "+t+" "+n+" 0)",this._viewBox&&e._engine.setViewBox.apply(this,this._viewBox),this},e._engine.setViewBox=function(t,n,r,i,s){e.eve("raphael.setViewBox",this,this._viewBox,[t,n,r,i,s]);var u=this.width,a=this.height,f=1/o(r/u,i/a),l,c;return s&&(l=a/i,c=u/r,r*l<u&&(t-=(u-r*l)/2/l),i*c<a&&(n-=(a-i*c)/2/c)),this._viewBox=[t,n,r,i,!!s],this._viewBoxShift={dx:-t,dy:-n,scale:f},this.forEach(function(e){e.transform("...")}),this};var M;e._engine.initWin=function(e){var t=e.document;t.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!t.namespaces.rvml&&t.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),M=function(e){return t.createElement("<rvml:"+e+' class="rvml">')}}catch(n){M=function(e){return t.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},e._engine.initWin(e._g.win),e._engine.create=function(){var t=e._getContainer.apply(0,arguments),n=t.container,r=t.height,i,s=t.width,o=t.x,u=t.y;if(!n)throw new Error("VML container not found.");var a=new e._Paper,f=a.canvas=e._g.doc.createElement("div"),l=f.style;return o=o||0,u=u||0,s=s||512,r=r||342,a.width=s,a.height=r,s==+s&&(s+="px"),r==+r&&(r+="px"),a.coordsize=w*1e3+p+w*1e3,a.coordorigin="0 0",a.span=e._g.doc.createElement("span"),a.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",f.appendChild(a.span),l.cssText=e.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",s,r),n==1?(e._g.doc.body.appendChild(f),l.left=o+"px",l.top=u+"px",l.position="absolute"):n.firstChild?n.insertBefore(f,n.firstChild):n.appendChild(f),a.renderfix=function(){},a},e.prototype.clear=function(){e.eve("raphael.clear",this),this.canvas.innerHTML=d,this.span=e._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},e.prototype.remove=function(){e.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=typeof this[t]=="function"?e._removedFactory(t):null;return!0};var _=e.st;for(var D in O)O[t](D)&&!_[t](D)&&(_[D]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e].apply(n,t)})}}(D))}(window.Raphael);